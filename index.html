<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BudgetBuddy â€” ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â‚¬</text></svg>">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â‚¬</text></svg>">
<style>
  /* Î¥Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± styles... Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Ï„Î± Î¯Î´Î¹Î± */

  /* ÎÎ•Î‘: ÎšÎ¿Ï…Î¼Ï€Î¯ Î±Î»Î»Î±Î³Î®Ï‚ Î¼Î®Î½Î± */
  .month-selector {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
    background: linear-gradient(to right, #e1f5fe, #f3e5f5);
    padding: 15px;
    border-radius: 10px;
  }

  .month-selector select, .month-selector button {
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid #ddd;
    font-size: 15px;
  }

  .month-selector button {
    background: #e91e63;
    color: white;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
  }

  .month-selector button:hover {
    background: #d81b60;
    transform: translateY(-2px);
  }

  /* ÎÎ•ÎŸ: Î Î»Î±Î¯ÏƒÎ¹Î¿ ÎµÏƒÏŒÎ´Ï‰Î½ */
  .income-editor {
    background: #e8f5e9;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .income-editor label {
    font-weight: bold;
    color: #2e7d32;
    min-width: 80px;
  }

  .income-editor input {
    flex: 1;
    padding: 10px;
    border-radius: 8px;
    border: 2px solid #4caf50;
    font-size: 16px;
    text-align: center;
  }

  .income-editor button {
    background: #4caf50;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .income-editor button:hover {
    background: #388e3c;
  }

  /* ÎÎ•Î‘: Î ÎµÎ´Î¯Î¿ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½ */
  .available-money-display {
    background: linear-gradient(to right, #e3f2fd, #e8f5e9);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    text-align: center;
  }

  .available-money-display h4 {
    margin: 0 0 10px 0;
    color: #1976d2;
  }

  .available-money-display .amount {
    font-size: 28px;
    font-weight: bold;
    color: #1976d2;
    margin-bottom: 10px;
  }

  .budget-total {
    font-size: 14px;
    color: #666;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid #ddd;
  }
</style>

<!-- Î¤Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± styles Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Ï„Î± Î¯Î´Î¹Î± -->

</head>
<body>

<!-- HEADER Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ Î¯Î´Î¹Î¿ -->

<!-- MAIN CONTAINER -->
<div class="container">
  
  <!-- TAB 1: Î Î¡ÎŸÎ£Î˜Î—ÎšÎ— - Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· month selector -->
  <div id="tab1" class="tab-content active">
    <div class="month-selector">
      <span style="font-weight: bold; color: #e91e63;">ğŸ“… Î¤ÏÎ­Ï‡Ï‰Î½ Î¼Î®Î½Î±Ï‚:</span>
      <select id="monthSelect"></select>
      <button onclick="resetCurrentMonth()">ğŸ”„ Î•ÎºÎºÎ±Î¸Î¬ÏÎ¹ÏƒÎ· Î¼Î®Î½Î±</button>
      <button onclick="createNewMonth()" style="background: #4caf50;">â• ÎÎ­Î¿Ï‚ Î¼Î®Î½Î±Ï‚</button>
    </div>

    <div class="quick-add-form">
      <!-- Î¥Ï€Î¬ÏÏ‡Î¿Î½ quick-add-form Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ Î¯Î´Î¹Î¿ -->
    </div>

    <!-- Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· available money display -->
    <div class="available-money-display">
      <h4>ğŸ’° Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Î³Î¹Î± Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒ</h4>
      <div class="amount" id="availableForBudget">0.00 â‚¬</div>
      <div class="budget-total">
        Î£ÏÎ½Î¿Î»Î¿ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½: <span id="totalBudgetAmount">0.00 â‚¬</span>
      </div>
    </div>

    <!-- Î¥Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± recent expenses -->
  </div>

  <!-- TAB 2: Î¥Î ÎŸÎ›ÎŸÎ™Î Î‘ - Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· income editor -->
  <div id="tab2" class="tab-content">
    <div class="income-editor">
      <label>ğŸ’° ÎˆÏƒÎ¿Î´Î±:</label>
      <input type="number" id="incomeInput" step="0.01" placeholder="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Î¼Î·Î½Î¹Î±Î¯Î± Î­ÏƒÎ¿Î´Î±">
      <button onclick="updateIncome()">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
    </div>

    <h2 style="color: #e91e63; margin-top: 0;">ğŸ“Š Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±Î½Î¬ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</h2>
    
    <!-- Î¤Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Î¯Î´Î¹Î± -->
    
    <div style="margin-top: 30px; padding: 20px; background: linear-gradient(to right, #e8f5e9, #f1f8e9); border-radius: 10px;">
      <h3 style="margin-top: 0; color: #2e7d32;">ğŸ’° Î¤ÎµÎ»Î¹ÎºÏŒ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ (ÎÎ­Î± Î›Î¿Î³Î¹ÎºÎ®)</h3>
      <div style="text-align: center; padding: 20px;">
        <div style="font-size: 32px; font-weight: bold; color: #e91e63;" id="finalBalanceDisplay">0 â‚¬</div>
        <div style="color: #666; font-size: 14px;" id="finalBalanceExplanation">
          (Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Î§ÏÎ®Î¼Î±Ï„Î± - ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½)
        </div>
      </div>
    </div>
  </div>

  <!-- Î¤Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± tabs Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Î¯Î´Î¹Î± -->

</div>

<!-- Î¤Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Î¯Î´Î¹Î± -->

<script>
// ==================== ÎÎ•Î•Î£ ÎœÎ•Î¤Î‘Î’Î›Î—Î¤Î•Î£ ====================
let currentMonth = localStorage.getItem('currentMonth') || new Date().toISOString().slice(0,7); // YYYY-MM
let availableMoney = JSON.parse(localStorage.getItem('availableMoney') || '0'); // Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Ï‡ÏÎ®Î¼Î±Ï„Î± Î³Î¹Î± Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒ

// ==================== Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸÎ£ Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£ ====================
// ÎŸÎ¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Î¯Î´Î¹ÎµÏ‚

// ==================== ÎÎ•Î•Î£ Î›Î•Î™Î¤ÎŸÎ¥Î¡Î“Î™Î•Î£ ====================

// 1. Î›Î•Î™Î¤ÎŸÎ¥Î¡Î“Î™Î‘ Î‘Î›Î›Î‘Î“Î—Î£ ÎœÎ—ÎÎ‘
function initMonthSelector() {
  const monthSelect = document.getElementById('monthSelect');
  const now = new Date();
  let html = '';
  
  // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± 12 Î¼Î·Î½ÏÎ½ (6 Ï€ÏÎ¹Î½, Ï„ÏÎ­Ï‡Ï‰Î½, 5 Î¼ÎµÏ„Î¬)
  for (let i = -6; i <= 5; i++) {
    const date = new Date(now.getFullYear(), now.getMonth() + i, 1);
    const year = date.getFullYear();
    const month = date.getMonth() + 1;
    const monthKey = `${year}-${month.toString().padStart(2, '0')}`;
    const monthName = date.toLocaleDateString('el-GR', { month: 'long', year: 'numeric' });
    const isSelected = monthKey === currentMonth;
    
    html += `<option value="${monthKey}" ${isSelected ? 'selected' : ''}>${monthName.charAt(0).toUpperCase() + monthName.slice(1)}</option>`;
  }
  
  monthSelect.innerHTML = html;
  
  // Event listener Î³Î¹Î± Î±Î»Î»Î±Î³Î® Î¼Î®Î½Î±
  monthSelect.addEventListener('change', function() {
    const selectedMonth = this.value;
    if (selectedMonth !== currentMonth) {
      if (confirm(`ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿Î½ Î¼Î®Î½Î±: ${selectedMonth}\nÎŸÎ¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½, Ï„Î± Î­Î¾Î¿Î´Î± Î¸Î± Ï†Î±Î¯Î½Î¿Î½Ï„Î±Î¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± Ï„Î¿Î½ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Î¼Î®Î½Î±.`)) {
        currentMonth = selectedMonth;
        localStorage.setItem('currentMonth', currentMonth);
        
        // Î¦Î¿ÏÏ„ÏÎ½Î¿Ï…Î¼Îµ Ï„Î± Î­Î¾Î¿Î´Î± Î³Î¹Î± Ï„Î¿Î½ Î½Î­Î¿ Î¼Î®Î½Î±
        loadMonthData();
        updateRecentExpenses();
        updateBudgetOverview();
        
        showQuickMessage(`ğŸ“… Î‘Î»Î»Î±Î³Î® ÏƒÎµ Î¼Î®Î½Î±: ${selectedMonth}`, 'success');
      } else {
        // Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Ï„Î¹Î¼Î®
        this.value = currentMonth;
      }
    }
  });
}

function loadMonthData() {
  // Î¦Î¿ÏÏ„ÏÎ½Î¿Ï…Î¼Îµ Ï„Î± Î­Î¾Î¿Î´Î± Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î± Î¼Îµ Î¼Î®Î½Î±
  // Î£Ï„Î·Î½ Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î·, Ï†Î¹Î»Ï„ÏÎ¬ÏÎ¿Ï…Î¼Îµ Ï„Î± Î­Î¾Î¿Î´Î± Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿Î½ Î¼Î®Î½Î±
  // ÎŸÎ¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ ÎºÎ±Î¹ Î¿Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Î¯Î´Î¹Î¿Î¹
}

function resetCurrentMonth() {
  if (confirm(`Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ ÏŒÎ»Î± Ï„Î± Î­Î¾Î¿Î´Î± Î³Î¹Î± Ï„Î¿Î½ Î¼Î®Î½Î± ${currentMonth};\n\nâš ï¸ Î— ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Î±Ï…Ï„Î® Î”Î•Î Î•Î™ÎÎ‘Î™ Î‘ÎÎ‘Î£Î¤Î¡Î•Î Î¤Î—!\nÎŸÎ¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ ÎºÎ±Î¹ Î¿Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½.`)) {
    // Î”Î¹Î±Î³ÏÎ±Ï†Î® Î­Î¾Î¿Î´Ï‰Î½ Î¼ÏŒÎ½Î¿ Î³Î¹Î± Ï„Î¿Î½ Ï„ÏÎ­Ï‡Î¿Î½ Î¼Î®Î½Î±
    const expensesToKeep = expenses.filter(expense => !expense.date.startsWith(currentMonth));
    expenses = expensesToKeep;
    
    saveAllData();
    updateRecentExpenses();
    updateBudgetOverview();
    showQuickMessage(`ğŸ§¹ Î•ÎºÎºÎ±Î¸Î¬ÏÎ¹ÏƒÎ· Î¼Î®Î½Î± ${currentMonth} Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!`, 'success');
  }
}

function createNewMonth() {
  const now = new Date();
  const nextMonth = new Date(now.getFullYear(), now.getMonth() + 1, 1);
  const year = nextMonth.getFullYear();
  const month = nextMonth.getMonth() + 1;
  const monthKey = `${year}-${month.toString().padStart(2, '0')}`;
  const monthName = nextMonth.toLocaleDateString('el-GR', { month: 'long', year: 'numeric' });
  
  if (confirm(`Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î¿Ï… Î¼Î®Î½Î±: ${monthName};\n\nâœ… Î˜Î± Î¼ÎµÏ„Î±Ï†ÎµÏÎ¸Î¿ÏÎ½ Î¿Î¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯\nâœ… Î˜Î± Î´Î¹Î±Ï„Î·ÏÎ·Î¸Î¿ÏÎ½ Î¿Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚\nâœ… Î¤Î± Î­Î¾Î¿Î´Î± Î¸Î± Ï†Î±Î¯Î½Î¿Î½Ï„Î±Î¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± Ï„Î¿Î½ Î½Î­Î¿ Î¼Î®Î½Î±`)) {
    currentMonth = monthKey;
    localStorage.setItem('currentMonth', currentMonth);
    
    // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· selector
    const monthSelect = document.getElementById('monthSelect');
    const optionExists = Array.from(monthSelect.options).some(opt => opt.value === monthKey);
    
    if (!optionExists) {
      const newOption = new Option(monthName.charAt(0).toUpperCase() + monthName.slice(1), monthKey);
      monthSelect.appendChild(newOption);
    }
    
    monthSelect.value = monthKey;
    
    // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚
    showQuickMessage(`âœ… Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î¿Ï… Î¼Î®Î½Î±: ${monthName}`, 'success');
    
    // Î‘Î½Î±Î½Î­Ï‰ÏƒÎ· UI
    updateRecentExpenses();
    updateBudgetOverview();
  }
}

// 2. Î›Î•Î™Î¤ÎŸÎ¥Î¡Î“Î™Î‘ Î‘Î›Î›Î‘Î“Î—Î£ Î•Î£ÎŸÎ”Î©Î
function initIncomeEditor() {
  const incomeInput = document.getElementById('incomeInput');
  incomeInput.value = income > 0 ? income : '';
  
  // Event listener Î³Î¹Î± Enter
  incomeInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      updateIncome();
    }
  });
}

function updateIncome() {
  const incomeInput = document.getElementById('incomeInput');
  const newIncome = parseFloat(incomeInput.value);
  
  if (isNaN(newIncome) || newIncome < 0) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÏŒ ÎµÏƒÏŒÎ´Ï‰Î½', 'error');
    return;
  }
  
  income = newIncome;
  localStorage.setItem('income', income);
  
  saveAllData();
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· display
  document.getElementById('displayIncome').textContent = income.toFixed(2) + ' â‚¬';
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½
  updateAvailableMoney();
  updateBudgetOverview();
  
  showQuickMessage(`âœ… Î¤Î± Î­ÏƒÎ¿Î´Î± ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎ±Î½ ÏƒÎµ ${income.toFixed(2)}â‚¬`, 'success');
}

// 3. Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ Î¤Î•Î›Î™ÎšÎŸ Î¥Î ÎŸÎ›ÎŸÎ™Î ÎŸ
function updateBudgetOverview() {
  const budgetCardsDiv = document.getElementById('budgetCards');
  const currentMonth = localStorage.getItem('currentMonth') || new Date().toISOString().slice(0,7);
  const monthExpenses = expenses.filter(e => e.date.startsWith(currentMonth));
  
  if (categories.length === 0) {
    budgetCardsDiv.innerHTML = `
      <div class="empty-state" style="grid-column: 1/-1;">
        ğŸ“‚ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚!
      </div>
    `;
    return;
  }
  
  let totalSpent = 0;
  let totalBudget = 0;
  
  let html = '';
  
  categories.forEach(category => {
    const categoryExpenses = monthExpenses.filter(e => e.category === category);
    const categorySpent = categoryExpenses.reduce((sum, e) => sum + e.amount, 0);
    const categoryBudget = recurringAmounts[category] || 0;
    const remaining = categoryBudget - categorySpent;
    const percentage = categoryBudget > 0 ? Math.min(100, (categorySpent / categoryBudget) * 100) : 0;
    
    totalSpent += categorySpent;
    totalBudget += categoryBudget;
    
    let statusClass = '';
    if (remaining < 0) {
      statusClass = 'over';
    } else if (remaining > 0) {
      statusClass = 'under';
    }
    
    html += `
      <div class="budget-card ${statusClass}">
        <h3 style="margin-top: 0; color: #333;">${category}</h3>
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
          <div>
            <div style="font-size: 12px; color: #666;">Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚</div>
            <div style="font-weight: bold; color: #333;">${categoryBudget.toFixed(2)} â‚¬</div>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 12px; color: #666;">ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½</div>
            <div style="font-weight: bold; color: #e91e63;">${categorySpent.toFixed(2)} â‚¬</div>
          </div>
        </div>
        
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${percentage}%;"></div>
        </div>
        
        <div style="text-align: center; margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee;">
          <div style="font-size: 12px; color: #666;">ÎœÎ­Î½Î¿Ï…Î½</div>
          <div style="font-size: 20px; font-weight: bold; color: ${remaining >= 0 ? '#4caf50' : '#f44336'}">
            ${remaining.toFixed(2)} â‚¬
          </div>
          <div style="font-size: 11px; color: #999;">(${percentage.toFixed(1)}%)</div>
        </div>
      </div>
    `;
  });
  
  budgetCardsDiv.innerHTML = html;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎµÏƒÏŒÎ´Ï‰Î½ ÎºÎ±Î¹ Î¾Î¿Î´ÎµÎ¼Î­Î½Ï‰Î½
  document.getElementById('displayIncome').textContent = income.toFixed(2) + ' â‚¬';
  document.getElementById('displaySpent').textContent = totalSpent.toFixed(2) + ' â‚¬';
  
  // 3. ÎÎ•Î‘ Î›ÎŸÎ“Î™ÎšÎ— Î¤Î•Î›Î™ÎšÎŸÎ¥ Î¥Î ÎŸÎ›ÎŸÎ™Î ÎŸÎ¥
  // Î¤ÎµÎ»Î¹ÎºÏŒ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ = Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Î§ÏÎ®Î¼Î±Ï„Î± (Î±Ï€ÏŒ Ï„ÏÎ¬Ï€ÎµÎ¶ÎµÏ‚) - ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½
  
  // Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Ï‡ÏÎ®Î¼Î±Ï„Î±
  const currentMoney = (bankBalances.alphaBank || 0) + (bankBalances.nationalBank || 0) + (bankBalances.cash || 0);
  const futureMoney = bankBalances.expectedIncome || 0;
  const totalAvailableMoney = currentMoney + futureMoney;
  
  // Î¤ÎµÎ»Î¹ÎºÏŒ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î¿
  const finalBalance = totalAvailableMoney - totalSpent;
  
  document.getElementById('finalBalanceDisplay').textContent = finalBalance.toFixed(2) + ' â‚¬';
  
  // Î•Ï€ÎµÎ¾Î®Î³Î·ÏƒÎ·
  const explanation = document.getElementById('finalBalanceExplanation');
  explanation.innerHTML = `
    Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î±: ${totalAvailableMoney.toFixed(2)}â‚¬ - ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½: ${totalSpent.toFixed(2)}â‚¬<br>
    <small style="color: #999;">(Î‘Ï€ÏŒ Ï„ÏÎ¬Ï€ÎµÎ¶Î±: ${currentMoney.toFixed(2)}â‚¬ + Î˜Î± Ï€Î¬ÏÏ‰: ${futureMoney.toFixed(2)}â‚¬)</small>
  `;
  
  // Î§ÏÏÎ¼Î± Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿
  if (finalBalance < 0) {
    document.getElementById('finalBalanceDisplay').style.color = '#f44336';
  } else if (finalBalance < totalAvailableMoney * 0.1) {
    document.getElementById('finalBalanceDisplay').style.color = '#ff9800';
  } else {
    document.getElementById('finalBalanceDisplay').style.color = '#4caf50';
  }
  
  // 4. Î•ÎÎ—ÎœÎ•Î¡Î©Î£Î— Î”Î™Î‘Î˜Î•Î£Î™ÎœÎ©Î Î“Î™Î‘ Î Î¡ÎŸÎ¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸ
  updateAvailableMoney(totalBudget);
}

// 4. Î£Î¥Î£Î¤Î—ÎœÎ‘ Î”Î™Î‘Î˜Î•Î£Î™ÎœÎ©Î Î§Î¡Î—ÎœÎ‘Î¤Î©Î
function updateAvailableMoney(budgetTotal = 0) {
  // Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Ï‡ÏÎ®Î¼Î±Ï„Î± = Î†Î¸ÏÎ¿Î¹ÏƒÎ¼Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Ï…Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½
  const currentMoney = (bankBalances.alphaBank || 0) + (bankBalances.nationalBank || 0) + (bankBalances.cash || 0);
  const futureMoney = bankBalances.expectedIncome || 0;
  const totalAvailable = currentMoney + futureMoney;
  
  // Î‘Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Ï…Î¼Îµ Ï„Î¿ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ Ï€Î¿ÏƒÏŒ
  availableMoney = totalAvailable;
  localStorage.setItem('availableMoney', JSON.stringify(availableMoney));
  
  // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ·
  document.getElementById('availableForBudget').textContent = totalAvailable.toFixed(2) + ' â‚¬';
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½
  let totalBudget = 0;
  categories.forEach(category => {
    totalBudget += recurringAmounts[category] || 0;
  });
  
  document.getElementById('totalBudgetAmount').textContent = totalBudget.toFixed(2) + ' â‚¬';
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï‡ÏÏÎ¼Î±Ï„Î¿Ï‚ Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î·Î½ Î´Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±
  const availableDisplay = document.getElementById('availableForBudget');
  if (totalBudget > totalAvailable) {
    availableDisplay.style.color = '#f44336';
  } else if (totalBudget === totalAvailable) {
    availableDisplay.style.color = '#ff9800';
  } else {
    availableDisplay.style.color = '#4caf50';
  }
}

// Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· saveBankBalances Î³Î¹Î± Î½Î± ÎºÎ±Î»ÎµÎ¯ updateAvailableMoney
function saveBankBalances() {
  bankBalances = {
    alphaBank: parseFloat(document.getElementById('alphaBank').value) || 0,
    nationalBank: parseFloat(document.getElementById('nationalBank').value) || 0,
    cash: parseFloat(document.getElementById('cash').value) || 0,
    expectedIncome: parseFloat(document.getElementById('expectedIncome').value) || 0
  };
  
  saveAllData();
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½
  updateAvailableMoney();
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„ÎµÎ»Î¹ÎºÎ¿Ï Ï…Ï€Î¿Î»Î¿Î¯Ï€Î¿Ï…
  updateBudgetOverview();
  
  showQuickMessage('ğŸ’° Î¤Î± Ï„ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
  loadBankValues();
}

// Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· saveRecurringAmounts Î³Î¹Î± Î½Î± ÎºÎ±Î»ÎµÎ¯ updateAvailableMoney
function saveRecurringAmounts() {
  if (categories.length === 0) {
    showQuickMessage('âš ï¸ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚', 'error');
    return;
  }
  
  categories.forEach(category => {
    const inputs = document.querySelectorAll(`input[id^="recurring_"]`);
    
    inputs.forEach(input => {
      if (input.id.includes(category.replace(/\s+/g, '_')) || 
          input.previousElementSibling?.textContent?.includes(category)) {
        const value = parseFloat(input.value) || 0;
        recurringAmounts[category] = value;
      }
    });
  });
  
  saveAllData();
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½
  updateAvailableMoney();
  
  showQuickMessage('ğŸ’¾ ÎŸÎ¹ Î¼Î·Î½Î¹Î±Î¯Î¿Î¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
}

// ==================== Î‘ÎÎ‘ÎÎ•Î©ÎœÎ•ÎÎ— INITIALIZATION ====================
window.onload = function() {
  // Î¥Ï€Î¬ÏÏ‡Î¿Î½ initialization code...
  
  // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î½Î­Ï‰Î½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÏÎ½
  initMonthSelector();
  initIncomeEditor();
  updateAvailableMoney();
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ Ï„ÏÎ±Ï€ÎµÎ¶Î¹ÎºÏÎ½ Ï…Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½
  loadBankValues = function() {
    document.getElementById('alphaBank').value = bankBalances.alphaBank > 0 ? bankBalances.alphaBank : '';
    document.getElementById('nationalBank').value = bankBalances.nationalBank > 0 ? bankBalances.nationalBank : '';
    document.getElementById('cash').value = bankBalances.cash > 0 ? bankBalances.cash : '';
    document.getElementById('expectedIncome').value = bankBalances.expectedIncome > 0 ? bankBalances.expectedIncome : '';
    
    // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½
    updateAvailableMoney();
  };
  
  // Event listener Î³Î¹Î± Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½
  const bankInputs = ['alphaBank', 'nationalBank', 'cash', 'expectedIncome'];
  bankInputs.forEach(id => {
    const input = document.getElementById(id);
    if (input) {
      input.addEventListener('input', function() {
        setTimeout(updateAvailableMoney, 500);
      });
    }
  });
  
  // Event listener Î³Î¹Î± Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½
  document.addEventListener('input', function(e) {
    if (e.target.id && e.target.id.startsWith('recurring_')) {
      setTimeout(() => {
        const category = categories.find(cat => 
          e.target.id.includes(cat.replace(/\s+/g, '_')) ||
          e.target.parentElement.querySelector('div').textContent.includes(cat)
        );
        if (category) {
          updateSingleRecurringAmount(category, e.target.value);
          updateAvailableMoney();
        }
      }, 300);
    }
  });
  
  // Î¤Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± initialization code...
};
</script>
</body>
</html>
