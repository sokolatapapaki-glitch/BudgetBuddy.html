<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- FAVICONS & PWA -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23e91e63%22>ğŸ’°</text></svg>">
<meta name="theme-color" content="#e91e63">
<title>ğŸŒ¸ BudgetBuddy â€” ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï</title>
<!-- ÎŸÎœÎ‘Î”Î‘ Firebase (Î‘ÎÎ¤Î™ÎšÎ‘Î¤Î‘Î£Î¤Î—Î£Î• ÎœÎ• Î¤Î‘ Î”Î™ÎšÎ‘ Î£ÎŸÎ¥ Î£Î¤ÎŸÎ™Î§Î•Î™Î‘) -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY_HERE",
    authDomain: "YOUR_AUTH_DOMAIN_HERE",
    databaseURL: "YOUR_DATABASE_URL_HERE",
    projectId: "YOUR_PROJECT_ID_HERE",
    storageBucket: "YOUR_STORAGE_BUCKET_HERE",
    messagingSenderId: "YOUR_SENDER_ID_HERE",
    appId: "YOUR_APP_ID_HERE"
  };
  if (firebase.apps.length === 0) {
    firebase.initializeApp(firebaseConfig);
  }
</script>
<style>
  /* Î’Î±ÏƒÎ¹ÎºÎ¬ ÏƒÏ„Ï…Î» Î³Î¹Î± Î¿Î¸ÏŒÎ½Î· ÎºÎ¹Î½Î·Ï„Î¿Ï */
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; background: #f8f9fa; color: #333; line-height: 1.5; }
  
  /* Î£Ï„Î±Î¸ÎµÏÏŒ Header & Tabs */
  .app-header {
    background: linear-gradient(135deg, #e91e63 0%, #9c27b0 100%);
    color: white;
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    box-shadow: 0 2px 10px rgba(233, 30, 99, 0.2);
  }
  .header-top {
    display: flex; justify-content: space-between; align-items: center;
    padding: 15px;
  }
  .app-title { font-size: 1.25rem; font-weight: 700; }
  .sync-indicator {
    display: flex; align-items: center; gap: 6px;
    background: rgba(255,255,255,0.15); padding: 6px 12px;
    border-radius: 20px; font-size: 0.8rem;
  }
  .sync-dot {
    width: 8px; height: 8px; border-radius: 50%;
    background: #ff9800; /* Default: connecting */
  }
  .sync-dot.online { background: #4caf50; animation: pulse 1.5s infinite; }
  .sync-dot.offline { background: #f44336; }
  @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }
  
  /* Tabs */
  .tabs {
    display: flex; background: rgba(0,0,0,0.1);
    overflow-x: auto; white-space: nowrap;
    -webkit-overflow-scrolling: touch;
  }
  .tab {
    flex: 1; text-align: center; padding: 12px 10px;
    font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.8);
    border-bottom: 3px solid transparent; cursor: pointer;
    transition: all 0.2s; min-width: 80px;
  }
  .tab.active {
    color: white; border-bottom-color: white;
    background: rgba(255,255,255,0.05);
  }
  .tab-icon { display: block; font-size: 1.2rem; margin-bottom: 4px; }
  
  /* ÎšÏÏÎ¹Î¿ Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ (ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î± tabs) */
  .main-content {
    margin-top: 125px; /* Î‘Î½Î±Î»Î¿Î³Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ ÏÏˆÎ¿Ï‚ Ï„Î¿Ï… header+tabs */
    padding: 15px;
    padding-bottom: 80px; /* Î§ÏÏÎ¿Ï‚ Î³Î¹Î± Ï„Î¿ Quick Entry */
  }
  
  /* ÎŸÎ ÎŸÎ™ÎŸÎ£Î”Î—Î ÎŸÎ¤Î• ÎšÎ‘ÎÎ•Î™Î£ SCROLL, Î‘Î¥Î¤ÎŸ Î•Î™ÎÎ‘Î™ Î Î‘ÎÎ¤Î‘ ÎŸÎ¡Î‘Î¤ÎŸ ÎšÎ‘Î™ Î•Î¥ÎšÎŸÎ›ÎŸ */
  .sticky-quick-entry {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: white;
    border-top: 2px solid #e91e63;
    padding: 15px;
    box-shadow: 0 -5px 20px rgba(0,0,0,0.15);
    z-index: 200;
    display: flex; flex-wrap: wrap; gap: 10px;
    align-items: flex-end;
  }
  .quick-input-group {
    flex: 1; min-width: 120px;
  }
  .quick-input-group label {
    display: block; font-size: 0.75rem; color: #666;
    margin-bottom: 5px; font-weight: 600;
  }
  .quick-input-group input, .quick-input-group select {
    width: 100%; padding: 12px; border: 2px solid #e0e0e0;
    border-radius: 8px; font-size: 1rem;
    background: white;
  }
  .quick-input-group input:focus, .quick-input-group select:focus {
    outline: none; border-color: #e91e63;
  }
  .quick-amount { max-width: 140px; }
  .quick-category { flex: 1.5; }
  .quick-note { flex: 2; min-width: 180px; }
  .quick-add-btn {
    width: 60px; height: 60px; border-radius: 50%;
    background: #e91e63; color: white; border: none;
    font-size: 1.5rem; font-weight: bold;
    cursor: pointer; box-shadow: 0 4px 10px rgba(233, 30, 99, 0.3);
    display: flex; align-items: center; justify-content: center;
    transition: all 0.2s; flex-shrink: 0;
  }
  .quick-add-btn:active {
    transform: scale(0.95); background: #d81b60;
  }
  
  /* Î£Ï„Ï…Î» Î³Î¹Î± Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± Ï„Ï‰Î½ Tabs */
  .tab-content { display: none; }
  .tab-content.active { display: block; }
  
  /* Î Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ¾ÏŒÎ´Ï‰Î½ */
  .expenses-table-container {
    background: white; border-radius: 10px; overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-top: 15px;
  }
  .expenses-table {
    width: 100%; border-collapse: collapse;
  }
  .expenses-table th, .expenses-table td {
    padding: 12px 10px; text-align: left;
    border-bottom: 1px solid #f0f0f0;
  }
  .expenses-table th {
    background: #fff5f7; color: #e91e63;
    font-weight: 600; font-size: 0.85rem;
  }
  .expenses-table td { font-size: 0.9rem; }
  .expenses-table tr:last-child td { border-bottom: none; }
  
  /* ÎšÎ¬ÏÏ„ÎµÏ‚ Î³Î¹Î± Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿ÏÏ‚, Ï„ÏÎ¬Ï€ÎµÎ¶ÎµÏ‚, ÎºÏ„Î». */
  .card-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 15px; margin-top: 15px;
  }
  .card {
    background: white; border-radius: 10px; padding: 15px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    border-left: 4px solid #e91e63;
  }
  .card h4 { color: #333; margin-bottom: 10px; font-size: 1rem; }
  .card input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
  
  /* Modal Î³Î¹Î± ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ & Î¬Î»Î»Î± */
  .modal-overlay {
    display: none; position: fixed; top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.7); z-index: 1000;
    align-items: center; justify-content: center; padding: 20px;
  }
  .modal {
    background: white; border-radius: 15px; width: 100%;
    max-width: 450px; max-height: 85vh; overflow-y: auto;
    box-shadow: 0 15px 40px rgba(0,0,0,0.2);
  }
  .modal-header {
    background: #9c27b0; color: white; padding: 20px;
    border-radius: 15px 15px 0 0; position: relative;
  }
  .modal-header h2 { margin: 0; font-size: 1.3rem; }
  .modal-close {
    position: absolute; top: 15px; right: 15px;
    background: none; border: none; color: white;
    font-size: 1.5rem; cursor: pointer; width: 30px; height: 30px;
    display: flex; align-items: center; justify-content: center;
  }
  .modal-body { padding: 20px; }
  
  /* ÎšÎ¿Ï…Î¼Ï€Î¹Î¬ */
  .btn {
    padding: 12px 20px; border-radius: 8px; border: none;
    font-weight: 600; font-size: 0.95rem; cursor: pointer;
    transition: all 0.2s; display: inline-flex;
    align-items: center; justify-content: center; gap: 8px;
  }
  .btn-primary { background: #e91e63; color: white; }
  .btn-success { background: #4caf50; color: white; }
  .btn-warning { background: #ff9800; color: white; }
  .btn:active { transform: scale(0.98); }
  
  /* Responsive */
  @media (max-width: 768px) {
    .sticky-quick-entry { flex-direction: column; align-items: stretch; }
    .quick-input-group { width: 100%; max-width: none; }
    .quick-add-btn { align-self: center; margin-top: 10px; }
    .card-grid { grid-template-columns: 1fr; }
    .expenses-table th, .expenses-table td { padding: 10px 8px; font-size: 0.8rem; }
  }
</style>
</head>
<body>
<!-- Î£Î¤Î‘Î˜Î•Î¡ÎŸ HEADER ÎšÎ‘Î™ TABS -->
<div class="app-header">
  <div class="header-top">
    <div class="app-title">ğŸŒ¸ BudgetBuddy</div>
    <div class="sync-indicator" onclick="openSyncModal()">
      <span class="sync-dot" id="syncDot"></span>
      <span id="syncText">Î£ÏÎ½Î´ÎµÏƒÎ·</span>
    </div>
  </div>
  <nav class="tabs">
    <div class="tab active" data-tab="home"><span class="tab-icon">ğŸ </span> Î£Î®Î¼ÎµÏÎ±</div>
    <div class="tab" data-tab="expenses"><span class="tab-icon">ğŸ“‹</span> ÎˆÎ¾Î¿Î´Î±</div>
    <div class="tab" data-tab="budgets"><span class="tab-icon">ğŸ’°</span> Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯</div>
    <div class="tab" data-tab="banks"><span class="tab-icon">ğŸ¦</span> Î¤ÏÎ¬Ï€ÎµÎ¶ÎµÏ‚</div>
    <div class="tab" data-tab="stats"><span class="tab-icon">ğŸ“Š</span> Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬</div>
    <div class="tab" data-tab="settings"><span class="tab-icon">âš™ï¸</span> Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚</div>
  </nav>
</div>

<!-- ÎšÎ¥Î¡Î™ÎŸ Î Î•Î¡Î™Î•Î§ÎŸÎœÎ•ÎÎŸ -->
<main class="main-content">
  <!-- TAB 1: Î£Î—ÎœÎ•Î¡Î‘ -->
  <section class="tab-content active" id="home-tab">
    <h2>ÎšÎ±Î»ÏÏ‚ Î®ÏÎ¸ÎµÏ‚!</h2>
    <p>Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Ï„Î· Î¼Ï€Î¬ÏÎ± Î±Ï€ÏŒ ÎºÎ¬Ï„Ï‰ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚ Î­Î¾Î¿Î´Î¿. ÎŸÎ¹ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯ÎµÏ‚ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎµÎ´Ï.</p>
    <div class="expenses-table-container">
      <table class="expenses-table" id="today-expenses">
        <thead><tr><th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</th><th>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</th><th>Î Î¿ÏƒÏŒ</th><th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th></tr></thead>
        <tbody><!-- Î‘Î½Î±Î½ÎµÏÎ½ÎµÏ„Î±Î¹ Î¼Îµ JS --></tbody>
      </table>
    </div>
  </section>
  <!-- TAB 2: Î•ÎÎŸÎ”Î‘ -->
  <section class="tab-content" id="expenses-tab">
    <h2>ÎŒÎ»Î± Ï„Î± ÎˆÎ¾Î¿Î´Î±</h2>
    <p>Î Î»Î®ÏÎ·Ï‚ Î»Î¯ÏƒÏ„Î±. <button class="btn btn-warning" onclick="showNewMonthModal()">ğŸ“… ÎÎ­Î¿Ï‚ ÎœÎ®Î½Î±Ï‚</button></p>
    <div class="expenses-table-container">
      <table class="expenses-table" id="all-expenses">
        <thead><tr><th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</th><th>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</th><th>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</th><th>Î Î¿ÏƒÏŒ</th><th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th></tr></thead>
        <tbody><!-- Î‘Î½Î±Î½ÎµÏÎ½ÎµÏ„Î±Î¹ Î¼Îµ JS --></tbody>
      </table>
    </div>
  </section>
  <!-- TAB 3: Î Î¡ÎŸÎ¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ™ -->
  <section class="tab-content" id="budgets-tab">
    <h2>ÎœÎ·Î½Î¹Î±Î¯Î¿Î¹ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯</h2>
    <p>ÎŸÏÎ¯ÏƒÏ„Îµ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±.</p>
    <div class="card-grid" id="budgets-container">
      <!-- Î‘Î½Î±Î½ÎµÏÎ½ÎµÏ„Î±Î¹ Î¼Îµ JS -->
    </div>
    <button class="btn btn-success" style="margin-top:15px;" onclick="saveBudgets()">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½</button>
  </section>
  <!-- TAB 4: Î¤Î¡Î‘Î Î•Î–Î•Î£ -->
  <section class="tab-content" id="banks-tab">
    <h2>Î¤ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î±</h2>
    <p>ÎšÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÏ„Îµ Ï„Î± Ï„ÏÎ­Ï‡Î¿Î½Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¬ ÏƒÎ±Ï‚.</p>
    <div class="card-grid">
      <div class="card"><h4>Î‘Î»Ï†Î± Î¤ÏÎ¬Ï€ÎµÎ¶Î±</h4><input type="number" id="bank-alpha" placeholder="0.00 â‚¬"></div>
      <div class="card"><h4>Î•Î¸Î½Î¹ÎºÎ® Î¤ÏÎ¬Ï€ÎµÎ¶Î±</h4><input type="number" id="bank-national" placeholder="0.00 â‚¬"></div>
      <div class="card"><h4>ÎœÎµÏ„ÏÎ·Ï„Î¬</h4><input type="number" id="cash" placeholder="0.00 â‚¬"></div>
      <div class="card"><h4>Î˜Î± Ï€Î¬ÏÏ‰ Î±ÎºÏŒÎ¼Î±</h4><input type="number" id="expected-income" placeholder="0.00 â‚¬"></div>
    </div>
    <button class="btn btn-success" style="margin-top:15px;" onclick="saveBankBalances()">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î¥Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½</button>
  </section>
  <!-- TAB 5: Î£Î¤Î‘Î¤Î™Î£Î¤Î™ÎšÎ‘ -->
  <section class="tab-content" id="stats-tab">
    <h2>Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ & Î“ÏÎ±Ï†Î®Î¼Î±Ï„Î±</h2>
    <p>Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ® ÎµÎ¹ÎºÏŒÎ½Î± Ï„Ï‰Î½ ÎµÎ¾ÏŒÎ´Ï‰Î½ ÏƒÎ±Ï‚.</p>
    <div class="card-grid">
      <div class="card"><h4>Î£ÏÎ½Î¿Î»Î¿ ÎˆÎ¾Î¿Î´Ï‰Î½</h4><div class="stat-value" id="stat-total">0.00 â‚¬</div></div>
      <div class="card"><h4>ÎœÎ­ÏƒÎ¿ ÎŒÏÎ¿Ï‚</h4><div class="stat-value" id="stat-average">0.00 â‚¬</div></div>
      <div class="card"><h4>Î”Î·Î¼Î¿Ï†Î¹Î»Î­ÏƒÏ„ÎµÏÎ· ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</h4><div class="stat-value" id="stat-top-category">-</div></div>
      <div class="card"><h4>Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¾ÏŒÎ´Ï‰Î½</h4><div class="stat-value" id="stat-count">0</div></div>
    </div>
    <div style="margin-top:20px; background:white; padding:15px; border-radius:10px;">
      <h4>ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î±Î½Î¬ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</h4>
      <div id="chart-container" style="height:200px;"></div>
    </div>
  </section>
  <!-- TAB 6: Î¡Î¥Î˜ÎœÎ™Î£Î•Î™Î£ -->
  <section class="tab-content" id="settings-tab">
    <h2>Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ & Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·</h2>
    <div class="card">
      <h4>ğŸ“‚ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎšÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½</h4>
      <div style="display:flex; gap:10px; margin-top:10px;">
        <input type="text" id="new-cat-name" placeholder="ÎÎ­Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±" style="flex:1;">
        <button class="btn btn-primary" onclick="addNewCategory()">+ Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·</button>
      </div>
      <div id="categories-list" style="margin-top:15px;"></div>
    </div>
    <div class="card" style="margin-top:15px;">
      <h4>ğŸ”„ Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î¼Îµ Î£ÏÎ¶Ï…Î³Î¿</h4>
      <p id="sync-status-text">Î”ÎµÎ½ ÎµÎ¯ÏƒÏ„Îµ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹.</p>
      <button class="btn btn-success" onclick="openSyncModal()">ğŸ”— Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï</button>
    </div>
    <div class="card" style="margin-top:15px;">
      <h4>ğŸ—„ï¸ Î‘ÏÏ‡ÎµÎ¹Î¿Î¸Î­Ï„Î·ÏƒÎ·</h4>
      <p>Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏƒÏ„Îµ Î® Ï†Î¿ÏÏ„ÏÏƒÏ„Îµ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï…Ï‚ Î¼Î®Î½ÎµÏ‚.</p>
      <button class="btn btn-warning" onclick="saveArchive()">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î¤ÏÎ­Ï‡Î¿Î½Ï„Î¿Ï‚</button>
      <button class="btn" onclick="showArchives()" style="margin-left:10px;">ğŸ“ Î ÏÎ¿Î²Î¿Î»Î® Î‘ÏÏ‡ÎµÎ¯Ï‰Î½</button>
    </div>
  </section>
</main>

<!-- Î— Î£Î¤Î‘Î˜Î•Î¡Î— Î“Î¡Î‘ÎœÎœÎ— Î“Î™Î‘ Î“Î¡Î—Î“ÎŸÎ¡Î— Î•Î™Î£Î‘Î“Î©Î“Î— -->
<div class="sticky-quick-entry">
  <div class="quick-input-group quick-amount">
    <label>Î Î¿ÏƒÏŒ (â‚¬)</label>
    <input type="number" id="quick-amount" step="0.01" placeholder="0.00" onkeypress="handleQuickEntryKey(event)">
  </div>
  <div class="quick-input-group quick-category">
    <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
    <select id="quick-category"></select>
  </div>
  <div class="quick-input-group quick-note">
    <label>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</label>
    <input type="text" id="quick-note" placeholder="Î£ÏÎ½Ï„Î¿Î¼Î· Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î®" onkeypress="handleQuickEntryKey(event)">
  </div>
  <button class="quick-add-btn" onclick="addQuickExpense()">+</button>
</div>

<!-- MODAL Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ¥ -->
<div class="modal-overlay" id="syncModal">
  <div class="modal">
    <div class="modal-header">
      <h2>ğŸ”— Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï</h2>
      <button class="modal-close" onclick="closeSyncModal()">Ã—</button>
    </div>
    <div class="modal-body">
      <div id="sync-modal-content">
        <!-- Î¤Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ JavaScript -->
      </div>
    </div>
  </div>
</div>

<!-- MODAL ÎÎ•ÎŸÎ¥ ÎœÎ—ÎÎ‘ -->
<div class="modal-overlay" id="newMonthModal">
  <div class="modal">
    <div class="modal-header">
      <h2>ğŸ“… Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎÎ­Î¿Ï… ÎœÎ®Î½Î±</h2>
      <button class="modal-close" onclick="closeNewMonthModal()">Ã—</button>
    </div>
    <div class="modal-body">
      <p>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Î­Î½Î±Î½ Î½Î­Î¿ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒ Î³Î¹Î± Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î¼Î®Î½Î±.</p>
      <input type="month" id="new-month-input" style="width:100%; padding:12px; margin:15px 0;">
      <button class="btn btn-primary" onclick="createNewMonth()">ğŸš€ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î±</button>
    </div>
  </div>
</div>

<script>
// ==================== Î Î‘Î“Î™Î•Î£ Î¤Î™ÎœÎ•Î£ & ÎœÎ•Î¤Î‘Î’Î›Î—Î¤Î•Î£ ====================
let categories = JSON.parse(localStorage.getItem('budgetbuddy_cats') || '[]');
let expenses = JSON.parse(localStorage.getItem('budgetbuddy_expenses') || '[]');
let budgets = JSON.parse(localStorage.getItem('budgetbuddy_budgets') || '{}');
let bankBalances = JSON.parse(localStorage.getItem('budgetbuddy_banks') || JSON.stringify({
  alpha: 0, national: 0, cash: 0, expected: 0
}));
let syncData = JSON.parse(localStorage.getItem('budgetbuddy_sync') || '{}');
let currentUser = syncData.userName || 'ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±';
let currentBudgetCode = syncData.budgetCode || null;
let firebaseRef = null;
const currentMonth = new Date().toISOString().slice(0, 7);

// ==================== Î‘Î¡Î§Î™ÎšÎŸÎ ÎŸÎ™Î—Î£Î— ====================
function initApp() {
  // 1. Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚, Ï†ÏŒÏÏ„Ï‰ÏƒÎµ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚
  if (categories.length === 0) {
    categories = ['Î£Î¿ÏÏ€ÎµÏ ÎœÎ¬ÏÎºÎµÏ„', 'ÎÎ¿Î¯ÎºÎ¹', 'Î—Î»ÎµÎºÏ„ÏÎ¹ÎºÏŒ', 'ÎÎµÏÏŒ', 'Î¤Î·Î»Î­Ï†Ï‰Î½Î±', 'ÎšÎ±ÏÏƒÎ¹Î¼Î±', 'Î¨Ï…Ï‡Î±Î³Ï‰Î³Î¯Î±'];
    saveToStorage('budgetbuddy_cats', categories);
  }
  // 2. Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎµ Ï„Î·Î½ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÏƒÏ„Î· Î³ÏÎ®Î³Î¿ÏÎ· ÎµÎ¯ÏƒÎ¿Î´Î¿
  document.getElementById('quick-note').value = '';
  document.getElementById('quick-amount').value = '';
  // 3. Î¦ÏŒÏÏ„Ï‰ÏƒÎµ ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î·Î½ Î¿Î¸ÏŒÎ½Î·
  loadCategoriesToSelect();
  renderExpensesTable('today-expenses', getThisMonthExpenses().slice(0, 10));
  renderExpensesTable('all-expenses', expenses);
  renderBudgets();
  loadBankBalances();
  updateStatistics();
  updateSyncUI();
  // 4. Î•ÎºÎºÎ¯Î½Î·ÏƒÎ· ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚
  if (currentBudgetCode) initFirebaseSync();
  // 5. Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Event Listeners
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => switchTab(tab.dataset.tab));
  });
}
function handleQuickEntryKey(event) {
  if (event.key === 'Enter') addQuickExpense();
}

// ==================== Î“Î¡Î‘ÎœÎœÎ— Î“Î¡Î—Î“ÎŸÎ¡Î—Î£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£ ====================
function loadCategoriesToSelect() {
  const select = document.getElementById('quick-category');
  select.innerHTML = '<option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ...</option>' +
    categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
}
function addQuickExpense() {
  const amount = parseFloat(document.getElementById('quick-amount').value);
  const category = document.getElementById('quick-category').value;
  const note = document.getElementById('quick-note').value.trim();
  if (!amount || amount <= 0) return showMessage('Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€Î¿ÏƒÏŒ', 'error');
  if (!category) return showMessage('Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±', 'error');
  const newExpense = {
    id: Date.now(),
    amount: amount,
    category: category,
    note: note || 'Î§Ï‰ÏÎ¯Ï‚ ÏƒÎ·Î¼ÎµÎ¯Ï‰ÏƒÎ·',
    date: new Date().toISOString().slice(0, 10),
    month: currentMonth
  };
  expenses.unshift(newExpense);
  saveToStorage('budgetbuddy_expenses', expenses);
  renderExpensesTable('today-expenses', getThisMonthExpenses().slice(0, 10));
  renderExpensesTable('all-expenses', expenses);
  updateStatistics();
  // Reset form
  document.getElementById('quick-amount').value = '';
  document.getElementById('quick-note').value = '';
  document.getElementById('quick-category').value = '';
  showMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î­Î¾Î¿Î´Î¿ ${amount.toFixed(2)}â‚¬`, 'success');
  if (currentBudgetCode) syncToFirebase();
}

// ==================== Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£ ====================
function initFirebaseSync() {
  if (!currentBudgetCode) return;
  firebaseRef = firebase.database().ref(`budgets/${currentBudgetCode}`);
  updateSyncUI('connecting');
  firebaseRef.on('value', snapshot => {
    const data = snapshot.val();
    if (data) {
      // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿Î½ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿ Ï‡ÏÎ®ÏƒÏ„Î·
      if (syncData.userName !== data.creator) {
        if (data.categories) categories = data.categories;
        if (data.expenses) expenses = data.expenses;
        if (data.budgets) budgets = data.budgets;
        if (data.bankBalances) bankBalances = data.bankBalances;
        saveAllData();
        initApp(); // Î•Ï€Î±Î½Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î¿Î¸ÏŒÎ½Î·Ï‚
      }
      syncData.members = data.members || [currentUser];
      localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
      updateSyncUI('online', data);
    } else if (syncData.userName === data.creator) {
      createNewBudgetInFirebase();
    }
  }, error => {
    console.error('Î£Ï†Î¬Î»Î¼Î± Firebase:', error);
    updateSyncUI('offline');
  });
}
function syncToFirebase() {
  if (!currentBudgetCode || !firebaseRef) return;
  const budgetData = {
    code: currentBudgetCode,
    name: syncData.budgetName || 'ÎŸÎ¹ÎºÎ¿Î³ÎµÎ½ÎµÎ¹Î±ÎºÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚',
    creator: syncData.creator || currentUser,
    members: syncData.members || [currentUser],
    categories: categories,
    expenses: expenses,
    budgets: budgets,
    bankBalances: bankBalances,
    lastUpdated: Date.now()
  };
  firebaseRef.set(budgetData);
}
function updateSyncUI(status = 'offline', data = null) {
  const dot = document.getElementById('syncDot');
  const text = document.getElementById('syncText');
  const statusText = document.getElementById('sync-status-text');
  dot.className = 'sync-dot ' + status;
  if (status === 'online' && data) {
    text.textContent = `Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹ (${data.members?.length || 1})`;
    statusText.textContent = `Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹ ÏƒÏ„Î¿: ${data.name}`;
    dot.classList.add('online');
  } else if (status === 'connecting') {
    text.textContent = 'Î£Ï…Î½Î´Î­ÎµÏ„Î±Î¹...';
    statusText.textContent = 'Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÎµ ÎµÎ¾Î­Î»Î¹Î¾Î·...';
  } else {
    text.textContent = 'Î£ÏÎ½Î´ÎµÏƒÎ·';
    statusText.textContent = 'Î”ÎµÎ½ ÎµÎ¯ÏƒÏ„Îµ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹.';
    dot.classList.add('offline');
  }
}

// ==================== ÎœÎ•ÎÎŸÎ¥ & MODAL ====================
function openSyncModal() {
  const content = document.getElementById('sync-modal-content');
  if (currentBudgetCode) {
    content.innerHTML = `
      <h3>âœ… Î•Î¯ÏƒÏ„Îµ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹!</h3>
      <p><strong>ÎšÏ‰Î´Î¹ÎºÏŒÏ‚:</strong></p>
      <div style="background:#f5f5f5; padding:15px; border-radius:8px; margin:15px 0; text-align:center; font-family:monospace; font-size:24px; letter-spacing:3px;">
        ${currentBudgetCode}
      </div>
      <p>Î”ÏÏƒÏ„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÏƒÏ„Î¿Î½ ÏƒÏÎ¶Ï…Î³ÏŒ ÏƒÎ±Ï‚ Î³Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ·.</p>
      <button class="btn btn-success" style="width:100%; margin-bottom:10px;" onclick="copySyncCode()">ğŸ“‹ Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® ÎšÏ‰Î´Î¹ÎºÎ¿Ï</button>
      <button class="btn" style="width:100%; background:#f0f0f0;" onclick="disconnectSync()">ğŸ”Œ Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·</button>
    `;
  } else {
    content.innerHTML = `
      <h3>ğŸ”— Î£ÏÎ½Î´ÎµÏƒÎ· Î¼Îµ Ï„Î¿Î½/Ï„Î·Î½ ÏƒÏÎ¶Ï…Î³Î¿</h3>
      <p>Î“Î¹Î± ÎºÎ¿Î¹Î½Î® Ï‡ÏÎ®ÏƒÎ· Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿.</p>
      <div style="margin:20px 0;">
        <input type="text" id="sync-username" placeholder="Î¤Î¿ ÏŒÎ½Î¿Î¼Î¬ ÏƒÎ±Ï‚" value="${currentUser}" style="width:100%; padding:12px; margin-bottom:10px;">
        <input type="text" id="sync-budgetname" placeholder="ÎŒÎ½Î¿Î¼Î± Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï" style="width:100%; padding:12px;">
      </div>
      <button class="btn btn-primary" style="width:100%; margin-bottom:10px;" onclick="createNewSyncBudget()">ğŸš€ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎÎ­Î±Ï‚ ÎŸÎ¼Î¬Î´Î±Ï‚</button>
      <p style="text-align:center; margin:15px 0;">- Î® -</p>
      <input type="text" id="join-code" placeholder="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÎºÏ‰Î´Î¹ÎºÏŒ" style="width:100%; padding:12px; margin-bottom:10px; text-align:center; letter-spacing:3px;">
      <button class="btn btn-success" style="width:100%;" onclick="joinExistingBudget()">ğŸ”— Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÎµ Î¥Ï€Î¬ÏÏ‡Î¿Î½</button>
    `;
  }
  document.getElementById('syncModal').style.display = 'flex';
}
function createNewSyncBudget() {
  const userName = document.getElementById('sync-username').value.trim() || 'ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±';
  const budgetName = document.getElementById('sync-budgetname').value.trim() || 'ÎŸÎ¹ÎºÎ¿Î³ÎµÎ½ÎµÎ¹Î±ÎºÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚';
  currentUser = userName;
  currentBudgetCode = generateRandomCode();
  syncData = {
    userName: userName,
    budgetCode: currentBudgetCode,
    budgetName: budgetName,
    creator: userName,
    members: [userName],
    justCreated: true
  };
  localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
  showMessage(`âœ… Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î¿ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ "${budgetName}"`, 'success');
  closeSyncModal();
  initFirebaseSync();
  updateSyncUI();
}
function generateRandomCode() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let code = '';
  for (let i = 0; i < 6; i++) {
    code += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return code;
}
function copySyncCode() {
  navigator.clipboard.writeText(currentBudgetCode)
    .then(() => showMessage('ğŸ“‹ ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ!', 'success'));
}
function disconnectSync() {
  if (!confirm('Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î±Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Î±Ï€ÏŒ Ï„Î¿Î½ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ;')) return;
  if (firebaseRef) firebaseRef.off();
  currentBudgetCode = null;
  syncData = {};
  localStorage.setItem('budgetbuddy_sync', JSON.stringify({}));
  closeSyncModal();
  updateSyncUI();
  showMessage('ğŸ”Œ Î‘Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸Î®ÎºÎ±Ï„Îµ.', 'success');
}
function closeSyncModal() {
  document.getElementById('syncModal').style.display = 'none';
}
function switchTab(tabName) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(tabName + '-tab').classList.add('active');
  document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
}
function showNewMonthModal() { document.getElementById('newMonthModal').style.display = 'flex'; }
function closeNewMonthModal() { document.getElementById('newMonthModal').style.display = 'none'; }
function createNewMonth() {
  const newMonth = document.getElementById('new-month-input').value;
  if (!newMonth) return showMessage('Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î¼Î®Î½Î±', 'error');
  // Î•Î´Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î»Î¿Î³Î¹ÎºÎ® Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î®Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î® Î±ÏÏ‡ÎµÎ¹Î¿Î¸Î­Ï„Î·ÏƒÎ·Ï‚
  showMessage(`ğŸ“… ÎŸÏÎ¯ÏƒÏ„Î·ÎºÎµ Î¿ Î¼Î®Î½Î±Ï‚ ${newMonth}`, 'success');
  closeNewMonthModal();
}

// ==================== Î”Î™Î‘Î§Î•Î™Î¡Î™Î£Î— Î”Î•Î”ÎŸÎœÎ•ÎÎ©Î ====================
function saveAllData() {
  saveToStorage('budgetbuddy_cats', categories);
  saveToStorage('budgetbuddy_expenses', expenses);
  saveToStorage('budgetbuddy_budgets', budgets);
  saveToStorage('budgetbuddy_banks', bankBalances);
}
function saveToStorage(key, data) {
  localStorage.setItem(key, JSON.stringify(data));
}
function getThisMonthExpenses() {
  return expenses.filter(e => e.month === currentMonth);
}

// ==================== Î•ÎšÎ¤Î¥Î Î©Î£Î— Î”Î•Î”ÎŸÎœÎ•ÎÎ©Î Î£Î¤Î—Î ÎŸÎ˜ÎŸÎÎ— ====================
function renderExpensesTable(tableId, expensesList) {
  const tbody = document.querySelector(`#${tableId} tbody`);
  if (expensesList.length === 0) {
    tbody.innerHTML = `<tr><td colspan="5" style="text-align:center; padding:30px; color:#888;">Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î­Î¾Î¿Î´Î±.</td></tr>`;
    return;
  }
  tbody.innerHTML = expensesList.map(exp => `
    <tr>
      <td>${exp.date}</td>
      <td>${exp.category}</td>
      <td>${exp.note}</td>
      <td>${exp.amount.toFixed(2)} â‚¬</td>
      <td><button onclick="deleteExpense(${exp.id})" style="background:none; border:none; color:#f44336; cursor:pointer;">âœ•</button></td>
    </tr>
  `).join('');
}
function deleteExpense(id) {
  if (!confirm('Î”Î¹Î±Î³ÏÎ±Ï†Î® Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÎµÎ¾ÏŒÎ´Î¿Ï…;')) return;
  expenses = expenses.filter(e => e.id !== id);
  saveToStorage('budgetbuddy_expenses', expenses);
  renderExpensesTable('today-expenses', getThisMonthExpenses().slice(0, 10));
  renderExpensesTable('all-expenses', expenses);
  updateStatistics();
  showMessage('ğŸ—‘ï¸ Î¤Î¿ Î­Î¾Î¿Î´Î¿ Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ', 'success');
}
function renderBudgets() {
  const container = document.getElementById('budgets-container');
  container.innerHTML = categories.map(cat => `
    <div class="card">
      <h4>${cat}</h4>
      <input type="number" id="budget-${cat}" value="${budgets[cat] || 0}" step="0.01" placeholder="0.00 â‚¬" onchange="updateSingleBudget('${cat}', this.value)">
    </div>
  `).join('');
}
function updateSingleBudget(cat, val) {
  budgets[cat] = parseFloat(val) || 0;
}
function saveBudgets() {
  // Î¤Î± budgets Î­Ï‡Î¿Ï…Î½ Î®Î´Î· ÎµÎ½Î·Î¼ÎµÏÏ‰Î¸ÎµÎ¯ Î±Ï€ÏŒ Ï„Î± onchange events
  saveToStorage('budgetbuddy_budgets', budgets);
  showMessage('âœ… ÎŸÎ¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
}
function loadBankBalances() {
  const banks = ['alpha', 'national', 'cash', 'expected'];
  banks.forEach(bank => {
    const el = document.getElementById(`bank-${bank}`);
    if (el) el.value = bankBalances[bank] || '';
  });
}
function saveBankBalances() {
  bankBalances = {
    alpha: parseFloat(document.getElementById('bank-alpha').value) || 0,
    national: parseFloat(document.getElementById('bank-national').value) || 0,
    cash: parseFloat(document.getElementById('cash').value) || 0,
    expected: parseFloat(document.getElementById('expected-income').value) || 0
  };
  saveToStorage('budgetbuddy_banks', bankBalances);
  showMessage('ğŸ¦ Î¤Î± Ï„ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
}
function addNewCategory() {
  const input = document.getElementById('new-cat-name');
  const name = input.value.trim();
  if (!name) return showMessage('Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚', 'error');
  if (categories.includes(name)) return showMessage('Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·', 'error');
  categories.push(name);
  saveToStorage('budgetbuddy_cats', categories);
  loadCategoriesToSelect();
  renderBudgets();
  updateCategoriesList();
  input.value = '';
  showMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${name}"`, 'success');
}
function updateCategoriesList() {
  const list = document.getElementById('categories-list');
  list.innerHTML = categories.map(cat => `
    <div style="background:#f0f0f0; padding:8px 12px; border-radius:6px; margin-bottom:5px; display:flex; justify-content:space-between;">
      <span>${cat}</span>
      <button onclick="deleteCategory('${cat}')" style="background:none; border:none; color:#f44336; cursor:pointer;">âœ•</button>
    </div>
  `).join('');
}
function deleteCategory(catName) {
  if (!confirm(`Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ "${catName}";\nÎ˜Î± Î´Î¹Î±Î³ÏÎ±Ï†Î¿ÏÎ½ ÎºÎ±Î¹ Ï„Î± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î­Î¾Î¿Î´Î±.`)) return;
  categories = categories.filter(c => c !== catName);
  expenses = expenses.filter(e => e.category !== catName);
  delete budgets[catName];
  saveAllData();
  loadCategoriesToSelect();
  renderExpensesTable('today-expenses', getThisMonthExpenses().slice(0, 10));
  renderExpensesTable('all-expenses', expenses);
  renderBudgets();
  updateCategoriesList();
  showMessage(`ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ Î· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${catName}"`, 'success');
}

// ==================== Î£Î¤Î‘Î¤Î™Î£Î¤Î™ÎšÎ‘ ====================
function updateStatistics() {
  const monthExpenses = getThisMonthExpenses();
  const total = monthExpenses.reduce((sum, e) => sum + e.amount, 0);
  const average = monthExpenses.length > 0 ? total / monthExpenses.length : 0;
  // Î’ÏÎµÏ‚ Ï„Î· Î´Î·Î¼Î¿Ï†Î¹Î»Î­ÏƒÏ„ÎµÏÎ· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±
  const catCount = {};
  monthExpenses.forEach(e => { catCount[e.category] = (catCount[e.category] || 0) + 1; });
  let topCat = '-';
  let max = 0;
  for (const cat in catCount) {
    if (catCount[cat] > max) { max = catCount[cat]; topCat = cat; }
  }
  document.getElementById('stat-total').textContent = total.toFixed(2) + ' â‚¬';
  document.getElementById('stat-average').textContent = average.toFixed(2) + ' â‚¬';
  document.getElementById('stat-top-category').textContent = topCat;
  document.getElementById('stat-count').textContent = monthExpenses.length;
  // Î‘Ï€Î»ÏŒ chart
  updateSimpleChart(catCount);
}
function updateSimpleChart(catData) {
  const container = document.getElementById('chart-container');
  const max = Math.max(...Object.values(catData), 1);
  container.innerHTML = Object.entries(catData).map(([cat, value]) => `
    <div style="margin-bottom:10px;">
      <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
        <span>${cat}</span>
        <span>${value} Î­Î¾Î¿Î´Î±</span>
      </div>
      <div style="height:10px; background:#e0e0e0; border-radius:5px; overflow:hidden;">
        <div style="height:100%; background:#e91e63; width:${(value/max)*100}%;"></div>
      </div>
    </div>
  `).join('');
}

// ==================== Î’ÎŸÎ—Î˜Î—Î¤Î™ÎšÎ•Î£ ====================
function showMessage(text, type = 'info') {
  const existing = document.getElementById('temp-msg');
  if (existing) existing.remove();
  const msg = document.createElement('div');
  msg.id = 'temp-msg';
  msg.style.cssText = `
    position: fixed; top: 100px; left: 50%; transform: translateX(-50%);
    background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#333'};
    color: white; padding: 12px 24px; border-radius: 25px; z-index: 10000;
    font-size: 14px; animation: fadeInOut 3s ease-in-out; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: flex; align-items: center; gap: 8px;
  `;
  msg.innerHTML = `${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'} <span>${text}</span>`;
  document.body.appendChild(msg);
  if (!document.getElementById('msg-styles')) {
    const style = document.createElement('style');
    style.id = 'msg-styles';
    style.textContent = `@keyframes fadeInOut { 0%,100% { opacity:0; transform:translateX(-50%) translateY(-20px); } 10%,90% { opacity:1; transform:translateX(-50%) translateY(0); } }`;
    document.head.appendChild(style);
  }
  setTimeout(() => { if (msg.parentNode) msg.remove(); }, 3000);
}

// ==================== Î‘Î¡Î§Î— Î•ÎšÎ¤Î•Î›Î•Î£Î—Î£ ====================
window.addEventListener('DOMContentLoaded', initApp);
</script>
</body>
</html>
