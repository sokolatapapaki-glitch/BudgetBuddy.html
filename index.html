<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ‰ÏƒÏ„ÏÎ½ favicons Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ -->
<link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23e91e63%22>ğŸŒ¸</text></svg>">
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFRSURBVHgB7Za9SgNBFIVPd2Plo5U2gq0/IDaCjVjYibWCIJjO0t+QxsYH0AfwAaszETkGwsfApfAGx0E6wsBDh2oSo6yST2Y3uslfYBWc+uDB7mbln5s7s7gAOh8Ph+M8QYAOANSwA8IyCQQDWsADAOxaEAgBvWBACADxjQSAA8IQFoQDAIxaEAgAPWBAGANxjQRAAMLAgDAC4w4IgAGCDC6IAgFssCAIAbrAgCgC4xoIoAOAaC6IAgCssiAIArrEgCgC4woIoAOAyC6IAgMssiAIAzrMgCAA4y4IgAOAsC4IAgDMsCAIAzrAgCgA4xoIoAOAYC6IAgCMsCAIADrAgCgA4wIIoAOAQZ84CAGNv2E22n6JhAgFgvKX+BKBf3AYBrF/BCuuvYYUA2Jg8gI1pAJC16b+V1XkAe6oDLJ+sAiB7cwDqj37A4pJSAORvAEi9n+oA0nVAVqsCUvTfADaMAAzYsgIy+lFDRn8GGf0Y8vR7kKffgTz9HuTp9yBPvwcF6PcgT78DBen3oED9DhSs34Ei9TtQpH4HitTvQJH6HShSvwNF6vdQqH4Pher3UKh+D8b6HTS0fyZQ/1fUTP8NGut30Oz0/4o+0e+gWel3OJx+nf4ODdH/cqBO1QAAAABJRU5ErkJggg==">
<link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFQSURBVHgBtZQ9SgNBFIVnNlaihYWoWIn4A2Il2Ig2YmEhtgpCMJ2lvyGNjQ+gD+AFrEQ7BcHGwgp/QCy0EywsRLg2Ieo6ySR7Y3c3u8smd8+duzNzz9w7O5MBaIZrJgBPKBgE4A0LAjxjQSAA8IwFgQDAExYEAgAPWBAIADxgQSAAcI8FgQDAHRYEAgC3WBAIANxgQSAAcI0FgQDAPywoBwBm7kIe8ocOBs4p8hHnT6DYfCx3oYkZWC0XAGhTO8wOZteYdgGk+AG1g1g7L0R+ePilGMCWJ1A7iGX6kPIs1idT9AWWXIDaQUzyPVQc+e3bCz2DRXMKtYNp3cZ7LITI/yozcMgFqB3M+DZe40n69q0fALgpBqgdxGL1N74n0jH55fE3ZbQBqL1E7WAWezmzz5uU74P0Xb/3AajdRO1g4qM24zFOX7Z+AUADFR9+UwEwAAAAAElFTkSuQmCC">
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23e91e63%22>ğŸŒ¸</text></svg>">

<!-- Î§ÏÏÎ¼Î± Î¸Î­Î¼Î±Ï„Î¿Ï‚ Î³Î¹Î± Android -->
<meta name="theme-color" content="#e91e63">
<meta name="msapplication-TileColor" content="#e91e63">
<meta name="msapplication-navbutton-color" content="#e91e63">

<!-- Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· web app manifest Î³Î¹Î± PWA -->
<link rel="manifest" href="data:application/manifest+json,{
  \"name\": \"BudgetBuddy ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï\",
  \"short_name\": \"BudgetBuddy\",
  \"description\": \"Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î¿Î¹ÎºÎ¿Î³ÎµÎ½ÎµÎ¹Î±ÎºÏÎ½ ÎµÎ¾ÏŒÎ´Ï‰Î½\",
  \"start_url\": \".\",
  \"display\": \"standalone\",
  \"background_color\": \"#ffe6f1\",
  \"theme_color\": \"#e91e63\",
  \"icons\": [
    {
      \"src\": \"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90' fill='%23e91e63'>ğŸŒ¸</text></svg>\",
      \"sizes\": \"any\",
      \"type\": \"image/svg+xml\"
    },
    {
      \"src\": \"data:image/png;base64,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\",
      \"sizes\": \"192x192\",
      \"type\": \"image/png\"
    },
    {
      \"src\": \"data:image/png;base64,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\",
      \"sizes\": \"512x512\",
      \"type\": \"image/png\"
    }
  ]
}">

<!-- Apple specific meta tags -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="BudgetBuddy">
<meta name="format-detection" content="telephone=no">
<meta name="mobile-web-app-capable" content="yes">
<title>BudgetBuddy â€” ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23e91e63%22>ğŸŒ¸</text></svg>">
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(to bottom, #ffe6f1, #fff0f7);
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    -webkit-tap-highlight-color: transparent;
  }

  /* Î£Ï„Ï…Î» Î³Î¹Î± ÏƒÏ„Î±Î¸ÎµÏÎ¿ quick entry ÏƒÏ„Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ */
  .quick-entry-sticky {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    padding: 15px;
    border-top: 2px solid #e91e63;
    box-shadow: 0 -5px 20px rgba(0,0,0,0.15);
    z-index: 1000;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
    transition: transform 0.3s ease;
  }
  
  .quick-entry-sticky.hidden {
    transform: translateY(100%);
  }

  .quick-entry-item {
    flex: 1;
    min-width: 0;
  }

  .quick-entry-item label {
    display: block;
    font-size: 12px;
    color: #666;
    margin-bottom: 5px;
    font-weight: bold;
  }

  .quick-amount {
    width: 120px;
  }

  .quick-category {
    flex: 1.5;
  }

  .quick-note {
    flex: 2;
  }

  .quick-add {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #e91e63;
    color: white;
    border: none;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 15px rgba(233, 30, 99, 0.3);
    transition: all 0.3s;
    margin-left: auto;
  }

  .quick-add:hover {
    background: #d81b60;
    transform: scale(1.1);
  }

  .toggle-quick-entry {
    position: fixed;
    bottom: 85px;
    right: 20px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #9c27b0;
    color: white;
    border: none;
    font-size: 20px;
    cursor: pointer;
    z-index: 1001;
    box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .stars {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 150px;
    overflow: hidden;
    z-index: 0;
  }

  .star {
    position: absolute;
    color: #fff;
    font-size: 18px;
    opacity: 0.8;
    animation: twinkle 5s infinite ease-in-out;
  }

  @keyframes twinkle {
    0%,100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.3); }
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 900px;
    margin: 80px auto 90px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    padding: 20px;
  }

  h1 {
    text-align: center;
    color: #e91e63;
    position: relative;
    margin-top: 10px;
  }

  .sync-header {
    position: relative;
    display: inline-block;
    padding-right: 50px;
  }
  
  .sync-button-header {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    background: #e91e63;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 5px 15px;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    box-shadow: 0 2px 5px rgba(233, 30, 99, 0.3);
    transition: all 0.3s;
  }
  
  .sync-button-header:hover {
    background: #d81b60;
    transform: translateY(-50%) scale(1.05);
  }
  
  .big-sync-button {
    position: fixed;
    top: 15px;
    right: 15px;
    background: #e91e63;
    color: white;
    border: none;
    border-radius: 25px;
    padding: 8px 16px;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    z-index: 1000;
    transition: all 0.3s;
  }
  
  .big-sync-button:hover {
    background: #d81b60;
    transform: scale(1.05);
    box-shadow: 0 6px 15px rgba(0,0,0,0.3);
  }
  
  .sync-status-dot {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-left: 8px;
    vertical-align: middle;
  }
  
  .sync-online { background: #4caf50; animation: pulse 2s infinite; }
  .sync-offline { background: #f44336; }
  .sync-connecting { background: #ff9800; animation: pulse 2s infinite; }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  
  .code-modal, .sync-modal, .custom-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    padding: 20px;
  }
  
  .code-modal-content, .sync-modal-content, .custom-modal-content {
    background: white;
    border-radius: 15px;
    padding: 30px;
    max-width: 400px;
    width: 100%;
    text-align: center;
    box-shadow: 0 15px 40px rgba(0,0,0,0.3);
  }
  
  .code-display {
    font-size: 42px;
    font-weight: bold;
    letter-spacing: 5px;
    color: #e91e63;
    background: #ffe6f1;
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    font-family: monospace;
  }

  /* Î’ÎµÎ»Ï„Î¹Ï‰Î¼Î­Î½Î¿ input ÎºÎ±Î¹ select Î³Î¹Î± ÎºÎ¹Î½Î·Ï„ÏŒ */
  input, select, button {
    padding: 14px 15px;
    border-radius: 10px;
    border: 2px solid #ddd;
    font-size: 16px;
    margin: 0;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    box-sizing: border-box;
    font-family: "Segoe UI", sans-serif;
  }
  
  input:focus, select:focus {
    outline: none;
    border-color: #e91e63;
    box-shadow: 0 0 0 3px rgba(233, 30, 99, 0.1);
  }
  
  button {
    cursor: pointer;
    transition: all 0.2s;
    font-weight: 600;
  }
  
  button:active {
    transform: scale(0.95);
    opacity: 0.9;
  }

  select {
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e91e63' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 15px center;
    background-size: 16px;
    padding-right: 45px;
  }

  button.add { 
    background: #e91e63; 
    color: white; 
    border: none;
    font-weight: bold;
    height: 60px;
  }

  button.del { background: #f44336; color: white; border: none; }
  button.cat { background: #ff80ab; color: white; border: none; }
  button.recurring { background: #4caf50; color: white; border: none; margin-top: 10px; }
  button.edit { background: #2196f3; color: white; border: none; padding: 4px 8px; font-size: 12px; }
  button.bank { background: #9c27b0; color: white; border: none; }

  /* ÎšÏÏ…Ï†ÏŒ Ï„Î¿ regular expense form - Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Î¼ÏŒÎ½Î¿ Ï„Î¿ sticky */
  .regular-expense-form {
    display: none;
  }

  /* Î£Ï„Ï…Î» Î³Î¹Î± Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }

  th, td {
    padding: 12px 8px;
    border-bottom: 1px solid #eee;
    text-align: left;
  }

  th {
    background: #ffe4ec;
    font-weight: 600;
  }

  .summary {
    margin-top: 20px;
    padding: 15px;
    background: #fff0f7;
    border-radius: 8px;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-top: 15px;
  }

  .summary-box {
    padding: 15px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

  .final-summary {
    margin-top: 20px;
    padding: 20px;
    background: linear-gradient(to right, #e8f5e9, #f1f8e9);
    border-radius: 8px;
    border: 2px solid #4caf50;
  }

  .final-numbers {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 15px;
  }

  .final-number {
    text-align: center;
    padding: 15px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .final-number h4 {
    margin: 0 0 10px 0;
    color: #333;
    font-size: 14px;
  }

  .final-number-value {
    font-size: 24px;
    font-weight: bold;
    margin: 10px 0;
  }

  .catlist {
    margin-top: 10px;
    font-size: 14px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
  }

  .category-item {
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #e91e63;
  }

  .category-item.over {
    border-left-color: #f44336;
  }

  .category-item.under {
    border-left-color: #4caf50;
  }

  .footer {
    text-align: center;
    margin-top: 20px;
    color: #888;
    font-size: 13px;
    padding: 10px;
    background: #f9f9f9;
    border-radius: 8px;
  }

  .categories-manager {
    margin: 20px 0;
    padding: 15px;
    background: #f9f9f9;
    border-radius: 8px;
  }

  .categories-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 10px 0;
  }

  .category-tag {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 8px 12px;
    background: #e91e63;
    color: white;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 500;
  }

  .category-tag button {
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    padding: 0;
    font-size: 14px;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .connected-users {
    margin: 15px 0;
    padding: 10px;
    background: #e8f5e9;
    border-radius: 8px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
    max-height: 80px;
    overflow-y: auto;
  }
  
  .user-badge {
    background: #4caf50;
    color: white;
    padding: 6px 12px;
    border-radius: 15px;
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .user-badge.you {
    background: #e91e63;
  }
  
  .user-badge.creator {
    background: #ff9800;
  }

  /* ÎÎ­Î± Î£Ï„Ï…Î» Î³Î¹Î± ÏƒÏ„Î±Î¸ÎµÏÎ¬ ÎºÎ¿Ï…Î¼Ï€Î¹Î¬ ÎºÎ¿ÏÏ…Ï†Î®Ï‚ */
  .top-action-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 15px 0 20px;
    flex-wrap: wrap;
  }
  
  .top-action-button {
    padding: 10px 20px;
    background: #9c27b0;
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s;
  }
  
  .top-action-button:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(156, 39, 176, 0.3);
  }
  
  .top-action-button:nth-child(2) {
    background: #ff9800;
  }
  
  .top-action-button:nth-child(3) {
    background: #607d8b;
  }

  /* MEDIA QUERY Î³Î¹Î± ÎºÎ¹Î½Î·Ï„Î¬ */
  @media (max-width: 768px) {
    .container {
      margin: 70px 10px 90px;
      padding: 15px;
    }
    
    h1 {
      font-size: 1.4em;
      padding-right: 0;
    }
    
    .sync-header {
      padding-right: 0;
      display: block;
    }
    
    .sync-button-header {
      position: relative;
      margin: 10px auto;
      right: auto;
      top: auto;
      transform: none;
      display: block;
      width: fit-content;
    }
    
    .big-sync-button {
      top: 10px;
      right: 10px;
      padding: 6px 12px;
      font-size: 12px;
    }
    
    .quick-entry-sticky {
      padding: 12px;
      gap: 8px;
    }
    
    .quick-entry-item {
      min-width: calc(50% - 8px);
    }
    
    .quick-amount {
      width: 100%;
    }
    
    .quick-add {
      width: 50px;
      height: 50px;
      font-size: 20px;
    }
    
    .toggle-quick-entry {
      bottom: 75px;
      right: 15px;
      width: 45px;
      height: 45px;
    }
    
    .final-numbers {
      grid-template-columns: 1fr;
      gap: 15px;
    }
    
    .summary-grid {
      grid-template-columns: 1fr;
    }
    
    .catlist {
      grid-template-columns: 1fr;
    }
    
    table {
      font-size: 14px;
    }
    
    th, td {
      padding: 10px 5px;
    }
    
    .top-action-buttons {
      flex-direction: column;
      align-items: stretch;
    }
    
    .top-action-button {
      justify-content: center;
      padding: 12px;
    }
  }

  /* Î“Î¹Î± Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎµÏ‚ Î¿Î¸ÏŒÎ½ÎµÏ‚, ÎºÏÎ±Ï„Î¬Î¼Îµ ÎºÎ±Î¹ Ï„Î¿ regular form */
  @media (min-width: 769px) {
    .quick-entry-sticky {
      display: none;
    }
    
    .toggle-quick-entry {
      display: none;
    }
    
    .regular-expense-form {
      display: block;
      margin: 20px 0;
    }
    
    .expense-form-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: flex-end;
    }
    
    .expense-field {
      flex: 1;
      min-width: 150px;
    }
    
    .expense-field label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #555;
    }
    
    .amount-add-container {
      display: flex;
      gap: 15px;
      align-items: flex-end;
    }
    
    .amount-field {
      width: 150px;
    }
  }

</style>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
</head>
<body>

<div class="stars" id="stars"></div>

<!-- ÎšÎŸÎ¥ÎœÎ Î™ Î£Î¥ÎÎ”Î•Î£Î—Î£ ÎšÎŸÎ¡Î¥Î¦Î—Î£ -->
<button class="big-sync-button" onclick="showSyncModal()" id="mainSyncButton">
  ğŸ”— Î£Î¥ÎÎ”Î•Î£Î—
  <span class="sync-status-dot" id="mainSyncDot"></span>
</button>

<!-- TOGGLE ÎšÎŸÎ¥ÎœÎ Î™ Î“Î™Î‘ QUICK ENTRY -->
<button class="toggle-quick-entry" onclick="toggleQuickEntry()" id="toggleQuickEntry">ğŸ“</button>

<!-- Î£Î¤Î‘Î˜Î•Î¡ÎŸ QUICK ENTRY ÎœÎ Î‘Î¡Î‘ Î£Î¤ÎŸ ÎšÎ™ÎÎ—Î¤ÎŸ -->
<div class="quick-entry-sticky" id="quickEntrySticky">
  <div class="quick-entry-item quick-amount">
    <label>Î Î¿ÏƒÏŒ (â‚¬)</label>
    <input type="number" id="quickAmount" step="0.01" placeholder="0.00" value="">
  </div>
  
  <div class="quick-entry-item quick-category">
    <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
    <select id="quickCategory"></select>
  </div>
  
  <div class="quick-entry-item quick-note">
    <label>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</label>
    <input type="text" id="quickNote" placeholder="Î£ÏÎ½Ï„Î¿Î¼Î· ÏƒÎ·Î¼ÎµÎ¯Ï‰ÏƒÎ·" value="">
  </div>
  
  <button class="quick-add" onclick="addExpenseFromQuickEntry()" id="quickAddButton">
    â•
  </button>
</div>

<!-- MODAL Î“Î™Î‘ Î•ÎœÎ¦Î‘ÎÎ™Î£Î— ÎšÎ©Î”Î™ÎšÎŸÎ¥ -->
<div class="code-modal" id="codeModal">
  <div class="code-modal-content">
    <h2 style="color: #e91e63;">ğŸ‰ ÎÎ•ÎŸÎ£ Î Î¡ÎŸÎ¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ£!</h2>
    <p>ÎŸ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ®Ï‚ ÏƒÎ±Ï‚:</p>
    
    <div class="code-display" id="generatedCode"></div>
    
    <p style="color: #666; margin: 15px 0;">
      <strong>ğŸ“ Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·:</strong> Î”ÏÏƒÏ„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÏƒÏ„Î¿Î½ ÏƒÏÎ¶Ï…Î³ÏŒ ÏƒÎ±Ï‚ Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯.
    </p>
    
    <div style="display: flex; gap: 10px; margin: 20px 0;">
      <button onclick="showQRForCode()" style="flex: 1; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer;">
        ğŸ“± QR Code
      </button>
      <button onclick="copyGeneratedCode()" style="flex: 1; padding: 12px; background: #2196f3; color: white; border: none; border-radius: 8px; cursor: pointer;">
        ğŸ“‹ Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î®
      </button>
    </div>
    
    <button onclick="closeCodeModal()" style="width: 100%; padding: 12px; background: #e91e63; color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 10px;">
      âœ… ÎšÎ±Ï„Î¬Î»Î±Î²Î±
    </button>
  </div>
</div>

<!-- ÎŸÎ›Î— Î— Î•Î¦Î‘Î¡ÎœÎŸÎ“Î— -->
<div class="container">
  <h1>
    <div class="sync-header">
      ğŸŒ¸ BudgetBuddy â€” ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï ğŸŒ¸
      <button class="sync-button-header" onclick="showSyncModal()">
        <span id="syncButtonText">Î£Ï…Î½Î´Î­ÏƒÎ¿Ï…</span>
        <span class="sync-status-dot" id="headerSyncDot"></span>
      </button>
    </div>
  </h1>
  
  <!-- Î£Î¥ÎÎ”Î•Î”Î•ÎœÎ•ÎÎŸÎ™ Î§Î¡Î—Î£Î¤Î•Î£ -->
  <div class="connected-users" id="connectedUsers" style="display: none;">
    <strong>Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹:</strong>
    <div id="usersList"></div>
  </div>

  <!-- Î£Î¤Î‘Î˜Î•Î¡Î‘ ÎšÎŸÎ¥ÎœÎ Î™Î‘ ÎšÎŸÎ¡Î¥Î¦Î—Î£ -->
  <div class="top-action-buttons">
    <button class="top-action-button" onclick="showNewBudgetModal()">
      ğŸ“… ÎÎ­Î¿Ï‚ ÎœÎ®Î½Î±Ï‚
    </button>
    <button class="top-action-button" onclick="saveArchivedBudget()">
      ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·
    </button>
    <button class="top-action-button" onclick="showArchivedBudgets()">
      ğŸ“ Î‘ÏÏ‡ÎµÎ¯Î±
    </button>
  </div>

  <!-- Î¤Î¡Î•Î§ÎŸÎ ÎœÎ—ÎÎ‘ ÎšÎ‘Î™ Î•Î™Î£ÎŸÎ”Î—ÎœÎ‘ -->
  <div style="margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 15px; align-items: center;">
    <div style="flex: 1; min-width: 200px;">
      <label style="display: block; margin-bottom: 5px; font-weight: bold;">ÎœÎ®Î½Î±Ï‚:</label>
      <input type="month" id="month" value="" style="width: 100%;">
    </div>
    
    <div style="flex: 1; min-width: 200px;">
      <label style="display: block; margin-bottom: 5px; font-weight: bold;">ÎœÎ·Î½Î¹Î±Î¯Î¿ ÎµÎ¹ÏƒÏŒÎ´Î·Î¼Î± (â‚¬):</label>
      <input type="number" id="income" value="" placeholder="2000" style="width: 100%;">
    </div>
  </div>

  <!-- REGULAR EXPENSE FORM (Î¼ÏŒÎ½Î¿ Î³Î¹Î± desktop) -->
  <div class="regular-expense-form">
    <h3>â• ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· ÎµÎ¾ÏŒÎ´Î¿Ï…</h3>
    <div class="expense-form-container">
      <div class="expense-field amount-field">
        <label>Î Î¿ÏƒÏŒ (â‚¬):</label>
        <input type="number" id="amount" step="0.01" placeholder="0.00" value="">
      </div>
      
      <div class="expense-field">
        <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±:</label>
        <select id="category"></select>
      </div>
      
      <div class="expense-field">
        <label>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±:</label>
        <input type="date" id="date" value="">
      </div>
      
      <div class="expense-field" style="flex: 2;">
        <label>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·:</label>
        <input type="text" id="note" placeholder="Ï€.Ï‡. ÏˆÏÎ½Î¹Î± ÏƒÎ¿ÏÏ€ÎµÏ Î¼Î¬ÏÎºÎµÏ„" value="">
      </div>
      
      <div class="amount-add-container">
        <button class="add" onclick="addExpense()" id="addButton">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·</button>
      </div>
    </div>
  </div>

  <!-- Î¤Î¡Î‘Î Î•Î–Î™ÎšÎ‘ Î¥Î ÎŸÎ›ÎŸÎ™Î Î‘ -->
  <h3>ğŸ’° Î¤ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î±</h3>
  <div class="bank-section" style="margin: 15px 0; padding: 15px; background: #f0f8ff; border-radius: 8px;">
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
      <div>
        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Î‘Î»Ï†Î± Î¤ÏÎ¬Ï€ÎµÎ¶Î±</label>
        <input type="number" id="alphaBank" step="0.01" placeholder="0.00" value="" style="width: 100%;">
      </div>
      <div>
        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Î•Î¸Î½Î¹ÎºÎ® Î¤ÏÎ¬Ï€ÎµÎ¶Î±</label>
        <input type="number" id="nationalBank" step="0.01" placeholder="0.00" value="" style="width: 100%;">
      </div>
      <div>
        <label style="display: block; margin-bottom: 5px; font-weight: bold;">ÎœÎµÏ„ÏÎ·Ï„Î¬</label>
        <input type="number" id="cash" step="0.01" placeholder="0.00" value="" style="width: 100%;">
      </div>
      <div>
        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Î˜Î± Ï€Î¬ÏÏ‰ Î±ÎºÏŒÎ¼Î±</label>
        <input type="number" id="expectedIncome" step="0.01" placeholder="0.00" value="" style="width: 100%;">
      </div>
    </div>
    <button class="bank" onclick="saveBankBalances()" style="margin-top: 15px; width: 100%; padding: 12px;">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î¥Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½</button>
  </div>

  <!-- Î”Î™Î‘Î§Î•Î™Î¡Î™Î£Î— ÎšÎ‘Î¤Î—Î“ÎŸÎ¡Î™Î©Î -->
  <h3>âš™ï¸ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½</h3>
  <div class="categories-manager">
    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
      <input type="text" id="newCategoryName" placeholder="ÎŒÎ½Î¿Î¼Î± Î½Î­Î±Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚" style="flex: 1; min-width: 200px;" value="">
      <button class="cat" onclick="addNewCategory()" id="addCategoryButton">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚</button>
    </div>
    
    <div class="categories-list" id="categoriesList"></div>
  </div>

  <!-- ÎœÎ—ÎÎ™Î‘Î™ÎŸÎ™ Î Î¡ÎŸÎ¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ™ -->
  <h3>ğŸ’° ÎœÎ·Î½Î¹Î±Î¯Î¿Î¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯</h3>
  <div id="recurringSetup" style="padding: 15px; background: #f9f9f9; border-radius: 8px; margin-bottom: 20px;">
    <div id="recurringInputs"></div>
    <div style="display: flex; gap: 10px; margin-top: 15px;">
      <button class="recurring" onclick="saveRecurringAmounts()" style="flex: 1;">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
      <button class="recurring" onclick="generateRecurringExpenses()" style="flex: 1;">ğŸ”„ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î•Î¾ÏŒÎ´Ï‰Î½</button>
    </div>
  </div>

  <!-- Î Î™ÎÎ‘ÎšÎ‘Î£ Î•ÎÎŸÎ”Î©Î -->
  <h3>ğŸ“‹ Î Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ¾ÏŒÎ´Ï‰Î½</h3>
  <table id="expensesTable">
    <thead>
      <tr>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</th>
        <th>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</th>
        <th>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</th>
        <th>Î Î¿ÏƒÏŒ (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  
  <!-- Î£Î¤Î‘Î¤Î™Î£Î¤Î™ÎšÎ‘ -->
  <h3>ğŸ“ˆ Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬</h3>
  <div class="stats-section" style="margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 10px;">
    <div class="stats-grid" id="statsGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;"></div>
    
    <div class="chart-container" style="margin-top: 20px; padding: 15px; background: white; border-radius: 10px;">
      <h4 style="margin-top: 0; color: #e91e63;">ğŸ“Š ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î•Î¾ÏŒÎ´Ï‰Î½</h4>
      <div id="expenseChart" style="height: 200px; display: flex; align-items: flex-end; gap: 5px; padding: 10px; border: 1px solid #eee; border-radius: 8px;"></div>
    </div>
  </div>
  
  <!-- Î£Î¥ÎÎŸÎ¨Î— ÎšÎ‘Î¤Î—Î“ÎŸÎ¡Î™Î©Î -->
  <h3>ğŸ“Š Î£ÏÎ½Î¿ÏˆÎ· Î±Î½Î¬ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</h3>
  <div class="catlist" id="catList"></div>

  <!-- Î¤Î•Î›Î™ÎšÎ— Î£Î¥ÎÎŸÎ¨Î— -->
  <h3>ğŸ’° Î¤Î•Î›Î™ÎšÎ— Î£Î¥ÎÎŸÎ¨Î—</h3>
  <div class="final-summary">
    <div class="final-numbers">
      <div class="final-number">
        <h4>Î•Î§ÎŸÎ¥Î ÎÎŸÎ”Î•Î¥Î¤Î•Î™</h4>
        <div class="final-number-value" id="totalSpent">0 â‚¬</div>
      </div>
      
      <div class="final-number">
        <h4>Î¥Î ÎŸÎ›ÎŸÎ™Î ÎŸ Î•ÎÎŸÎ”Î©Î</h4>
        <div class="final-number-value" id="remainingExpenses">0 â‚¬</div>
      </div>
      
      <div class="final-number">
        <h4>Î£Î¥ÎÎŸÎ›ÎŸ Î•Î£ÎŸÎ”Î©Î</h4>
        <div class="final-number-value" id="totalIncome">0 â‚¬</div>
      </div>
    </div>
    
    <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; text-align: center;">
      <h4 style="margin: 0 0 10px 0; color: #333;">Î¤Î•Î›Î™ÎšÎŸ Î¥Î ÎŸÎ›ÎŸÎ™Î ÎŸ</h4>
      <div style="font-size: 28px; font-weight: bold; color: #e91e63;" id="finalBalance">0 â‚¬</div>
    </div>
  </div>

  <div class="footer" id="footerText">
    Î”ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ Ï„Î¿Ï€Î¹ÎºÎ¬ (localStorage).
    <div id="syncInfo" style="margin-top: 5px;"></div>
  </div>
</div>

<!-- MODAL Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ¥ -->
<div class="sync-modal" id="syncModal">
  <div class="sync-modal-content">
    <h2>ğŸ”— Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£</h2>
    <div id="syncModalContent"></div>
    <div style="text-align: center; margin-top: 20px;">
      <button onclick="closeSyncModal()" style="padding: 10px 25px; background: #f0f0f0; border: none; border-radius: 8px; cursor: pointer;">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
  </div>
</div>

<!-- CUSTOM MODAL -->
<div class="custom-modal" id="customModal">
  <div class="custom-modal-content">
    <div class="custom-modal-header" style="background: #9c27b0; color: white; padding: 20px; border-radius: 15px 15px 0 0; position: relative;">
      <h2 id="customModalTitle" style="margin: 0; padding-right: 40px;">Î¤Î¯Ï„Î»Î¿Ï‚</h2>
      <button onclick="closeCustomModal()" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">Ã—</button>
    </div>
    <div class="custom-modal-body" id="customModalBody" style="padding: 20px;">
      Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿
    </div>
    <div class="custom-modal-footer" style="padding: 15px 20px 20px; text-align: center; border-top: 1px solid #eee;">
      <button onclick="closeCustomModal()" style="padding: 10px 25px; background: #e91e63; color: white; border: none; border-radius: 8px; cursor: pointer;">
        ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿
      </button>
    </div>
  </div>
</div>

<script>
// ==================== ÎŸÎ›Î•Î£ ÎŸÎ™ ÎœÎ•Î¤Î‘Î’Î›Î—Î¤Î•Î£ ====================
let categories = JSON.parse(localStorage.getItem('cats') || '[]');
let expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
let recurringAmounts = JSON.parse(localStorage.getItem('recurringAmounts') || '{}');
let income = parseFloat(localStorage.getItem('income')) || 0;

let bankBalances = JSON.parse(localStorage.getItem('bankBalances') || JSON.stringify({
  alphaBank: 0,
  nationalBank: 0,
  cash: 0,
  expectedIncome: 0
}));

let syncData = JSON.parse(localStorage.getItem('budgetbuddy_sync') || '{}');
let currentUser = syncData.userName || "ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±";
let currentBudget = syncData.budgetCode || null;
let firebaseRef = null;

// ==================== QUICK ENTRY FUNCTIONS ====================
let isQuickEntryVisible = true;

function toggleQuickEntry() {
  const quickEntry = document.getElementById('quickEntrySticky');
  const toggleButton = document.getElementById('toggleQuickEntry');
  
  if (isQuickEntryVisible) {
    quickEntry.classList.add('hidden');
    toggleButton.textContent = 'ğŸ“';
    toggleButton.style.background = '#4caf50';
  } else {
    quickEntry.classList.remove('hidden');
    toggleButton.textContent = 'ğŸ‘‡';
    toggleButton.style.background = '#9c27b0';
  }
  
  isQuickEntryVisible = !isQuickEntryVisible;
}

function addExpenseFromQuickEntry() {
  const amount = parseFloat(document.getElementById('quickAmount').value);
  const category = document.getElementById('quickCategory').value;
  const note = document.getElementById('quickNote').value.trim();
  const date = new Date().toISOString().slice(0,10);
  
  if (!amount || amount <= 0) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÏŒ', 'error');
    document.getElementById('quickAmount').focus();
    return;
  }
  
  if (!category) {
    showQuickMessage('âš ï¸ Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±', 'error');
    return;
  }
  
  const newExpense = {
    id: Date.now() + Math.random(),
    amount: amount,
    category: category,
    date: date,
    note: note || '-',
    isRecurring: false
  };
  
  expenses.push(newExpense);
  
  // Î‘Î´ÎµÎ¹Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î± Ï€ÎµÎ´Î¯Î±
  document.getElementById('quickAmount').value = '';
  document.getElementById('quickNote').value = '';
  
  saveAllData();
  render();
  showQuickMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î­Î¾Î¿Î´Î¿ ${amount.toFixed(2)}â‚¬ (${category})`, 'success');
  
  // Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î¿ Ï€Î¿ÏƒÏŒ
  document.getElementById('quickAmount').focus();
}

function updateQuickEntryFields() {
  const quickCategorySelect = document.getElementById('quickCategory');
  if (categories.length > 0) {
    quickCategorySelect.innerHTML = '<option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ...</option>' + 
      categories.map(c => `<option value="${c}">${c}</option>`).join('');
  } else {
    quickCategorySelect.innerHTML = '<option value="">Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚</option>';
  }
}

// ==================== ENTER KEY SUPPORT ====================
function handleKeyPress(event, type) {
  if (event.key === 'Enter') {
    event.preventDefault();
    
    if (type === 'expense') {
      if (window.innerWidth >= 769) {
        addExpense();
      } else {
        addExpenseFromQuickEntry();
      }
    } else if (type === 'category') {
      addNewCategory();
    }
  }
}

// ==================== MESSAGE FUNCTIONS ====================
function showQuickMessage(message, type = 'info') {
  const msg = document.createElement('div');
  msg.style.cssText = `
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: ${type === 'error' ? '#f44336' : type === 'success' ? '#4caf50' : '#333'};
    color: white;
    padding: 12px 24px;
    border-radius: 25px;
    z-index: 10000;
    font-size: 14px;
    animation: fadeInOut 3s ease-in-out;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    gap: 10px;
  `;
  msg.innerHTML = `
    ${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}
    <span>${message}</span>
  `;
  
  document.body.appendChild(msg);
  
  setTimeout(() => {
    msg.style.animation = 'fadeOut 0.5s ease-in-out';
    setTimeout(() => msg.remove(), 500);
  }, 3000);
  
  if (!document.getElementById('msg-styles')) {
    const style = document.createElement('style');
    style.id = 'msg-styles';
    style.textContent = `
      @keyframes fadeInOut {
        0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        10% { opacity: 1; transform: translateX(-50%) translateY(0); }
        90% { opacity: 1; transform: translateX(-50%) translateY(0); }
        100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
      }
      @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
      }
    `;
    document.head.appendChild(style);
  }
}

// ==================== SYNC FUNCTIONS ====================
function updateSyncUI(status, data = null) {
  const mainDot = document.getElementById('mainSyncDot');
  const headerDot = document.getElementById('headerSyncDot');
  const buttonText = document.getElementById('syncButtonText');
  const syncInfo = document.getElementById('syncInfo');
  const connectedUsers = document.getElementById('connectedUsers');
  const usersList = document.getElementById('usersList');
  
  if (status === 'online' && data) {
    mainDot.className = 'sync-status-dot sync-online';
    headerDot.className = 'sync-status-dot sync-online';
    
    if (data.members && Array.isArray(data.members)) {
      connectedUsers.style.display = 'flex';
      
      const uniqueMembers = [...new Set(data.members)];
      
      usersList.innerHTML = uniqueMembers.map(member => {
        const isYou = (member === currentUser);
        const isCreator = (member === data.creator);
        
        let badgeClass = 'user-badge';
        if (isYou) badgeClass += ' you';
        if (isCreator) badgeClass += ' creator';
        
        let badgeText = member;
        if (isYou) badgeText += ' (Î•ÏƒÏ)';
        if (isCreator && !isYou) badgeText += ' ğŸ‘‘';
        
        return `<div class="${badgeClass}">${badgeText}</div>`;
      }).join('');
      
      const userCount = uniqueMembers.length;
      buttonText.textContent = `Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿${userCount > 1 ? 'Î¹' : ''} (${userCount})`;
      
    } else {
      connectedUsers.style.display = 'none';
    }
    
    syncInfo.innerHTML = `<strong>Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î¿:</strong> ${data.name || currentBudget} | ÎšÏ‰Î´Î¹ÎºÏŒÏ‚: <strong>${currentBudget}</strong>`;
    
  } else if (status === 'connecting') {
    mainDot.className = 'sync-status-dot sync-connecting';
    headerDot.className = 'sync-status-dot sync-connecting';
    buttonText.textContent = 'Î£Ï…Î½Î´Î­ÎµÏ„Î±Î¹...';
    syncInfo.innerHTML = 'Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÎµ cloud...';
    connectedUsers.style.display = 'none';
    
  } else {
    mainDot.className = 'sync-status-dot sync-offline';
    headerDot.className = 'sync-status-dot sync-offline';
    buttonText.textContent = 'Î£Ï…Î½Î´Î­ÏƒÎ¿Ï…';
    syncInfo.innerHTML = 'Î§Ï‰ÏÎ¯Ï‚ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ - Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï€Î¹ÎºÎ¬';
    connectedUsers.style.display = 'none';
  }
}

function initSync() {
  if (!currentBudget) {
    updateSyncUI('offline');
    return;
  }
  
  if (!firebase.apps.length) {
    const firebaseConfig = {
      apiKey: "AIzaSyBaItM0-eOAwU6snAxfMU_bcp9xW0UfYzQ",
      authDomain: "travelcosts-48d64.firebaseapp.com",
      databaseURL: "https://travelcosts-48d64-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "travelcosts-48d64",
      storageBucket: "travelcosts-48d64.firebasestorage.app",
      messagingSenderId: "792639383940",
      appId: "1:792639383940:web:ed991cc8426603015bd5d1"
    };
    firebase.initializeApp(firebaseConfig);
  }
  
  const database = firebase.database();
  firebaseRef = database.ref(`budgets/${currentBudget}`);
  
  updateSyncUI('connecting');
  
  let lastUpdateTime = 0;
  const UPDATE_COOLDOWN = 2000;
  
  firebaseRef.on('value', (snapshot) => {
    const now = Date.now();
    if (now - lastUpdateTime < UPDATE_COOLDOWN) {
      return;
    }
    
    const data = snapshot.val();
    if (data) {
      lastUpdateTime = now;
      
      const isCreator = (syncData.creator === currentUser);
      
      if (!isCreator) {
        if (data.categories && data.categories.length > 0) {
          categories = data.categories;
        }
        if (data.expenses && data.expenses.length > 0) {
          expenses = data.expenses;
        }
        if (data.recurringAmounts) {
          recurringAmounts = data.recurringAmounts;
        }
        if (data.income) {
          income = data.income;
          document.getElementById('income').value = income;
        }
        if (data.bankBalances) {
          bankBalances = data.bankBalances;
        }
        
        saveAllData();
        initFields();
        render();
      }
      
      syncData.budgetName = data.name;
      syncData.creator = data.creator;
      syncData.members = data.members || [currentUser];
      
      if (!syncData.members.includes(currentUser)) {
        syncData.members.push(currentUser);
        syncToFirebase();
      }
      
      localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
      updateSyncUI('online', data);
      
      if (syncData.justCreated) {
        showQuickMessage(`âœ… Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î¿ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ "${data.name}"`, 'success');
        delete syncData.justCreated;
        localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
      }
      
    } else {
      if (syncData.creator === currentUser) {
        createNewBudgetInFirebase();
      }
    }
  }, (error) => {
    console.error("Firebase error:", error);
    updateSyncUI('offline');
  });
}

function syncToFirebase() {
  if (!currentBudget || !firebaseRef) return;
  
  if (window.syncTimeout) {
    clearTimeout(window.syncTimeout);
  }
  
  window.syncTimeout = setTimeout(() => {
    const budgetData = {
      code: currentBudget,
      name: syncData.budgetName || `Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ${currentBudget}`,
      creator: syncData.creator || currentUser,
      members: syncData.members || [currentUser],
      categories: categories,
      expenses: expenses,
      recurringAmounts: recurringAmounts,
      income: income,
      bankBalances: bankBalances,
      lastUpdated: Date.now()
    };
    
    firebaseRef.set(budgetData);
  }, 1000);
}

// ==================== MODAL FUNCTIONS ====================
function showSyncModal() {
  const modal = document.getElementById('syncModal');
  const content = document.getElementById('syncModalContent');
  
  if (currentBudget) {
    content.innerHTML = `
      <div style="text-align: center;">
        <h3>âœ… Î•Î¯ÏƒÏ„Îµ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹!</h3>
        <p><strong>Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚:</strong> ${syncData.budgetName || currentBudget}</p>
        <p><strong>ÎšÏ‰Î´Î¹ÎºÏŒÏ‚:</strong></p>
        <div style="font-size: 32px; font-weight: bold; letter-spacing: 3px; color: #e91e63; background: #f9f9f9; padding: 15px; border-radius: 10px; margin: 15px 0;">
          ${currentBudget}
        </div>
        <p><small>Î”ÏÏƒÏ„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÏƒÏ„Î¿Î½ ÏƒÏÎ¶Ï…Î³ÏŒ ÏƒÎ±Ï‚</small></p>
      </div>
      
      <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
        <button onclick="showQRCode()" style="width: 100%; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ“± QR Code
        </button>
        <button onclick="copySyncCode()" style="width: 100%; padding: 12px; background: #2196f3; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ“‹ Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® ÎšÏ‰Î´Î¹ÎºÎ¿Ï
        </button>
        <button onclick="disconnectSync()" style="width: 100%; padding: 12px; background: #f44336; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ”Œ Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·
        </button>
      </div>
    `;
  } else {
    content.innerHTML = `
      <div style="text-align: center;">
        <h3>ğŸ”— Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï</h3>
        <p>Î£Ï…Î½Î´Î­ÏƒÏ„Îµ 2 ÎºÎ¹Î½Î·Ï„Î¬ Î³Î¹Î± Ï„Î± Î¯Î´Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿!</p>
      </div>
      
      <div style="margin: 20px 0;">
        <h4>ğŸš€ Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ ÎÎ•ÎŸÎ¥</h4>
        <div style="margin: 15px 0;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">Î¤Î¿ ÎŒÎ½Î¿Î¼Î¬ Î£Î±Ï‚:</label>
          <input type="text" id="newUserName" value="${currentUser}" placeholder="Ï€.Ï‡. ÎœÎ±ÏÎ¯Î±" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>
        
        <div style="margin: 15px 0;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">ÎŒÎ½Î¿Î¼Î± Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï:</label>
          <input type="text" id="newBudgetName" placeholder="Ï€.Ï‡. ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>
        
        <button onclick="createNewSync()" style="width: 100%; padding: 12px; background: #e91e63; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
          ğŸš€ Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘
        </button>
      </div>
      
      <div style="margin: 20px 0;">
        <h4>ğŸ”— Î£Î¥ÎÎ”Î•Î£Î— Î£Î• Î¥Î Î‘Î¡Î§ÎŸÎ</h4>
        <div style="margin: 15px 0;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">Î¤Î¿ ÎŒÎ½Î¿Î¼Î¬ Î£Î±Ï‚:</label>
          <input type="text" id="joinUserName" value="${currentUser}" placeholder="Ï€.Ï‡. Î“Î¹Î¬Î½Î½Î·Ï‚" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>
        
        <div style="margin: 15px 0;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï:</label>
          <input type="text" id="joinBudgetCode" placeholder="6 ÏˆÎ·Ï†Î¯Î±" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; text-align: center; letter-spacing: 3px; font-size: 18px;">
        </div>
        
        <button onclick="joinExistingSync()" style="width: 100%; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
          ğŸ”— Î£Î¥ÎÎ”Î•Î£Î—
        </button>
      </div>
    `;
  }
  
  modal.style.display = 'flex';
}

function closeSyncModal() {
  document.getElementById('syncModal').style.display = 'none';
}

// ==================== CORE APPLICATION FUNCTIONS ====================
function cleanupData() {
  categories = categories.filter(cat => cat && typeof cat === 'string' && cat.trim() !== '');
  
  const cleanRecurring = {};
  categories.forEach(cat => {
    if (recurringAmounts[cat] !== undefined) {
      const value = parseFloat(recurringAmounts[cat]);
      cleanRecurring[cat] = isNaN(value) ? 0 : value;
    }
  });
  recurringAmounts = cleanRecurring;
}

function saveAllData() {
  localStorage.setItem('cats', JSON.stringify(categories));
  localStorage.setItem('expenses', JSON.stringify(expenses));
  localStorage.setItem('recurringAmounts', JSON.stringify(recurringAmounts));
  localStorage.setItem('income', income.toString());
  localStorage.setItem('bankBalances', JSON.stringify(bankBalances));
  
  if (currentBudget) {
    syncToFirebase();
  }
}

function initFields() {
  cleanupData();
  
  document.getElementById('income').value = income || '';
  
  const currentMonth = new Date().toISOString().slice(0,7);
  const monthInput = document.getElementById('month');
  if (!monthInput.value) {
    monthInput.value = currentMonth;
  }
  
  const today = new Date().toISOString().slice(0,10);
  document.getElementById('date').value = today;
  
  document.getElementById('alphaBank').value = bankBalances.alphaBank || '';
  document.getElementById('nationalBank').value = bankBalances.nationalBank || '';
  document.getElementById('cash').value = bankBalances.cash || '';
  document.getElementById('expectedIncome').value = bankBalances.expectedIncome || '';
  
  updateCategoriesList();
  updateRecurringInputs();
  updateQuickEntryFields();
}

function addExpense() {
  const amount = parseFloat(document.getElementById('amount').value);
  const category = document.getElementById('category').value;
  const date = document.getElementById('date').value;
  const note = document.getElementById('note').value.trim();
  
  if (!amount || amount <= 0) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î½Î± Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÏŒ', 'error');
    document.getElementById('amount').focus();
    return;
  }
  
  if (!date) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±', 'error');
    document.getElementById('date').focus();
    return;
  }
  
  if (!category) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±', 'error');
    document.getElementById('category').focus();
    return;
  }
  
  const newExpense = {
    id: Date.now() + Math.random(),
    amount: amount,
    category: category,
    date: date,
    note: note || '-',
    isRecurring: false
  };
  
  expenses.push(newExpense);
  
  document.getElementById('amount').value = '';
  document.getElementById('note').value = '';
  
  saveAllData();
  render();
  showQuickMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î­Î¾Î¿Î´Î¿ ${category} - ${amount.toFixed(2)}â‚¬`, 'success');
  
  document.getElementById('amount').focus();
}

function render() {
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· dropdowns
  const categorySelect = document.getElementById('category');
  if (categories.length > 0) {
    categorySelect.innerHTML = categories.map(c => `<option value="${c}">${c}</option>`).join('');
  } else {
    categorySelect.innerHTML = '<option value="">Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</option>';
  }
  
  updateQuickEntryFields();
  
  // Î¦Î¹Î»Ï„ÏÎ¬ÏÎ¹ÏƒÎ¼Î± ÎµÎ¾ÏŒÎ´Ï‰Î½ Î³Î¹Î± Ï„Î¿Î½ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Î¼Î®Î½Î±
  const selectedMonth = document.getElementById('month').value;
  const filteredExpenses = selectedMonth 
    ? expenses.filter(e => e.date.startsWith(selectedMonth))
    : expenses;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î¯Î½Î±ÎºÎ±
  const tbody = document.querySelector('#expensesTable tbody');
  
  if (filteredExpenses.length === 0) {
    tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;color:#777;padding:20px;">
      Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½Î± Î­Î¾Î¿Î´Î± Î³Î¹Î± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Î¼Î®Î½Î±.</td></tr>`;
  } else {
    tbody.innerHTML = filteredExpenses.map(e => `
      <tr>
        <td>${e.date}</td>
        <td>${e.category} ${e.isRecurring ? 'ğŸ”„' : ''}</td>
        <td>${e.note}</td>
        <td>${e.amount.toFixed(2)}</td>
        <td><button class='del' onclick='deleteExpense(${e.id})'>âœ•</button></td>
      </tr>
    `).join('');
  }
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÏÎ½
  const categorySummary = {};
  let actualExpenses = 0;
  let plannedExpenses = 0;
  
  categories.forEach(category => {
    const categoryExpenses = filteredExpenses.filter(e => e.category === category);
    const categoryTotal = categoryExpenses.reduce((sum, expense) => sum + expense.amount, 0);
    const categoryBudget = recurringAmounts[category] || 0;
    
    categorySummary[category] = {
      spent: categoryTotal,
      budget: categoryBudget,
      remaining: categoryBudget - categoryTotal
    };
    
    actualExpenses += categoryTotal;
    plannedExpenses += categoryBudget;
  });
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· summary by category
  const catListDiv = document.getElementById('catList');
  let catHtml = '';
  
  if (categories.length === 0) {
    catHtml = '<p style="color:#777; font-style:italic; grid-column: 1/-1;">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚.</p>';
  } else {
    categories.forEach(category => {
      const summary = categorySummary[category] || { spent: 0, budget: 0, remaining: 0 };
      const remaining = summary.remaining;
      
      let statusClass = '';
      if (remaining < 0) {
        statusClass = 'over';
      } else if (remaining > 0) {
        statusClass = 'under';
      }
      
      catHtml += `
        <div class="category-item ${statusClass}">
          <strong>${category}</strong><br>
          Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚: ${summary.budget.toFixed(2)} â‚¬<br>
          ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½: ${summary.spent.toFixed(2)} â‚¬<br>
          <strong>ÎœÎ­Î½Î¿Ï…Î½: ${remaining.toFixed(2)} â‚¬</strong>
        </div>
      `;
    });
  }
  
  catListDiv.innerHTML = catHtml;
  
  // Î¤ÎµÎ»Î¹ÎºÎ­Ï‚ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯
  const totalSpent = actualExpenses;
  const remainingExpenses = plannedExpenses - actualExpenses;
  const currentMoney = (bankBalances.alphaBank || 0) + (bankBalances.nationalBank || 0) + (bankBalances.cash || 0);
  const futureMoney = bankBalances.expectedIncome || 0;
  const totalIncome = currentMoney + futureMoney;
  const finalBalance = totalIncome - totalSpent;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· UI
  document.getElementById('totalSpent').textContent = totalSpent.toFixed(2) + ' â‚¬';
  document.getElementById('remainingExpenses').textContent = remainingExpenses.toFixed(2) + ' â‚¬';
  document.getElementById('totalIncome').textContent = totalIncome.toFixed(2) + ' â‚¬';
  document.getElementById('finalBalance').textContent = finalBalance.toFixed(2) + ' â‚¬';
  
  const finalBalanceElement = document.getElementById('finalBalance');
  if (finalBalance < 0) {
    finalBalanceElement.style.color = '#f44336';
  } else if (finalBalance < totalIncome * 0.1) {
    finalBalanceElement.style.color = '#ff9800';
  } else {
    finalBalanceElement.style.color = '#4caf50';
  }
  
  updateStatistics(filteredExpenses, categories);
}

// ==================== INITIALIZATION ====================
window.onload = function() {
  // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±ÏƒÏ„ÎµÏÎ¹ÏÎ½
  const starsContainer = document.getElementById('stars');
  const starColors = ['#fff', '#ffd1e8', '#ffb6c1', '#ffc0cb'];
  
  for (let i = 0; i < 40; i++) {
    const star = document.createElement('div');
    star.classList.add('star');
    star.textContent = 'â˜…';
    star.style.left = Math.random() * 100 + '%';
    star.style.top = Math.random() * 100 + 'px';
    star.style.animationDelay = (Math.random() * 5) + 's';
    star.style.color = starColors[Math.floor(Math.random() * starColors.length)];
    starsContainer.appendChild(star);
  }
  
  // Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï€ÎµÎ´Î¯Ï‰Î½
  const currentMonth = new Date().toISOString().slice(0,7);
  document.getElementById('month').value = currentMonth;
  
  const today = new Date().toISOString().slice(0,10);
  document.getElementById('date').value = today;
  
  // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· event listeners Î³Î¹Î± Enter key
  document.getElementById('amount').addEventListener('keypress', (e) => handleKeyPress(e, 'expense'));
  document.getElementById('note').addEventListener('keypress', (e) => handleKeyPress(e, 'expense'));
  document.getElementById('quickAmount').addEventListener('keypress', (e) => handleKeyPress(e, 'expense'));
  document.getElementById('quickNote').addEventListener('keypress', (e) => handleKeyPress(e, 'expense'));
  document.getElementById('newCategoryName').addEventListener('keypress', (e) => handleKeyPress(e, 'category'));
  
  // Event listeners Î³Î¹Î± ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·
  document.getElementById('income').addEventListener('input', () => {
    income = parseFloat(document.getElementById('income').value) || 0;
    saveAllData();
    render();
  });
  
  document.getElementById('month').addEventListener('input', () => render());
  
  initFields();
  render();
  initSync();
  
  // Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ sync ÎºÎ¬Î¸Îµ 30 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±
  setInterval(() => {
    if (currentBudget) {
      syncToFirebase();
    }
  }, 30000);
};

// ==================== ÎšÎ‘Î™ ÎŸÎ™ Î¥Î ÎŸÎ›ÎŸÎ™Î Î•Î£ Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î•Î™Î£ ====================
// Î•Î´Ï Î¸Î± Î¼Ï€Î¿Ï…Î½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ (saveBankBalances, addNewCategory, 
// updateRecurringInputs, saveRecurringAmounts, generateRecurringExpenses,
// deleteExpense, updateStatistics, ÎºÎ»Ï€) Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¹Ï‚ Î­Ï‡ÎµÎ¹Ï‚ ÏƒÏ„Î¿ Î±ÏÏ‡Î¹ÎºÏŒ ÏƒÎ¿Ï… ÎºÏÎ´Î¹ÎºÎ±,
// Î±Î»Î»Î¬ Î¸Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰ Î¼ÏŒÎ½Î¿ Ï„Î¹Ï‚ Î±Î»Î»Î±Î³Î­Ï‚ Î³Î¹Î± Enter key support

function addNewCategory() {
  const newCategoryInput = document.getElementById('newCategoryName');
  const categoryName = newCategoryInput.value.trim();
  
  if (!categoryName) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚', 'error');
    return;
  }
  
  if (categories.includes(categoryName)) {
    showQuickMessage('âš ï¸ Î— ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·!', 'error');
    return;
  }
  
  categories.push(categoryName);
  newCategoryInput.value = '';
  
  saveAllData();
  updateCategoriesList();
  updateRecurringInputs();
  updateQuickEntryFields();
  showQuickMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${categoryName}"`, 'success');
  
  // Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® focus ÏƒÏ„Î¿ input
  document.getElementById('newCategoryName').focus();
}

// ÎšÎ¬Î½Ï‰ Ï„Î¿ Î¯Î´Î¹Î¿ Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î¬Î»Î»ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î®Î´Î· Î­Ï‡ÎµÎ¹Ï‚...
// Î˜Î± Î²Î¬Î»Ï‰ ÎµÎ´Ï Î¼ÏŒÎ½Î¿ Ï„Î¹Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î±Î»Î»Î¬Î¾ÎµÎ¹:

function updateCategoriesList() {
  const categoriesListDiv = document.getElementById('categoriesList');
  let html = '';
  
  categories.forEach((category, index) => {
    html += `
      <div class="category-tag">
        ${category}
        <button onclick="deleteCategory(${index})" title="Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚">Ã—</button>
      </div>
    `;
  });
  
  categoriesListDiv.innerHTML = html || '<p style="color:#777; padding: 10px;">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚!</p>';
}

// ÎšÎ±Î¹ Î¿Î¹ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î±ÏÎ±Î¼Î­Î½Î¿Ï…Î½ Î¯Î´Î¹ÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¹Ï‚ Î­Ï‡ÎµÎ¹Ï‚...
// Î˜Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÏ‰ Î¼Îµ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ JavaScript Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Î­Ï‡ÎµÎ¹Ï‚...

// [Î•Î´Ï Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹Ï‚ Î¼Îµ ÏŒÎ»Î¿ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ JavaScript Î±Ï€ÏŒ Ï„Î¿ Î±ÏÏ‡Î¹ÎºÏŒ ÏƒÎ¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿]
// Î ÏÎ¿ÏƒÎ¸Î­Ï„Ï‰ Ï„Î¹Ï‚ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚:

function saveBankBalances() {
  bankBalances = {
    alphaBank: parseFloat(document.getElementById('alphaBank').value) || 0,
    nationalBank: parseFloat(document.getElementById('nationalBank').value) || 0,
    cash: parseFloat(document.getElementById('cash').value) || 0,
    expectedIncome: parseFloat(document.getElementById('expectedIncome').value) || 0
  };
  
  saveAllData();
  showQuickMessage('ğŸ’° Î¤Î± Ï„ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
  render();
}

function deleteCategory(index) {
  const categoryName = categories[index];
  
  if (!confirm(`Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ "${categoryName}";\nÎ˜Î± Î´Î¹Î±Î³ÏÎ±Ï†Î¿ÏÎ½ ÎºÎ±Î¹ ÏŒÎ»Î± Ï„Î± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î­Î¾Î¿Î´Î±!\nÎ£Î¯Î³Î¿Ï…ÏÎ±;`)) {
    return;
  }
  
  categories.splice(index, 1);
  expenses = expenses.filter(e => e.category !== categoryName);
  
  if (recurringAmounts[categoryName]) {
    delete recurringAmounts[categoryName];
  }
  
  saveAllData();
  updateCategoriesList();
  updateRecurringInputs();
  updateQuickEntryFields();
  render();
  showQuickMessage(`ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ Î· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${categoryName}"`, 'success');
}

function updateRecurringInputs() {
  const recurringInputsDiv = document.getElementById('recurringInputs');
  
  if (categories.length === 0) {
    recurringInputsDiv.innerHTML = '<p style="color:#777; font-style:italic; padding: 10px;">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚.</p>';
    return;
  }
  
  let html = `<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">`;
  
  categories.forEach((category, index) => {
    const amount = recurringAmounts[category] || 0;
    const uniqueId = `recurring_${index}_${category.replace(/\s+/g, '_')}`;
    
    html += `
      <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #eee; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333; font-size: 14px;">
          ${category}
        </label>
        <div style="display: flex; align-items: center; gap: 8px;">
          <input type="number" 
                 id="${uniqueId}" 
                 value="${amount}" 
                 step="0.01" 
                 style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px;"
                 placeholder="0.00"
                 onchange="updateSingleRecurringAmount('${category}', this.value)">
          <span style="color: #666; font-size: 14px;">â‚¬</span>
        </div>
      </div>
    `;
  });
  
  html += '</div>';
  recurringInputsDiv.innerHTML = html;
}

function updateSingleRecurringAmount(category, value) {
  const numValue = parseFloat(value) || 0;
  recurringAmounts[category] = numValue;
  
  saveAllData();
  showQuickMessage(`âœ… Î•Î½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ Î¿ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Î³Î¹Î± ${category}: ${numValue.toFixed(2)}â‚¬`, 'success');
}

function saveRecurringAmounts() {
  if (categories.length === 0) {
    showQuickMessage('âš ï¸ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚', 'error');
    return;
  }
  
  categories.forEach(category => {
    const inputs = document.querySelectorAll(`input[id^="recurring_"]`);
    let foundValue = recurringAmounts[category] || 0;
    
    inputs.forEach(input => {
      if (input.id.includes(category.replace(/\s+/g, '_')) || 
          input.previousElementSibling?.textContent?.includes(category)) {
        const value = parseFloat(input.value) || 0;
        foundValue = value;
      }
    });
    
    recurringAmounts[category] = foundValue;
  });
  
  saveAllData();
  showQuickMessage('ğŸ’¾ ÎŸÎ¹ Î¼Î·Î½Î¹Î±Î¯Î¿Î¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
  updateRecurringInputs();
  render();
}

function generateRecurringExpenses() {
  if (categories.length === 0) {
    showQuickMessage('âš ï¸ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚', 'error');
    return;
  }
  
  const selectedMonth = document.getElementById('month').value;
  if (!selectedMonth) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Ï€ÏÏÏ„Î± Î­Î½Î± Î¼Î®Î½Î±!', 'error');
    return;
  }
  
  const monthExpenses = expenses.filter(e => e.date.startsWith(selectedMonth));
  const hasRecurringForMonth = monthExpenses.some(e => e.isRecurring === true);
  
  if (hasRecurringForMonth) {
    if (!confirm('Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î®Î´Î· ÎµÏ€Î±Î½Î±Î»Î±Î¼Î²Î±Î½ÏŒÎ¼ÎµÎ½Î± Î­Î¾Î¿Î´Î± Î³Î¹Î± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Î¼Î®Î½Î±. Î˜Î­Î»ÎµÏ„Îµ Î½Î± Ï„Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î¾Î±Î½Î¬ (Î¸Î± Î´Î¹Î±Î³ÏÎ±Ï†Î¿ÏÎ½ Ï„Î± Ï€Î±Î»Î¹Î¬);')) {
      return;
    }
    
    expenses = expenses.filter(e => !(e.date.startsWith(selectedMonth) && e.isRecurring === true));
  }
  
  categories.forEach(category => {
    const amount = recurringAmounts[category] || 0;
    
    if (amount > 0) {
      const newExpense = {
        id: Date.now() + Math.random(),
        amount: amount,
        category: category,
        date: selectedMonth + '-01',
        note: 'ÎœÎ·Î½Î¹Î±Î¯Î¿ Î­Î¾Î¿Î´Î¿',
        isRecurring: true
      };
      
      expenses.push(newExpense);
    }
  });
  
  saveAllData();
  render();
  showQuickMessage(`ğŸ”„ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎ±Î½ ÎµÏ€Î±Î½Î±Î»Î±Î¼Î²Î±Î½ÏŒÎ¼ÎµÎ½Î± Î­Î¾Î¿Î´Î± Î³Î¹Î± ${selectedMonth}`, 'success');
}

function deleteExpense(id) {
  if (!confirm('Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î­Î¾Î¿Î´Î¿;')) return;
  
  const index = expenses.findIndex(e => e.id === id);
  if (index === -1) return;
  
  const deletedExpense = expenses[index];
  expenses.splice(index, 1);
  
  saveAllData();
  render();
  showQuickMessage(`ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ Î­Î¾Î¿Î´Î¿ ${deletedExpense.amount.toFixed(2)}â‚¬ (${deletedExpense.category})`, 'success');
}

function updateStatistics(expenses, categories) {
  const statsGrid = document.getElementById('statsGrid');
  const expenseChart = document.getElementById('expenseChart');
  
  if (!statsGrid || !expenseChart) return;
  
  const totalExpenses = expenses.reduce((sum, e) => sum + e.amount, 0);
  const avgExpense = expenses.length > 0 ? totalExpenses / expenses.length : 0;
  const maxExpense = expenses.length > 0 ? Math.max(...expenses.map(e => e.amount)) : 0;
  const minExpense = expenses.length > 0 ? Math.min(...expenses.map(e => e.amount)) : 0;
  const expenseCount = expenses.length;
  
  const categoryTotals = {};
  categories.forEach(cat => {
    categoryTotals[cat] = expenses
      .filter(e => e.category === cat)
      .reduce((sum, e) => sum + e.amount, 0);
  });
  
  const maxCategoryValue = Math.max(...Object.values(categoryTotals));
  
  statsGrid.innerHTML = `
    <div class="stat-box" style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
      <div class="stat-label" style="font-size: 12px; color: #666;">Î£Î¥ÎÎŸÎ›ÎŸ Î•ÎÎŸÎ”Î©Î</div>
      <div class="stat-value" style="font-size: 24px; font-weight: bold; color: #e91e63;">${totalExpenses.toFixed(2)}â‚¬</div>
    </div>
    <div class="stat-box" style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
      <div class="stat-label" style="font-size: 12px; color: #666;">Îœ.ÎŸ. Î•ÎÎŸÎ”ÎŸÎ¥</div>
      <div class="stat-value" style="font-size: 24px; font-weight: bold; color: #2196f3;">${avgExpense.toFixed(2)}â‚¬</div>
    </div>
    <div class="stat-box" style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
      <div class="stat-label" style="font-size: 12px; color: #666;">ÎœÎ•Î“Î‘Î›Î¥Î¤Î•Î¡ÎŸ</div>
      <div class="stat-value" style="font-size: 24px; font-weight: bold; color: #f44336;">${maxExpense.toFixed(2)}â‚¬</div>
    </div>
    <div class="stat-box" style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
      <div class="stat-label" style="font-size: 12px; color: #666;">Î•ÎÎŸÎ”Î‘ (Ï€Î»Î®Î¸Î¿Ï‚)</div>
      <div class="stat-value" style="font-size: 24px; font-weight: bold; color: #4caf50;">${expenseCount}</div>
    </div>
  `;
  
  if (maxCategoryValue > 0) {
    let chartHTML = '';
    categories.forEach(cat => {
      const value = categoryTotals[cat] || 0;
      const height = maxCategoryValue > 0 ? (value / maxCategoryValue * 100) : 0;
      const color = `hsl(${Math.random() * 360}, 70%, 60%)`;
      
      chartHTML += `
        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
          <div style="width: 80%; background: ${color}; height: ${height}%; border-radius: 4px 4px 0 0; transition: height 0.5s;"></div>
          <div style="font-size: 11px; margin-top: 5px; text-align: center; color: #666; writing-mode: vertical-rl; transform: rotate(180deg); height: 60px; overflow: hidden; text-overflow: ellipsis;">
            ${cat}
          </div>
          <div style="font-size: 10px; color: #999; margin-top: 5px;">
            ${value.toFixed(0)}â‚¬
          </div>
        </div>
      `;
    });
    expenseChart.innerHTML = chartHTML;
  } else {
    expenseChart.innerHTML = '<div style="text-align: center; color: #999; padding: 40px;">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î­Î¾Î¿Î´Î± Î³Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î³ÏÎ¬Ï†Î·Î¼Î±</div>';
  }
}

// Î‘ÏÏ‡ÎµÎ¹Î¿Î¸Î­Ï„Î·ÏƒÎ· ÎºÎ±Î¹ Î¬Î»Î»ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹Ï‚ Î®Î´Î·...

</script>
</body>
</html>
