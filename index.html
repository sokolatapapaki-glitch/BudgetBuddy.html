<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>BudgetBuddy â€” ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23e91e63%22>ğŸ’°</text></svg>">
<meta name="theme-color" content="#e91e63">
<style>
  /* RESET */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }
  
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f8f9fa;
    color: #333;
    line-height: 1.5;
    padding-bottom: 100px;
  }

  /* HEADER */
  .header {
    background: linear-gradient(135deg, #e91e63, #9c27b0);
    color: white;
    padding: 15px;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  
  .app-title {
    font-size: 20px;
    font-weight: 600;
  }
  
  .sync-button {
    background: rgba(255,255,255,0.2);
    border: none;
    color: white;
    padding: 6px 12px;
    border-radius: 15px;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .sync-status {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    display: inline-block;
  }
  
  .sync-online { background: #4caf50; }
  .sync-offline { background: #ff9800; }
  
  .current-month {
    text-align: center;
    font-size: 16px;
    font-weight: 500;
  }

  /* MAIN CONTENT */
  .main-content {
    margin-top: 100px;
    padding: 15px;
  }

  /* QUICK ADD SECTION - Î•Î”Î© Î•Î™ÎÎ‘Î™ Î¤ÎŸ Î Î™ÎŸ Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ */
  .quick-add-section {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    position: sticky;
    top: 80px;
    z-index: 10;
  }
  
  .quick-add-title {
    color: #e91e63;
    font-size: 18px;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .quick-form {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  
  .form-row {
    display: flex;
    gap: 10px;
    align-items: flex-end;
  }
  
  .form-group {
    flex: 1;
  }
  
  .form-group label {
    display: block;
    font-size: 12px;
    color: #666;
    margin-bottom: 5px;
    font-weight: 500;
  }
  
  .form-group input,
  .form-group select {
    width: 100%;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 16px;
    background: white;
    -webkit-appearance: none;
  }
  
  .form-group input:focus,
  .form-group select:focus {
    outline: none;
    border-color: #e91e63;
  }
  
  .amount-input {
    max-width: 120px;
  }
  
  .add-button {
    background: #e91e63;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 60px;
  }
  
  .add-button:active {
    background: #d81b60;
    transform: scale(0.98);
  }
  
  .add-button:disabled {
    background: #ccc;
    cursor: not-allowed;
  }

  /* BALANCE SECTION */
  .balance-section {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  }
  
  .balance-title {
    color: #333;
    font-size: 16px;
    margin-bottom: 15px;
  }
  
  .balance-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }
  
  .balance-item {
    text-align: center;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 8px;
  }
  
  .balance-label {
    font-size: 12px;
    color: #666;
    margin-bottom: 5px;
  }
  
  .balance-value {
    font-size: 18px;
    font-weight: 600;
    color: #e91e63;
  }
  
  .balance-positive {
    color: #4caf50;
  }
  
  .balance-negative {
    color: #f44336;
  }

  /* EXPENSES LIST */
  .expenses-section {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  }
  
  .section-title {
    color: #333;
    font-size: 16px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .expenses-list {
    max-height: 300px;
    overflow-y: auto;
  }
  
  .expense-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
    border-bottom: 1px solid #f0f0f0;
  }
  
  .expense-item:last-child {
    border-bottom: none;
  }
  
  .expense-info {
    flex: 1;
  }
  
  .expense-category {
    font-weight: 500;
    color: #333;
    margin-bottom: 3px;
  }
  
  .expense-note {
    font-size: 13px;
    color: #666;
  }
  
  .expense-amount {
    font-weight: 600;
    color: #e91e63;
    font-size: 16px;
  }
  
  .delete-button {
    background: none;
    border: none;
    color: #f44336;
    font-size: 18px;
    cursor: pointer;
    padding: 0 10px;
  }

  /* CATEGORIES */
  .categories-section {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  }
  
  .categories-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }
  
  .category-tag {
    background: #e0f7fa;
    color: #006064;
    padding: 6px 12px;
    border-radius: 15px;
    font-size: 13px;
    display: inline-flex;
    align-items: center;
    gap: 5px;
  }
  
  .category-tag button {
    background: none;
    border: none;
    color: #006064;
    font-size: 16px;
    cursor: pointer;
    padding: 0;
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* ADD CATEGORY */
  .add-category-form {
    display: flex;
    gap: 10px;
    margin-top: 15px;
  }
  
  .add-category-form input {
    flex: 1;
    padding: 10px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
  }
  
  .add-category-button {
    background: #4caf50;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 0 15px;
    font-size: 14px;
    cursor: pointer;
  }

  /* BOTTOM NAV */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    border-top: 1px solid #e0e0e0;
    display: flex;
    padding: 10px;
    z-index: 100;
  }
  
  .nav-button {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    padding: 8px;
    color: #666;
    font-size: 12px;
    cursor: pointer;
  }
  
  .nav-button.active {
    color: #e91e63;
  }
  
  .nav-icon {
    font-size: 20px;
    margin-bottom: 4px;
  }

  /* MODALS */
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    padding: 20px;
  }
  
  .modal-content {
    background: white;
    border-radius: 12px;
    width: 100%;
    max-width: 400px;
    max-height: 80vh;
    overflow-y: auto;
  }
  
  .modal-header {
    background: #e91e63;
    color: white;
    padding: 15px;
    border-radius: 12px 12px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .modal-title {
    font-size: 18px;
    font-weight: 600;
  }
  
  .close-button {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
  }
  
  .modal-body {
    padding: 20px;
  }
  
  .modal-footer {
    padding: 15px;
    border-top: 1px solid #e0e0e0;
    display: flex;
    gap: 10px;
  }
  
  .modal-button {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
  }
  
  .modal-button.primary {
    background: #e91e63;
    color: white;
  }
  
  .modal-button.secondary {
    background: #f5f5f5;
    color: #333;
  }

  /* UTILITIES */
  .hidden {
    display: none !important;
  }
  
  .loading {
    opacity: 0.5;
    pointer-events: none;
  }

  /* RESPONSIVE */
  @media (min-width: 768px) {
    .main-content {
      max-width: 500px;
      margin: 100px auto;
    }
    
    .form-row {
      flex-wrap: nowrap;
    }
  }
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="header-top">
    <div class="app-title">ğŸŒ¸ BudgetBuddy</div>
    <button class="sync-button" onclick="showSyncModal()">
      <span class="sync-status sync-offline" id="syncStatus"></span>
      Î£ÏÎ½Î´ÎµÏƒÎ·
    </button>
  </div>
  <div class="current-month" id="currentMonth">ÎœÎ¬ÏÏ„Î¹Î¿Ï‚ 2024</div>
</div>

<!-- MAIN CONTENT -->
<div class="main-content">
  
  <!-- QUICK ADD SECTION - Î Î™ÎŸ Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ ÎœÎ•Î¡ÎŸÎ£ -->
  <section class="quick-add-section">
    <h2 class="quick-add-title">â• ÎÎ­Î± Î´Î±Ï€Î¬Î½Î·</h2>
    <div class="quick-form" id="quickForm">
      <div class="form-row">
        <div class="form-group amount-input">
          <label>Î Î¿ÏƒÏŒ (â‚¬)</label>
          <input type="number" 
                 id="amountInput" 
                 placeholder="0.00" 
                 step="0.01"
                 min="0"
                 inputmode="decimal"
                 onkeypress="handleEnterKey(event, 'addExpense')">
        </div>
        
        <div class="form-group">
          <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
          <select id="categorySelect" onchange="checkFormValidity()">
            <option value="">Î•Ï€Î¹Î»Î¿Î³Î®...</option>
          </select>
        </div>
        
        <button class="add-button" id="addButton" onclick="addExpense()" disabled>
          â•
        </button>
      </div>
      
      <div class="form-row">
        <div class="form-group" style="flex: 2;">
          <label>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</label>
          <input type="text" 
                 id="noteInput" 
                 placeholder="Î .Ï‡. Î£Î¿ÏÏ€ÎµÏ Î¼Î¬ÏÎºÎµÏ„"
                 onkeypress="handleEnterKey(event, 'addExpense')">
        </div>
        
        <div class="form-group">
          <label>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</label>
          <input type="date" id="dateInput" value="">
        </div>
      </div>
    </div>
  </section>
  
  <!-- BALANCE SUMMARY -->
  <section class="balance-section">
    <h2 class="balance-title">ğŸ’° Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î±</h2>
    <div class="balance-grid">
      <div class="balance-item">
        <div class="balance-label">ÎˆÏ‡Î¿Ï…Î½ Î¾Î¿Î´ÎµÏ…Ï„ÎµÎ¯</div>
        <div class="balance-value" id="totalSpent">0.00 â‚¬</div>
      </div>
      <div class="balance-item">
        <div class="balance-label">Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î±</div>
        <div class="balance-value balance-positive" id="availableBalance">0.00 â‚¬</div>
      </div>
    </div>
  </section>
  
  <!-- RECENT EXPENSES -->
  <section class="expenses-section">
    <h2 class="section-title">
      <span>ğŸ“‹ Î ÏÏŒÏƒÏ†Î±Ï„ÎµÏ‚ Î´Î±Ï€Î¬Î½ÎµÏ‚</span>
      <span id="expensesCount">0</span>
    </h2>
    <div class="expenses-list" id="expensesList">
      <!-- Expenses will be added here -->
    </div>
  </section>
  
  <!-- CATEGORIES -->
  <section class="categories-section">
    <h2 class="section-title">ğŸ·ï¸ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚</h2>
    <div class="categories-list" id="categoriesList">
      <!-- Categories will be added here -->
    </div>
    
    <div class="add-category-form">
      <input type="text" 
             id="newCategoryInput" 
             placeholder="ÎÎ­Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±"
             onkeypress="handleEnterKey(event, 'addCategory')">
      <button class="add-category-button" onclick="addCategory()">+ Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·</button>
    </div>
  </section>
</div>

<!-- BOTTOM NAVIGATION -->
<div class="bottom-nav">
  <button class="nav-button active" onclick="showScreen('home')">
    <span class="nav-icon">ğŸ </span>
    Î‘ÏÏ‡Î¹ÎºÎ®
  </button>
  <button class="nav-button" onclick="showScreen('stats')">
    <span class="nav-icon">ğŸ“Š</span>
    Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬
  </button>
  <button class="nav-button" onclick="showScreen('settings')">
    <span class="nav-icon">âš™ï¸</span>
    Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚
  </button>
</div>

<!-- SYNC MODAL -->
<div class="modal" id="syncModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ”— Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚</h3>
      <button class="close-button" onclick="closeSyncModal()">Ã—</button>
    </div>
    <div class="modal-body">
      <p style="margin-bottom: 15px;">Î£Ï…Î½Î´Î­ÏƒÏ„Îµ Î¼Îµ Ï„Î¿ Î¬Î»Î»Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ Î³Î¹Î± ÎºÎ¿Î¹Î½Î® Ï‡ÏÎ®ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.</p>
      
      <div id="syncContent">
        <!-- Content will be loaded here -->
      </div>
    </div>
  </div>
</div>

<!-- MONTH SELECTOR MODAL -->
<div class="modal" id="monthModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ“… Î•Ï€Î¹Î»Î¿Î³Î® Î¼Î®Î½Î±</h3>
      <button class="close-button" onclick="closeMonthModal()">Ã—</button>
    </div>
    <div class="modal-body">
      <input type="month" id="monthSelect" style="width: 100%; padding: 12px; font-size: 16px; border: 2px solid #e0e0e0; border-radius: 8px;">
    </div>
    <div class="modal-footer">
      <button class="modal-button secondary" onclick="closeMonthModal()">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
      <button class="modal-button primary" onclick="changeMonth()">Î‘Î»Î»Î±Î³Î®</button>
    </div>
  </div>
</div>

<script>
// ==================== Î’Î‘Î£Î™ÎšÎ•Î£ ÎœÎ•Î¤Î‘Î’Î›Î—Î¤Î•Î£ ====================
let expenses = [];
let categories = ['Î£Î¿ÏÏ€ÎµÏ Î¼Î¬ÏÎºÎµÏ„', 'ÎÎ¿Î¯ÎºÎ¹', 'Î—Î»ÎµÎºÏ„ÏÎ¹ÎºÏŒ', 'ÎÎµÏÏŒ', 'Î¤Î·Î»Î­Ï†Ï‰Î½Î±', 'ÎšÎ±ÏÏƒÎ¹Î¼Î±', 'Î¨Ï…Ï‡Î±Î³Ï‰Î³Î¯Î±'];
let monthlyIncome = 2000;
let bankBalance = 5000;
let selectedMonth = new Date().toISOString().slice(0, 7); // YYYY-MM

// ==================== Î‘Î¡Î§Î™ÎšÎŸÎ ÎŸÎ™Î—Î£Î— ====================
document.addEventListener('DOMContentLoaded', function() {
  loadFromStorage();
  initDate();
  renderCategories();
  renderExpenses();
  updateBalance();
  
  // Set today's date
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('dateInput').value = today;
  
  // Update month display
  updateMonthDisplay();
  
  // Make month in header clickable
  document.getElementById('currentMonth').onclick = showMonthModal;
});

// ==================== DATE FUNCTIONS ====================
function initDate() {
  const now = new Date();
  const monthNames = [
    'Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚', 'Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚', 'ÎœÎ¬ÏÏ„Î¹Î¿Ï‚', 'Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚', 'ÎœÎ¬Î¹Î¿Ï‚', 'Î™Î¿ÏÎ½Î¹Î¿Ï‚',
    'Î™Î¿ÏÎ»Î¹Î¿Ï‚', 'Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚', 'Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚', 'ÎŸÎºÏ„ÏÎ²ÏÎ¹Î¿Ï‚', 'ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚', 'Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚'
  ];
  
  selectedMonth = now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0');
}

function updateMonthDisplay() {
  const [year, month] = selectedMonth.split('-');
  const monthNames = [
    'Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚', 'Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚', 'ÎœÎ¬ÏÏ„Î¹Î¿Ï‚', 'Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚', 'ÎœÎ¬Î¹Î¿Ï‚', 'Î™Î¿ÏÎ½Î¹Î¿Ï‚',
    'Î™Î¿ÏÎ»Î¹Î¿Ï‚', 'Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚', 'Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚', 'ÎŸÎºÏ„ÏÎ²ÏÎ¹Î¿Ï‚', 'ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚', 'Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚'
  ];
  
  document.getElementById('currentMonth').textContent = 
    `${monthNames[parseInt(month) - 1]} ${year}`;
}

function showMonthModal() {
  document.getElementById('monthSelect').value = selectedMonth;
  document.getElementById('monthModal').style.display = 'flex';
}

function closeMonthModal() {
  document.getElementById('monthModal').style.display = 'none';
}

function changeMonth() {
  const newMonth = document.getElementById('monthSelect').value;
  if (newMonth) {
    selectedMonth = newMonth;
    updateMonthDisplay();
    renderExpenses();
    updateBalance();
    closeMonthModal();
  }
}

// ==================== STORAGE FUNCTIONS ====================
function loadFromStorage() {
  try {
    const savedExpenses = localStorage.getItem('budgetbuddy_expenses');
    const savedCategories = localStorage.getItem('budgetbuddy_categories');
    
    if (savedExpenses) {
      expenses = JSON.parse(savedExpenses);
    }
    
    if (savedCategories) {
      categories = JSON.parse(savedCategories);
    }
  } catch (e) {
    console.log('Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÎµÎ½Î®, Ï‡ÏÎ®ÏƒÎ· Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³ÏÎ½');
  }
}

function saveToStorage() {
  localStorage.setItem('budgetbuddy_expenses', JSON.stringify(expenses));
  localStorage.setItem('budgetbuddy_categories', JSON.stringify(categories));
}

// ==================== EXPENSE FUNCTIONS ====================
function checkFormValidity() {
  const amount = document.getElementById('amountInput').value;
  const category = document.getElementById('categorySelect').value;
  const button = document.getElementById('addButton');
  
  button.disabled = !(amount && category && parseFloat(amount) > 0);
}

function handleEnterKey(event, action) {
  if (event.key === 'Enter') {
    event.preventDefault();
    if (action === 'addExpense') {
      addExpense();
    } else if (action === 'addCategory') {
      addCategory();
    }
  }
}

function addExpense() {
  const amountInput = document.getElementById('amountInput');
  const categorySelect = document.getElementById('categorySelect');
  const noteInput = document.getElementById('noteInput');
  const dateInput = document.getElementById('dateInput');
  
  const amount = parseFloat(amountInput.value);
  const category = categorySelect.value;
  const note = noteInput.value.trim();
  const date = dateInput.value;
  
  if (!amount || amount <= 0) {
    showMessage('Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÏŒ', 'error');
    amountInput.focus();
    return;
  }
  
  if (!category) {
    showMessage('Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±', 'error');
    categorySelect.focus();
    return;
  }
  
  if (!date) {
    showMessage('Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±', 'error');
    dateInput.focus();
    return;
  }
  
  const expense = {
    id: Date.now(),
    amount: amount,
    category: category,
    note: note || 'Î§Ï‰ÏÎ¯Ï‚ ÏƒÎ·Î¼ÎµÎ¯Ï‰ÏƒÎ·',
    date: date,
    timestamp: new Date().getTime()
  };
  
  expenses.unshift(expense); // Add to beginning
  
  // Clear form
  amountInput.value = '';
  noteInput.value = '';
  categorySelect.value = '';
  document.getElementById('addButton').disabled = true;
  
  // Save and update UI
  saveToStorage();
  renderExpenses();
  updateBalance();
  
  // Show success message
  showMessage(`Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î­Î¾Î¿Î´Î¿ ${amount.toFixed(2)}â‚¬`, 'success');
  
  // Focus back to amount
  amountInput.focus();
}

function deleteExpense(id) {
  if (!confirm('Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î­Î¾Î¿Î´Î¿;')) return;
  
  expenses = expenses.filter(expense => expense.id !== id);
  saveToStorage();
  renderExpenses();
  updateBalance();
  showMessage('Î”Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ Ï„Î¿ Î­Î¾Î¿Î´Î¿', 'success');
}

function renderExpenses() {
  const container = document.getElementById('expensesList');
  const countElement = document.getElementById('expensesCount');
  
  // Filter expenses for selected month
  const monthExpenses = expenses.filter(expense => 
    expense.date.startsWith(selectedMonth)
  );
  
  if (monthExpenses.length === 0) {
    container.innerHTML = `
      <div style="text-align: center; padding: 30px; color: #666;">
        <div style="font-size: 40px; margin-bottom: 10px;">ğŸ“­</div>
        <p>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½Î± Î­Î¾Î¿Î´Î±<br>Î³Î¹Î± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Î¼Î®Î½Î±</p>
      </div>
    `;
    countElement.textContent = '0';
    return;
  }
  
  // Sort by date (newest first)
  monthExpenses.sort((a, b) => new Date(b.date) - new Date(a.date));
  
  // Take only last 10 for display
  const recentExpenses = monthExpenses.slice(0, 10);
  
  let html = '';
  recentExpenses.forEach(expense => {
    const date = new Date(expense.date);
    const day = date.getDate().toString().padStart(2, '0');
    const month = (date.getMonth() + 1).toString().padStart(2, '0');
    
    html += `
      <div class="expense-item">
        <div class="expense-info">
          <div class="expense-category">${expense.category}</div>
          <div class="expense-note">${expense.note} â€¢ ${day}/${month}</div>
        </div>
        <div class="expense-amount">${expense.amount.toFixed(2)} â‚¬</div>
        <button class="delete-button" onclick="deleteExpense(${expense.id})">Ã—</button>
      </div>
    `;
  });
  
  container.innerHTML = html;
  countElement.textContent = monthExpenses.length;
}

// ==================== CATEGORY FUNCTIONS ====================
function renderCategories() {
  const container = document.getElementById('categoriesList');
  const select = document.getElementById('categorySelect');
  
  // Update select dropdown
  select.innerHTML = '<option value="">Î•Ï€Î¹Î»Î¿Î³Î®...</option>' +
    categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
  
  // Update categories list
  container.innerHTML = categories.map(cat => `
    <div class="category-tag">
      ${cat}
      <button onclick="deleteCategory('${cat}')">Ã—</button>
    </div>
  `).join('');
}

function addCategory() {
  const input = document.getElementById('newCategoryInput');
  const category = input.value.trim();
  
  if (!category) {
    showMessage('Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚', 'error');
    input.focus();
    return;
  }
  
  if (categories.includes(category)) {
    showMessage('Î— ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·', 'error');
    input.focus();
    return;
  }
  
  categories.push(category);
  input.value = '';
  saveToStorage();
  renderCategories();
  showMessage(`Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${category}"`, 'success');
  input.focus();
}

function deleteCategory(categoryName) {
  if (!confirm(`Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ "${categoryName}";\nÎ¤Î± Î­Î¾Î¿Î´Î± Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ Î¸Î± Î´Î¹Î±Î³ÏÎ±Ï†Î¿ÏÎ½.`)) {
    return;
  }
  
  // Remove category
  categories = categories.filter(cat => cat !== categoryName);
  
  // Remove expenses with this category
  expenses = expenses.filter(expense => expense.category !== categoryName);
  
  saveToStorage();
  renderCategories();
  renderExpenses();
  updateBalance();
  showMessage(`Î”Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${categoryName}"`, 'success');
}

// ==================== BALANCE FUNCTIONS ====================
function updateBalance() {
  const monthExpenses = expenses.filter(expense => 
    expense.date.startsWith(selectedMonth)
  );
  
  const totalSpent = monthExpenses.reduce((sum, expense) => sum + expense.amount, 0);
  const available = monthlyIncome - totalSpent;
  
  document.getElementById('totalSpent').textContent = totalSpent.toFixed(2) + ' â‚¬';
  document.getElementById('availableBalance').textContent = available.toFixed(2) + ' â‚¬';
  
  // Update color based on balance
  const balanceElement = document.getElementById('availableBalance');
  balanceElement.className = available >= 0 ? 'balance-value balance-positive' : 'balance-value balance-negative';
}

// ==================== SYNC FUNCTIONS ====================
function showSyncModal() {
  const content = document.getElementById('syncContent');
  
  if (localStorage.getItem('budgetbuddy_sync_code')) {
    // Already connected
    const code = localStorage.getItem('budgetbuddy_sync_code');
    content.innerHTML = `
      <div style="text-align: center; padding: 20px 0;">
        <div style="font-size: 32px; color: #4caf50;">âœ…</div>
        <p style="margin: 10px 0;"><strong>Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹!</strong></p>
        <p>ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï:</p>
        <div style="background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 15px 0; font-family: monospace; font-size: 20px; letter-spacing: 3px;">
          ${code}
        </div>
        <p style="font-size: 14px; color: #666;">Î”ÏÏƒÏ„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÏƒÏ„Î¿Î½ ÏƒÏÎ¶Ï…Î³ÏŒ ÏƒÎ±Ï‚</p>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button style="flex: 1; padding: 12px; background: #f44336; color: white; border: none; border-radius: 8px;" onclick="disconnectSync()">
          Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·
        </button>
        <button style="flex: 1; padding: 12px; background: #2196f3; color: white; border: none; border-radius: 8px;" onclick="copySyncCode()">
          Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î®
        </button>
      </div>
    `;
  } else {
    // Not connected
    content.innerHTML = `
      <div style="text-align: center; padding: 20px 0;">
        <div style="font-size: 32px; color: #e91e63;">ğŸ”—</div>
        <p style="margin: 10px 0;"><strong>Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï</strong></p>
        <p style="color: #666; margin-bottom: 20px;">Î“Î¹Î± ÎºÎ¿Î¹Î½Î® Ï‡ÏÎ®ÏƒÎ· Î¼Îµ Ï„Î¿ Î¬Î»Î»Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ</p>
      </div>
      
      <div style="margin-bottom: 20px;">
        <h4 style="margin-bottom: 10px;">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î¿Ï…:</h4>
        <button style="width: 100%; padding: 12px; background: #e91e63; color: white; border: none; border-radius: 8px;" onclick="createSync()">
          ğŸš€ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎšÏ‰Î´Î¹ÎºÎ¿Ï
        </button>
      </div>
      
      <div>
        <h4 style="margin-bottom: 10px;">Î£ÏÎ½Î´ÎµÏƒÎ· Î¼Îµ Ï…Ï€Î¬ÏÏ‡Î¿Î½:</h4>
        <input type="text" id="joinCodeInput" placeholder="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÎºÏ‰Î´Î¹ÎºÏŒ" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; margin-bottom: 10px; text-align: center; letter-spacing: 3px;">
        <button style="width: 100%; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px;" onclick="joinSync()">
          ğŸ”— Î£ÏÎ½Î´ÎµÏƒÎ·
        </button>
      </div>
    `;
  }
  
  document.getElementById('syncModal').style.display = 'flex';
}

function closeSyncModal() {
  document.getElementById('syncModal').style.display = 'none';
}

function createSync() {
  const code = generateCode();
  localStorage.setItem('budgetbuddy_sync_code', code);
  localStorage.setItem('budgetbuddy_sync_role', 'creator');
  showMessage(`Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚: ${code}`, 'success');
  updateSyncStatus();
  closeSyncModal();
}

function joinSync() {
  const input = document.getElementById('joinCodeInput');
  const code = input.value.trim().toUpperCase();
  
  if (!code || code.length !== 6) {
    showMessage('Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ 6-ÏˆÎ®Ï†Î¹Î¿ ÎºÏ‰Î´Î¹ÎºÏŒ', 'error');
    return;
  }
  
  localStorage.setItem('budgetbuddy_sync_code', code);
  localStorage.setItem('budgetbuddy_sync_role', 'member');
  showMessage(`Î£Ï…Î½Î´ÎµÎ¸Î®ÎºÎ±Ï„Îµ Î¼Îµ ÎºÏ‰Î´Î¹ÎºÏŒ: ${code}`, 'success');
  updateSyncStatus();
  closeSyncModal();
}

function disconnectSync() {
  localStorage.removeItem('budgetbuddy_sync_code');
  localStorage.removeItem('budgetbuddy_sync_role');
  showMessage('Î‘Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸Î®ÎºÎ±Ï„Îµ Î±Ï€ÏŒ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ', 'success');
  updateSyncStatus();
  closeSyncModal();
}

function copySyncCode() {
  const code = localStorage.getItem('budgetbuddy_sync_code');
  if (!code) return;
  
  navigator.clipboard.writeText(code)
    .then(() => showMessage('Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ Î¿ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!', 'success'))
    .catch(() => showMessage('Î”ÎµÎ½ Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„Î® Î· Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î®', 'error'));
}

function generateCode() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let code = '';
  for (let i = 0; i < 6; i++) {
    code += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return code;
}

function updateSyncStatus() {
  const statusElement = document.getElementById('syncStatus');
  const hasCode = localStorage.getItem('budgetbuddy_sync_code');
  
  if (hasCode) {
    statusElement.className = 'sync-status sync-online';
    statusElement.title = 'Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹';
  } else {
    statusElement.className = 'sync-status sync-offline';
    statusElement.title = 'Î§Ï‰ÏÎ¯Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ·';
  }
}

// ==================== UTILITY FUNCTIONS ====================
function showMessage(text, type = 'info') {
  // Remove existing message
  const existing = document.getElementById('tempMessage');
  if (existing) existing.remove();
  
  // Create new message
  const message = document.createElement('div');
  message.id = 'tempMessage';
  message.style.cssText = `
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#333'};
    color: white;
    padding: 12px 24px;
    border-radius: 25px;
    z-index: 10000;
    font-size: 14px;
    animation: fadeInOut 3s ease-in-out;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    gap: 8px;
  `;
  
  message.innerHTML = `
    ${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}
    <span>${text}</span>
  `;
  
  document.body.appendChild(message);
  
  // Add styles if not exist
  if (!document.getElementById('msg-styles')) {
    const style = document.createElement('style');
    style.id = 'msg-styles';
    style.textContent = `
      @keyframes fadeInOut {
        0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        10% { opacity: 1; transform: translateX(-50%) translateY(0); }
        90% { opacity: 1; transform: translateX(-50%) translateY(0); }
        100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
      }
    `;
    document.head.appendChild(style);
  }
  
  // Auto remove
  setTimeout(() => {
    if (message.parentNode) {
      message.style.animation = 'fadeOut 0.5s ease-in-out';
      setTimeout(() => message.remove(), 500);
    }
  }, 3000);
}

function showScreen(screen) {
  // Remove active class from all buttons
  document.querySelectorAll('.nav-button').forEach(btn => {
    btn.classList.remove('active');
  });
  
  // Add active class to clicked button
  event.target.closest('.nav-button').classList.add('active');
  
  // Here you can implement screen switching
  showMessage(`Î•Ï€Î¹Î»Î¿Î³Î® Î¿Î¸ÏŒÎ½Î·Ï‚: ${screen}`, 'info');
}

// Initialize sync status
updateSyncStatus();

// Auto-save every 30 seconds
setInterval(saveToStorage, 30000);
</script>
</body>
</html>
