<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BudgetBuddy â€” ÎˆÎ¾Î¿Î´Î± Î£Ï€Î¹Ï„Î¹Î¿Ï</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â‚¬</text></svg>">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â‚¬</text></svg>">
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(to bottom, #ffe6f1, #fff0f7);
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }

  .stars {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 150px;
    overflow: hidden;
    z-index: 0;
  }

  .star {
    position: absolute;
    color: #fff;
    font-size: 18px;
    opacity: 0.8;
    animation: twinkle 5s infinite ease-in-out;
  }

  @keyframes twinkle {
    0%,100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.3); }
  }

  /* HEADER STYLES */
  .app-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background: white;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    z-index: 1000;
  }

  .header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid #f0f0f0;
  }

  .app-title {
    font-size: 1.3em;
    color: #e91e63;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  /* TABS STYLES */
  .tabs-container {
    display: flex;
    overflow-x: auto;
    background: white;
    border-bottom: 2px solid #f0f0f0;
    scrollbar-width: none; /* Firefox */
  }

  .tabs-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
  }

  .tab {
    flex: 1;
    min-width: 120px;
    padding: 15px 10px;
    text-align: center;
    background: white;
    border: none;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: #666;
    white-space: nowrap;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .tab:hover {
    background: #f9f9f9;
    color: #e91e63;
  }

  .tab.active {
    background: #fff0f7;
    color: #e91e63;
    border-bottom-color: #e91e63;
    font-weight: 600;
  }

  /* MAIN CONTENT */
  .container {
    position: relative;
    z-index: 1;
    max-width: 900px;
    margin: 160px auto 20px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    padding: 25px 35px;
  }

  .tab-content {
    display: none;
    animation: fadeIn 0.3s ease-in-out;
  }

  .tab-content.active {
    display: block;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* BUTTONS */
  .sync-button-header {
    background: #e91e63;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 8px 16px;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 2px 5px rgba(233, 30, 99, 0.3);
    transition: all 0.3s;
  }
  
  .sync-button-header:hover {
    background: #d81b60;
    transform: scale(1.05);
  }
  
  .sync-status-dot {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    margin-left: 5px;
  }
  
  .sync-online { background: #4caf50; animation: pulse 2s infinite; }
  .sync-offline { background: #f44336; }
  .sync-connecting { background: #ff9800; animation: pulse 2s infinite; }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  /* ============ Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ QUICK ADD FORM - TAB 1 ============ */
  .quick-add-form {
    background: #fff0f7;
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: 0 4px 12px rgba(233, 30, 99, 0.1);
  }

  .quick-add-form h2 {
    color: #e91e63;
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 1.4em;
  }

  /* Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ Î Î¡Î©Î¤ÎŸ ROW - Î ÎŸÎ£ÎŸ & ÎšÎŸÎ¥ÎœÎ Î™ */
  .first-row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
    align-items: flex-end;
  }

  .amount-group {
    flex: 1;
  }

  .add-button-group {
    flex-shrink: 0;
  }

  /* Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ Î”Î•Î¥Î¤Î•Î¡ÎŸ ROW - ÎšÎ‘Î¤Î—Î“ÎŸÎ¡Î™Î‘ & Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ */
  .second-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 15px;
  }

  /* Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ Î¤Î¡Î™Î¤ÎŸ ROW - Î£Î—ÎœÎ•Î™Î©Î£Î— */
  .note-row {
    margin-bottom: 0;
  }

  .form-group {
    display: flex;
    flex-direction: column;
  }

  .form-group label {
    margin-bottom: 6px;
    font-weight: 500;
    color: #e91e63;
    font-size: 14px;
  }

  .amount-input-wrapper {
    position: relative;
    width: 100%;
  }

  .amount-input-wrapper::before {
    content: "â‚¬";
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #e91e63;
    font-weight: bold;
    z-index: 1;
    font-size: 16px;
  }

  .amount-input-wrapper input {
    padding-left: 40px !important;
    font-size: 16px;
    height: 50px;
  }

  input, select, button {
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ddd;
    font-size: 16px;
    box-sizing: border-box;
  }

  button {
    cursor: pointer;
    transition: all 0.3s;
    height: 50px;
  }

  button.add { 
    background: #e91e63; 
    color: white; 
    border: none; 
    font-weight: bold;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 0 25px;
    white-space: nowrap;
    min-width: 140px;
  }

  button.add:hover {
    background: #d81b60;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
  }

  /* BUDGET OVERVIEW - TAB 2 */
  .budget-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }

  .budget-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    border-left: 5px solid #e91e63;
    transition: all 0.3s;
  }

  .budget-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.12);
  }

  .budget-card.over {
    border-left-color: #f44336;
  }

  .budget-card.under {
    border-left-color: #4caf50;
  }

  .progress-bar {
    height: 8px;
    background: #f0f0f0;
    border-radius: 4px;
    margin: 15px 0;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(to right, #e91e63, #ff80ab);
    border-radius: 4px;
    transition: width 0.5s ease-in-out;
  }

  /* BANK BALANCES - TAB 3 */
  .bank-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }

  .bank-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    text-align: center;
    border-top: 5px solid #9c27b0;
  }

  .bank-card h4 {
    margin: 0 0 15px 0;
    color: #333;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  /* SETTINGS - TAB 4 */
  .settings-section {
    background: #f9f9f9;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .settings-section h3 {
    color: #e91e63;
    margin-top: 0;
    border-bottom: 2px solid #ffe6f1;
    padding-bottom: 10px;
  }

  .categories-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 15px 0;
  }

  .category-tag {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 15px;
    background: #e91e63;
    color: white;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 5px rgba(233, 30, 99, 0.2);
  }

  /* MODALS */
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    padding: 20px;
  }
  
  .modal-content {
    background: white;
    border-radius: 15px;
    padding: 30px;
    max-width: 500px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }

  /* RECENT EXPENSES */
  .recent-expenses-container {
    max-height: 300px;
    overflow-y: auto;
    margin-top: 15px;
    border-radius: 10px;
    border: 1px solid #eee;
  }

  .expense-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    background: white;
    border-bottom: 1px solid #f0f0f0;
    transition: background 0.2s;
  }

  .expense-item:last-child {
    border-bottom: none;
  }

  .expense-item:hover {
    background: #f9f9f9;
  }

  .expense-info {
    flex: 1;
  }

  .expense-category {
    font-weight: bold;
    color: #333;
  }

  .expense-details {
    font-size: 12px;
    color: #666;
    margin-top: 2px;
  }

  .expense-amount {
    font-weight: bold;
    color: #e91e63;
    font-size: 16px;
  }

  /* RESPONSIVE */
  @media (max-width: 768px) {
    .container {
      margin: 140px 10px 20px;
      padding: 15px 20px;
    }

    .header-top {
      padding: 10px 15px;
    }

    .tab {
      min-width: 100px;
      padding: 12px 8px;
      font-size: 13px;
    }

    .quick-add-form {
      padding: 20px;
    }

    /* Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ RESPONSIVE */
    .first-row {
      flex-direction: column;
      gap: 10px;
    }

    .add-button-group {
      width: 100%;
    }

    button.add {
      width: 100%;
      min-width: unset;
    }

    .second-row {
      grid-template-columns: 1fr;
      gap: 10px;
    }

    .budget-cards,
    .bank-cards {
      grid-template-columns: 1fr;
    }

    input, select, button {
      font-size: 15px;
      padding: 10px;
    }

    .amount-input-wrapper input,
    button.add {
      height: 48px;
    }
  }

  @media (max-width: 480px) {
    .app-title {
      font-size: 1.1em;
    }

    .tab {
      min-width: 80px;
      font-size: 12px;
      padding: 10px 5px;
    }

    .container {
      margin: 130px 5px 10px;
      padding: 10px 15px;
    }

    .quick-add-form {
      padding: 15px;
    }

    button.add {
      font-size: 15px;
      padding: 0 15px;
    }
  }

  /* Î•Î™Î”Î™ÎšÎ— ÎšÎ›Î‘Î£Î— Î“Î™Î‘ ÎšÎ•ÎÎ— Î›Î™Î£Î¤Î‘ */
  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #777;
    background: #f9f9f9;
    border-radius: 10px;
    font-style: italic;
  }
</style>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
</head>
<body>

<div class="stars" id="stars"></div>

<!-- HEADER -->
<div class="app-header">
  <div class="header-top">
    <div class="app-title">
      ğŸŒ¸ BudgetBuddy
    </div>
    <button class="sync-button-header" onclick="showSyncModal()" id="mainSyncButton">
      <span id="syncButtonText">Î£Ï…Î½Î´Î­ÏƒÎ¿Ï…</span>
      <span class="sync-status-dot" id="mainSyncDot"></span>
    </button>
  </div>

  <!-- TABS -->
  <div class="tabs-container">
    <button class="tab active" onclick="switchTab(1)">
      <span>ğŸ“</span> Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·
    </button>
    <button class="tab" onclick="switchTab(2)">
      <span>ğŸ“Š</span> Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î±
    </button>
    <button class="tab" onclick="switchTab(3)">
      <span>ğŸ’°</span> Î¤ÏÎ¬Ï€ÎµÎ¶ÎµÏ‚
    </button>
    <button class="tab" onclick="switchTab(4)">
      <span>âš™ï¸</span> Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚
    </button>
  </div>
</div>

<!-- MAIN CONTAINER -->
<div class="container">
  
  <!-- TAB 1: Î Î¡ÎŸÎ£Î˜Î—ÎšÎ— -->
  <div id="tab1" class="tab-content active">
    <div class="quick-add-form">
      <h2>â• Î“ÏÎ®Î³Î¿ÏÎ· Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î•Î¾ÏŒÎ´Î¿Ï…</h2>
      <p style="color: #666; margin-bottom: 20px;">ÎšÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÏ„Îµ Î­Î¾Î¿Î´Î¿ ÎµÏÎºÎ¿Î»Î± ÎºÎ±Î¹ Î³ÏÎ®Î³Î¿ÏÎ± ÎµÎ½Ï ÎµÎ¯ÏƒÏ„Îµ Î­Î¾Ï‰!</p>
      
      <!-- Î’Î•Î›Î¤Î™Î©ÎœÎ•ÎÎŸ: Î ÎŸÎ£ÎŸ & ÎšÎŸÎ¥ÎœÎ Î™ Î£Î¤Î—Î Î™Î”Î™Î‘ Î“Î¡Î‘ÎœÎœÎ— -->
      <div class="first-row">
        <div class="amount-group form-group">
          <label>ğŸ’° Î Î¿ÏƒÏŒ (â‚¬)</label>
          <div class="amount-input-wrapper">
            <input type="number" id="amount" step="0.01" placeholder="0.00" min="0.01" autocomplete="off">
          </div>
        </div>
        
        <div class="add-button-group">
          <button class="add" onclick="addExpense()" id="addExpenseButton">
            <span>â•</span> Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·
          </button>
        </div>
      </div>
      
      <!-- ÎšÎ‘Î¤Î—Î“ÎŸÎ¡Î™Î‘ & Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ -->
      <div class="second-row">
        <div class="form-group">
          <label>ğŸ“‚ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
          <select id="category"></select>
        </div>
        
        <div class="form-group">
          <label>ğŸ“… Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</label>
          <input type="date" id="date" value="">
        </div>
      </div>
      
      <!-- Î£Î—ÎœÎ•Î™Î©Î£Î— -->
      <div class="form-group note-row">
        <label>ğŸ“ Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ· (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)</label>
        <input type="text" id="note" placeholder="Ï€.Ï‡. ÏˆÏÎ½Î¹Î± ÏƒÎ¿ÏÏ€ÎµÏ Î¼Î¬ÏÎºÎµÏ„" autocomplete="off">
      </div>
    </div>

    <div style="margin-top: 30px;">
      <h3 style="color: #e91e63; margin-bottom: 10px;">ğŸ“‹ Î ÏÏŒÏƒÏ†Î±Ï„Î± Î­Î¾Î¿Î´Î±</h3>
      <div class="recent-expenses-container" id="recentExpenses">
        <!-- Î˜Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎµÎ´Ï Ï„Î± Ï€ÏÏŒÏƒÏ†Î±Ï„Î± Î­Î¾Î¿Î´Î± -->
      </div>
    </div>
  </div>

  <!-- TAB 2: Î¥Î ÎŸÎ›ÎŸÎ™Î Î‘ -->
  <div id="tab2" class="tab-content">
    <h2 style="color: #e91e63; margin-top: 0;">ğŸ“Š Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±Î½Î¬ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</h2>
    
    <div style="background: #f0f8ff; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
        <div style="text-align: center;">
          <div style="font-size: 12px; color: #666;">Î•Î¹ÏƒÏŒÎ´Î·Î¼Î±</div>
          <div style="font-size: 24px; font-weight: bold; color: #4caf50;" id="displayIncome">0 â‚¬</div>
        </div>
        <div style="text-align: center;">
          <div style="font-size: 12px; color: #666;">ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½</div>
          <div style="font-size: 24px; font-weight: bold; color: #e91e63;" id="displaySpent">0 â‚¬</div>
        </div>
      </div>
    </div>
    
    <div class="budget-cards" id="budgetCards">
      <!-- Î˜Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎµÎ´Ï Î¿Î¹ ÎºÎ±ÏÏ„Î­Î»ÎµÏ‚ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï -->
    </div>
    
    <div style="margin-top: 30px; padding: 20px; background: linear-gradient(to right, #e8f5e9, #f1f8e9); border-radius: 10px;">
      <h3 style="margin-top: 0; color: #2e7d32;">ğŸ’° Î¤ÎµÎ»Î¹ÎºÏŒ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î¿</h3>
      <div style="text-align: center; padding: 20px;">
        <div style="font-size: 32px; font-weight: bold; color: #e91e63;" id="finalBalanceDisplay">0 â‚¬</div>
        <div style="color: #666; font-size: 14px;">(Î£ÏÎ½Î¿Î»Î¿ Î•ÏƒÏŒÎ´Ï‰Î½ - ÎˆÏ‡Î¿Ï…Î½ ÎÎ¿Î´ÎµÏ…Ï„ÎµÎ¯)</div>
      </div>
    </div>
  </div>

  <!-- TAB 3: Î¤Î¡Î‘Î Î•Î–Î•Î£ -->
  <div id="tab3" class="tab-content">
    <h2 style="color: #e91e63; margin-top: 0;">ğŸ’° Î¤ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î±</h2>
    <p style="color: #666; margin-bottom: 20px;">ÎšÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÏ„Îµ Ï„Î± Ï„ÏÎ­Ï‡Î¿Î½Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¬ ÏƒÎ±Ï‚:</p>
    
    <div class="bank-cards">
      <div class="bank-card">
        <h4>ğŸ›ï¸ Î‘Î»Ï†Î± Î¤ÏÎ¬Ï€ÎµÎ¶Î±</h4>
        <input type="number" id="alphaBank" step="0.01" placeholder="0.00" style="text-align: center; font-size: 18px;" autocomplete="off">
      </div>
      
      <div class="bank-card">
        <h4>ğŸ‡¬ğŸ‡· Î•Î¸Î½Î¹ÎºÎ® Î¤ÏÎ¬Ï€ÎµÎ¶Î±</h4>
        <input type="number" id="nationalBank" step="0.01" placeholder="0.00" style="text-align: center; font-size: 18px;" autocomplete="off">
      </div>
      
      <div class="bank-card">
        <h4>ğŸ’µ ÎœÎµÏ„ÏÎ·Ï„Î¬</h4>
        <input type="number" id="cash" step="0.01" placeholder="0.00" style="text-align: center; font-size: 18px;" autocomplete="off">
      </div>
      
      <div class="bank-card">
        <h4>ğŸ“ˆ Î˜Î± Ï€Î¬ÏÏ‰ Î±ÎºÏŒÎ¼Î±</h4>
        <input type="number" id="expectedIncome" step="0.01" placeholder="0.00" style="text-align: center; font-size: 18px;" autocomplete="off">
      </div>
    </div>
    
    <button class="add" onclick="saveBankBalances()" style="margin-top: 20px; width: 100%;">
      <span>ğŸ’¾</span> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î¥Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½
    </button>
    
    <div style="margin-top: 30px; padding: 20px; background: #f0f8ff; border-radius: 10px;">
      <h3 style="margin-top: 0; color: #2196f3;">ğŸ“Š Î£ÏÎ½Î¿Î»Î¿ Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Î§ÏÎ·Î¼Î¬Ï„Ï‰Î½</h3>
      <div style="text-align: center; padding: 15px;">
        <div style="font-size: 28px; font-weight: bold; color: #2196f3;" id="totalAvailableMoney">0 â‚¬</div>
      </div>
    </div>
  </div>

  <!-- TAB 4: Î¡Î¥Î˜ÎœÎ™Î£Î•Î™Î£ -->
  <div id="tab4" class="tab-content">
    <h2 style="color: #e91e63; margin-top: 0;">âš™ï¸ Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚</h2>
    
    <div class="settings-section">
      <h3>ğŸ“‚ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎšÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½</h3>
      <div style="display: flex; gap: 10px; margin-bottom: 15px;">
        <input type="text" id="newCategoryName" placeholder="ÎŒÎ½Î¿Î¼Î± Î½Î­Î±Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚" style="flex: 1;" autocomplete="off">
        <button class="add" onclick="addNewCategory()" style="width: auto; padding: 12px 20px;">
          <span>â•</span> Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·
        </button>
      </div>
      
      <div class="categories-list" id="categoriesList"></div>
      <p style="color: #666; font-size: 13px; margin-top: 10px;">Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·: Î— Î´Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ Î¸Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹ ÎºÎ±Î¹ Ï„Î± ÏƒÏ…Î½Î±Ï†Î® Î­Î¾Î¿Î´Î±!</p>
    </div>
    
    <div class="settings-section">
      <h3>ğŸ’° ÎœÎ·Î½Î¹Î±Î¯Î¿Î¹ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯</h3>
      <p style="color: #666; margin-bottom: 15px;">ÎŸÏÎ¯ÏƒÏ„Îµ Ï„Î¿Î½ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±:</p>
      <div id="recurringInputs"></div>
      <button class="add" onclick="saveRecurringAmounts()" style="margin-top: 15px; width: 100%;">
        <span>ğŸ’¾</span> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½
      </button>
    </div>
    
    <div class="settings-section">
      <h3>ğŸ”— Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚</h3>
      <p style="color: #666; margin-bottom: 15px;">Î£Ï…Î½Î´Î­ÏƒÏ„Îµ 2 Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± ÎºÎ¹Î½Î·Ï„Î¬ Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï„Î± Î¯Î´Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±!</p>
      <div id="syncStatusInfo" style="margin-bottom: 15px;"></div>
      <button class="add" onclick="showSyncModal()" style="width: 100%;">
        <span>ğŸ”—</span> Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï
      </button>
    </div>
  </div>

</div>

<!-- MODAL Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ¥ -->
<div class="modal" id="syncModal">
  <div class="modal-content">
    <h2 style="color: #e91e63; margin-top: 0;">ğŸ”— Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£</h2>
    <div id="syncModalContent"></div>
    <div style="text-align: center; margin-top: 20px;">
      <button onclick="closeSyncModal()" style="padding: 10px 25px; background: #f0f0f0; border: none; border-radius: 8px; cursor: pointer;">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
  </div>
</div>

<script>
// ==================== ÎŸÎ›Î•Î£ ÎŸÎ™ ÎœÎ•Î¤Î‘Î’Î›Î—Î¤Î•Î£ ====================
let categories = JSON.parse(localStorage.getItem('cats') || '[]');
let expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
let recurringAmounts = JSON.parse(localStorage.getItem('recurringAmounts') || '{}');
let income = parseFloat(localStorage.getItem('income') || '2000');

let bankBalances = JSON.parse(localStorage.getItem('bankBalances') || JSON.stringify({
  alphaBank: 0,
  nationalBank: 0,
  cash: 0,
  expectedIncome: 0
}));

let syncData = JSON.parse(localStorage.getItem('budgetbuddy_sync') || '{}');
let currentUser = syncData.userName || "ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±";
let currentBudget = syncData.budgetCode || null;
let firebaseRef = null;

// ==================== TABS FUNCTIONALITY ====================
function switchTab(tabNumber) {
  // Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ tabs
  document.querySelectorAll('.tab').forEach(tab => {
    tab.classList.remove('active');
  });
  
  document.querySelectorAll('.tab-content').forEach(content => {
    content.classList.remove('active');
  });
  
  // Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï… tab
  document.querySelector(`.tab:nth-child(${tabNumber})`).classList.add('active');
  document.getElementById(`tab${tabNumber}`).classList.add('active');
  
  // Î‘Î½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ tab 2 (Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î±), Î±Î½Î±Î½Î­Ï‰ÏƒÎµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±
  if (tabNumber === 2) {
    updateBudgetOverview();
  }
  
  // Î‘Î½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ tab 3 (Î¤ÏÎ¬Ï€ÎµÎ¶ÎµÏ‚), Ï†ÏŒÏÏ„Ï‰ÏƒÎµ Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚
  if (tabNumber === 3) {
    loadBankValues();
  }
  
  // Î‘Î½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ tab 4 (Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚), Î±Î½Î±Î½Î­Ï‰ÏƒÎµ Ï„Î¹Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚
  if (tabNumber === 4) {
    updateCategoriesList();
    updateRecurringInputs();
  }
}

// ==================== QUICK MESSAGES ====================
function showQuickMessage(message, type = 'info') {
  const msg = document.createElement('div');
  msg.style.cssText = `
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: ${type === 'error' ? '#f44336' : type === 'success' ? '#4caf50' : '#333'};
    color: white;
    padding: 12px 24px;
    border-radius: 25px;
    z-index: 10000;
    font-size: 14px;
    animation: fadeInOut 3s ease-in-out;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    gap: 10px;
  `;
  msg.innerHTML = `
    ${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}
    <span>${message}</span>
  `;
  
  document.body.appendChild(msg);
  
  setTimeout(() => {
    msg.style.animation = 'fadeOut 0.5s ease-in-out';
    setTimeout(() => msg.remove(), 500);
  }, 3000);
}

// Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± CSS animations Î±Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
if (!document.getElementById('msg-styles')) {
  const style = document.createElement('style');
  style.id = 'msg-styles';
  style.textContent = `
    @keyframes fadeInOut {
      0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
      10% { opacity: 1; transform: translateX(-50%) translateY(0); }
      90% { opacity: 1; transform: translateX(-50%) translateY(0); }
      100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
  `;
  document.head.appendChild(style);
}

// ==================== Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£ ====================
function updateSyncUI(status, data = null) {
  const mainDot = document.getElementById('mainSyncDot');
  const buttonText = document.getElementById('syncButtonText');
  const syncInfo = document.getElementById('syncStatusInfo');
  
  if (status === 'online' && data) {
    mainDot.className = 'sync-status-dot sync-online';
    buttonText.textContent = `Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿`;
    
    if (syncInfo) {
      syncInfo.innerHTML = `
        <div style="background: #e8f5e9; padding: 10px; border-radius: 8px;">
          <strong>âœ… Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î¿!</strong><br>
          <small>ÎšÏ‰Î´Î¹ÎºÏŒÏ‚: <strong>${currentBudget}</strong></small>
        </div>
      `;
    }
    
  } else if (status === 'connecting') {
    mainDot.className = 'sync-status-dot sync-connecting';
    buttonText.textContent = 'Î£Ï…Î½Î´Î­ÎµÏ„Î±Î¹...';
    
    if (syncInfo) {
      syncInfo.innerHTML = '<div style="color: #ff9800;">ğŸ”„ Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÎµ cloud...</div>';
    }
    
  } else {
    mainDot.className = 'sync-status-dot sync-offline';
    buttonText.textContent = 'Î£Ï…Î½Î´Î­ÏƒÎ¿Ï…';
    
    if (syncInfo) {
      syncInfo.innerHTML = '<div style="color: #666;">ğŸ”Œ Î§Ï‰ÏÎ¯Ï‚ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ</div>';
    }
  }
}

function initSync() {
  if (!currentBudget) {
    updateSyncUI('offline');
    return;
  }
  
  if (!firebase.apps.length) {
    const firebaseConfig = {
      apiKey: "AIzaSyBaItM0-eOAwU6snAxfMU_bcp9xW0UfYzQ",
      authDomain: "travelcosts-48d64.firebaseapp.com",
      databaseURL: "https://travelcosts-48d64-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "travelcosts-48d64",
      storageBucket: "travelcosts-48d64.firebasestorage.app",
      messagingSenderId: "792639383940",
      appId: "1:792639383940:web:ed991cc8426603015bd5d1"
    };
    firebase.initializeApp(firebaseConfig);
  }
  
  const database = firebase.database();
  firebaseRef = database.ref(`budgets/${currentBudget}`);
  
  updateSyncUI('connecting');
  
  firebaseRef.on('value', (snapshot) => {
    const data = snapshot.val();
    if (data) {
      syncData.budgetName = data.name;
      syncData.creator = data.creator;
      syncData.members = data.members || [currentUser];
      
      localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
      
      if (data.categories && data.categories.length > 0) {
        categories = data.categories;
      }
      if (data.expenses && data.expenses.length > 0) {
        expenses = data.expenses;
      }
      if (data.recurringAmounts) {
        recurringAmounts = data.recurringAmounts;
      }
      if (data.income) {
        income = data.income;
      }
      if (data.bankBalances) {
        bankBalances = data.bankBalances;
      }
      
      saveAllData();
      updateUIFromData();
      updateSyncUI('online', data);
      
    } else {
      createNewBudgetInFirebase();
    }
  }, (error) => {
    console.error("Firebase error:", error);
    updateSyncUI('offline');
  });
}

function createNewBudgetInFirebase() {
  if (!currentBudget) return;
  
  const budgetName = syncData.budgetName || `Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ${currentBudget}`;
  
  const newBudget = {
    code: currentBudget,
    name: budgetName,
    creator: currentUser,
    created: Date.now(),
    members: [currentUser],
    categories: categories.length > 0 ? categories : ['Î£Î¿ÏÏ€ÎµÏ ÎœÎ¬ÏÎºÎµÏ„', 'ÎÎ¿Î¯ÎºÎ¹', 'Î—Î»ÎµÎºÏ„ÏÎ¹ÎºÏŒ', 'ÎÎµÏÏŒ', 'Î¤Î·Î»Î­Ï†Ï‰Î½Î±', 'ÎšÎ±ÏÏƒÎ¹Î¼Î±', 'Î¨Ï…Ï‡Î±Î³Ï‰Î³Î¯Î±'],
    expenses: expenses,
    recurringAmounts: recurringAmounts,
    income: income,
    bankBalances: bankBalances,
    lastUpdated: Date.now()
  };
  
  firebaseRef.set(newBudget)
    .then(() => {
      updateSyncUI('online', newBudget);
    })
    .catch(error => {
      console.error("Firebase create error:", error);
      updateSyncUI('offline');
    });
}

function syncToFirebase() {
  if (!currentBudget || !firebaseRef) return;
  
  const budgetData = {
    code: currentBudget,
    name: syncData.budgetName || `Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ${currentBudget}`,
    creator: syncData.creator || currentUser,
    members: syncData.members || [currentUser],
    categories: categories,
    expenses: expenses,
    recurringAmounts: recurringAmounts,
    income: income,
    bankBalances: bankBalances,
    lastUpdated: Date.now()
  };
  
  firebaseRef.set(budgetData);
}

// ==================== MODAL Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ¥ ====================
function showSyncModal() {
  const modal = document.getElementById('syncModal');
  const content = document.getElementById('syncModalContent');
  
  if (currentBudget) {
    content.innerHTML = `
      <div style="margin-bottom: 20px;">
        <h3>âœ… Î•Î¯ÏƒÏ„Îµ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹!</h3>
        <p><strong>Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚:</strong> ${syncData.budgetName || currentBudget}</p>
        <p><strong>ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚:</strong></p>
        <div style="text-align: center; margin: 15px 0;">
          <div style="font-size: 32px; font-weight: bold; letter-spacing: 3px; color: #e91e63; background: #f9f9f9; padding: 15px; border-radius: 10px;">
            ${currentBudget}
          </div>
        </div>
        <p><small>Î”ÏÏƒÏ„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÏƒÏ„Î¿Î½ ÏƒÏÎ¶Ï…Î³Î¿/ÏƒÏÎ¶Ï…Î³Î¿ Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯</small></p>
      </div>
      
      <div style="display: grid; gap: 10px;">
        <button onclick="showQRCode()" style="padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ´ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· QR Code
        </button>
        <button onclick="copySyncCode()" style="padding: 12px; background: #2196f3; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ“‹ Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® ÎšÏ‰Î´Î¹ÎºÎ¿Ï
        </button>
        <button onclick="disconnectSync()" style="padding: 12px; background: #f44336; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ”Œ Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·
        </button>
      </div>
    `;
  } else {
    content.innerHTML = `
      <div style="margin-bottom: 20px;">
        <h3>ğŸ”— Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï</h3>
        <p>Î£Ï…Î½Î´Î­ÏƒÏ„Îµ 2 Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± ÎºÎ¹Î½Î·Ï„Î¬ Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï„Î± Î¯Î´Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿!</p>
      </div>
      
      <div style="margin-bottom: 20px;">
        <h4>ğŸš€ Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ ÎÎ•ÎŸÎ¥</h4>
        
        <div style="margin: 10px 0;">
          <label style="display: block; margin-bottom: 5px;">Î¤Î¿ ÎŒÎ½Î¿Î¼Î¬ Î£Î±Ï‚:</label>
          <input type="text" id="newUserName" value="${currentUser}" placeholder="Ï€.Ï‡. ÎœÎ±ÏÎ¯Î±" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>
        
        <div style="margin: 10px 0;">
          <label style="display: block; margin-bottom: 5px;">ÎŒÎ½Î¿Î¼Î± Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï:</label>
          <input type="text" id="newBudgetName" placeholder="Ï€.Ï‡. ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>
        
        <button onclick="createNewSync()" style="width: 100%; padding: 12px; background: #e91e63; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸš€ Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ ÎÎ•ÎŸÎ¥ Î Î¡ÎŸÎ¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ¥
        </button>
      </div>
      
      <div>
        <h4>ğŸ”— Î£Î¥ÎÎ”Î•Î£Î— Î£Î• Î¥Î Î‘Î¡Î§ÎŸÎ</h4>
        
        <div style="margin: 10px 0;">
          <label style="display: block; margin-bottom: 5px;">Î¤Î¿ ÎŒÎ½Î¿Î¼Î¬ Î£Î±Ï‚:</label>
          <input type="text" id="joinUserName" value="${currentUser}" placeholder="Ï€.Ï‡. Î“Î¹Î¬Î½Î½Î·Ï‚" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>
        
        <div style="margin: 10px 0;">
          <label style="display: block; margin-bottom: 5px;">ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï:</label>
          <input type="text" id="joinBudgetCode" placeholder="6 ÏˆÎ·Ï†Î¯Î±" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; text-align: center; letter-spacing: 3px; font-size: 18px;">
        </div>
        
        <button onclick="joinExistingSync()" style="width: 100%; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer;">
          ğŸ”— Î£Î¥ÎÎ”Î•Î£Î— Î£Î• Î¥Î Î‘Î¡Î§ÎŸÎ Î Î¡ÎŸÎ¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸ
        </button>
      </div>
    `;
  }
  
  modal.style.display = 'flex';
}

function closeSyncModal() {
  document.getElementById('syncModal').style.display = 'none';
}

function createNewSync() {
  const userName = document.getElementById('newUserName').value.trim() || "ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±";
  const budgetName = document.getElementById('newBudgetName').value.trim() || "ÎŸÎ¹ÎºÎ¿Î³ÎµÎ½ÎµÎ¹Î±ÎºÏŒÏ‚ Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚";
  
  if (!budgetName) {
    showQuickMessage('âš ï¸ Î£Ï…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ ÏŒÎ½Î¿Î¼Î± Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï', 'error');
    return;
  }
  
  currentUser = userName;
  currentBudget = generateSyncCode();
  
  syncData = {
    userName: userName,
    budgetCode: currentBudget,
    budgetName: budgetName,
    creator: userName,
    members: [userName],
    justCreated: true
  };
  
  localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
  
  closeSyncModal();
  showQuickMessage('âœ… Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î½Î­Î¿Ï‚ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚!', 'success');
  
  setTimeout(() => {
    initSync();
  }, 500);
}

function joinExistingSync() {
  const userName = document.getElementById('joinUserName').value.trim() || "ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±";
  const joinCode = document.getElementById('joinBudgetCode').value.trim().toUpperCase();
  
  if (!joinCode || joinCode.length !== 6) {
    showQuickMessage('âš ï¸ Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ 6-ÏˆÎ®Ï†Î¹Î¿ ÎºÏ‰Î´Î¹ÎºÏŒ', 'error');
    return;
  }
  
  currentUser = userName;
  currentBudget = joinCode;
  
  syncData = {
    userName: userName,
    budgetCode: joinCode,
    members: [userName]
  };
  
  localStorage.setItem('budgetbuddy_sync', JSON.stringify(syncData));
  
  closeSyncModal();
  showQuickMessage('ğŸ”— Î£Ï…Î½Î´Î­ÎµÏƒÏ„Îµ ÏƒÏ„Î¿Î½ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒ...', 'info');
  
  setTimeout(() => {
    initSync();
  }, 500);
}

function showQRCode() {
  if (!currentBudget) return;
  
  const qrData = {
    app: "BudgetBuddy",
    code: currentBudget,
    name: syncData.budgetName || "Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚",
    type: "join"
  };
  
  const qrText = JSON.stringify(qrData);
  
  QRCode.toCanvas(qrText, { width: 250 }, function(error, canvas) {
    if (error) {
      console.error('QR error:', error);
      return;
    }
    
    const modal = document.getElementById('syncModal');
    const content = document.getElementById('syncModalContent');
    
    content.innerHTML = `
      <div style="text-align: center;">
        <h3>ğŸ“± QR Code Î£ÏÎ½Î´ÎµÏƒÎ·Ï‚</h3>
        <p>Î£ÎºÎ±Î½Î¬ÏÎµÏ„Îµ Î¼Îµ Ï„Î¿ Î¬Î»Î»Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ:</p>
        <div style="margin: 20px 0; padding: 15px; background: white; border-radius: 10px; display: inline-block;">
          ${canvas.outerHTML}
        </div>
        <p><strong>ÎšÏ‰Î´Î¹ÎºÏŒÏ‚:</strong> ${currentBudget}</p>
        <button onclick="showSyncModal()" style="padding: 10px 20px; background: #e91e63; color: white; border: none; border-radius: 8px; cursor: pointer;">
          Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î®
        </button>
      </div>
    `;
  });
}

function copySyncCode() {
  if (!currentBudget) return;
  
  navigator.clipboard.writeText(currentBudget).then(() => {
    showQuickMessage('ğŸ“‹ Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ Î¿ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!', 'success');
  }).catch(() => {
    const tempInput = document.createElement('input');
    tempInput.value = currentBudget;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand('copy');
    document.body.removeChild(tempInput);
    showQuickMessage('ğŸ“‹ Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ Î¿ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!', 'success');
  });
}

function disconnectSync() {
  if (confirm('Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î±Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Î±Ï€ÏŒ Ï„Î¿Î½ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ;\nÎ¤Î± Ï„Î¿Ï€Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¸Î± Ï€Î±ÏÎ±Î¼ÎµÎ¯Î½Î¿Ï…Î½.')) {
    if (firebaseRef) {
      firebaseRef.off();
    }
    
    currentBudget = null;
    syncData = {};
    localStorage.setItem('budgetbuddy_sync', JSON.stringify({}));
    
    closeSyncModal();
    updateSyncUI('offline');
    showQuickMessage('ğŸ”Œ Î‘Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸Î®ÎºÎ±Ï„Îµ Î±Ï€ÏŒ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ', 'success');
  }
}

function generateSyncCode() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let code = '';
  for (let i = 0; i < 6; i++) {
    code += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return code;
}

// ==================== MAIN APP FUNCTIONS ====================
function cleanupData() {
  categories = categories.filter(cat => cat && typeof cat === 'string' && cat.trim() !== '');
  
  const cleanRecurring = {};
  categories.forEach(cat => {
    if (recurringAmounts[cat] !== undefined) {
      const value = parseFloat(recurringAmounts[cat]);
      cleanRecurring[cat] = isNaN(value) ? 0 : value;
    }
  });
  recurringAmounts = cleanRecurring;
}

function saveAllData() {
  localStorage.setItem('cats', JSON.stringify(categories));
  localStorage.setItem('expenses', JSON.stringify(expenses));
  localStorage.setItem('recurringAmounts', JSON.stringify(recurringAmounts));
  localStorage.setItem('income', income);
  localStorage.setItem('bankBalances', JSON.stringify(bankBalances));
  
  if (currentBudget) {
    syncToFirebase();
  }
}

function updateUIFromData() {
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½ ÏƒÏ„Î¿ dropdown
  const categorySelect = document.getElementById('category');
  if (categories.length > 0) {
    categorySelect.innerHTML = categories.map(c => `<option value="${c}">${c}</option>`).join('');
  } else {
    categorySelect.innerHTML = '<option value="">Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚</option>';
  }
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€ÏÏŒÏƒÏ†Î±Ï„Ï‰Î½ ÎµÎ¾ÏŒÎ´Ï‰Î½
  updateRecentExpenses();
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½
  updateBudgetOverview();
}

function updateRecentExpenses() {
  const recentExpensesDiv = document.getElementById('recentExpenses');
  const recentExpenses = expenses.slice(-10).reverse(); // 10 Ï€Î¹Î¿ Ï€ÏÏŒÏƒÏ†Î±Ï„Î±
  
  if (recentExpenses.length === 0) {
    recentExpensesDiv.innerHTML = `
      <div class="empty-state">
        ğŸ“­ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½Î± Î­Î¾Î¿Î´Î± Î±ÎºÏŒÎ¼Î±
      </div>
    `;
    return;
  }
  
  let html = '';
  recentExpenses.forEach(expense => {
    html += `
      <div class="expense-item">
        <div class="expense-info">
          <div class="expense-category">${expense.category}</div>
          <div class="expense-details">${expense.date} | ${expense.note || '-'}</div>
        </div>
        <div class="expense-amount">${expense.amount.toFixed(2)} â‚¬</div>
      </div>
    `;
  });
  
  recentExpensesDiv.innerHTML = html;
}

function updateBudgetOverview() {
  const budgetCardsDiv = document.getElementById('budgetCards');
  const currentMonth = new Date().toISOString().slice(0,7);
  const monthExpenses = expenses.filter(e => e.date.startsWith(currentMonth));
  
  if (categories.length === 0) {
    budgetCardsDiv.innerHTML = `
      <div class="empty-state" style="grid-column: 1/-1;">
        ğŸ“‚ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚!
      </div>
    `;
    return;
  }
  
  let totalSpent = 0;
  let totalBudget = 0;
  
  let html = '';
  
  categories.forEach(category => {
    const categoryExpenses = monthExpenses.filter(e => e.category === category);
    const categorySpent = categoryExpenses.reduce((sum, e) => sum + e.amount, 0);
    const categoryBudget = recurringAmounts[category] || 0;
    const remaining = categoryBudget - categorySpent;
    const percentage = categoryBudget > 0 ? Math.min(100, (categorySpent / categoryBudget) * 100) : 0;
    
    totalSpent += categorySpent;
    totalBudget += categoryBudget;
    
    let statusClass = '';
    if (remaining < 0) {
      statusClass = 'over';
    } else if (remaining > 0) {
      statusClass = 'under';
    }
    
    html += `
      <div class="budget-card ${statusClass}">
        <h3 style="margin-top: 0; color: #333;">${category}</h3>
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
          <div>
            <div style="font-size: 12px; color: #666;">Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚</div>
            <div style="font-weight: bold; color: #333;">${categoryBudget.toFixed(2)} â‚¬</div>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 12px; color: #666;">ÎÎ¿Î´ÎµÏÏ„Î·ÎºÎ±Î½</div>
            <div style="font-weight: bold; color: #e91e63;">${categorySpent.toFixed(2)} â‚¬</div>
          </div>
        </div>
        
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${percentage}%;"></div>
        </div>
        
        <div style="text-align: center; margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee;">
          <div style="font-size: 12px; color: #666;">ÎœÎ­Î½Î¿Ï…Î½</div>
          <div style="font-size: 20px; font-weight: bold; color: ${remaining >= 0 ? '#4caf50' : '#f44336'}">
            ${remaining.toFixed(2)} â‚¬
          </div>
          <div style="font-size: 11px; color: #999;">(${percentage.toFixed(1)}%)</div>
        </div>
      </div>
    `;
  });
  
  budgetCardsDiv.innerHTML = html;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„Ï‰Î½ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½
  document.getElementById('displayIncome').textContent = income.toFixed(2) + ' â‚¬';
  document.getElementById('displaySpent').textContent = totalSpent.toFixed(2) + ' â‚¬';
  
  const currentMoney = (bankBalances.alphaBank || 0) + (bankBalances.nationalBank || 0) + (bankBalances.cash || 0);
  const futureMoney = bankBalances.expectedIncome || 0;
  const totalIncome = currentMoney + futureMoney + income;
  const finalBalance = totalIncome - totalSpent;
  
  document.getElementById('finalBalanceDisplay').textContent = finalBalance.toFixed(2) + ' â‚¬';
  
  if (finalBalance < 0) {
    document.getElementById('finalBalanceDisplay').style.color = '#f44336';
  } else if (finalBalance < totalIncome * 0.1) {
    document.getElementById('finalBalanceDisplay').style.color = '#ff9800';
  } else {
    document.getElementById('finalBalanceDisplay').style.color = '#4caf50';
  }
}

function loadBankValues() {
  // Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Ï„Î¹Î¼ÏÎ½ Î±Ï€ÏŒ Ï„Î¿ bankBalances
  document.getElementById('alphaBank').value = bankBalances.alphaBank > 0 ? bankBalances.alphaBank : '';
  document.getElementById('nationalBank').value = bankBalances.nationalBank > 0 ? bankBalances.nationalBank : '';
  document.getElementById('cash').value = bankBalances.cash > 0 ? bankBalances.cash : '';
  document.getElementById('expectedIncome').value = bankBalances.expectedIncome > 0 ? bankBalances.expectedIncome : '';
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½
  const currentMoney = (bankBalances.alphaBank || 0) + (bankBalances.nationalBank || 0) + (bankBalances.cash || 0);
  const futureMoney = bankBalances.expectedIncome || 0;
  const totalMoney = currentMoney + futureMoney;
  
  document.getElementById('totalAvailableMoney').textContent = totalMoney.toFixed(2) + ' â‚¬';
}

function saveBankBalances() {
  bankBalances = {
    alphaBank: parseFloat(document.getElementById('alphaBank').value) || 0,
    nationalBank: parseFloat(document.getElementById('nationalBank').value) || 0,
    cash: parseFloat(document.getElementById('cash').value) || 0,
    expectedIncome: parseFloat(document.getElementById('expectedIncome').value) || 0
  };
  
  saveAllData();
  showQuickMessage('ğŸ’° Î¤Î± Ï„ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ¬ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
  loadBankValues(); // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„Î·Ï‚ Î¿Î¸ÏŒÎ½Î·Ï‚
}

function updateCategoriesList() {
  const categoriesListDiv = document.getElementById('categoriesList');
  
  if (categories.length === 0) {
    categoriesListDiv.innerHTML = '<div class="empty-state">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚</div>';
    return;
  }
  
  let html = '';
  categories.forEach((category, index) => {
    html += `
      <div class="category-tag">
        ${category}
        <button onclick="deleteCategory(${index})" title="Î”Î¹Î±Î³ÏÎ±Ï†Î®" style="background: transparent; border: none; color: white; cursor: pointer; padding: 0; margin-left: 5px; font-size: 16px;">Ã—</button>
      </div>
    `;
  });
  
  categoriesListDiv.innerHTML = html;
}

function addNewCategory() {
  const newCategoryInput = document.getElementById('newCategoryName');
  const categoryName = newCategoryInput.value.trim();
  
  if (!categoryName) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚', 'error');
    return;
  }
  
  if (categories.includes(categoryName)) {
    showQuickMessage('âš ï¸ Î— ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·!', 'error');
    return;
  }
  
  categories.push(categoryName);
  newCategoryInput.value = '';
  
  saveAllData();
  updateCategoriesList();
  updateRecurringInputs();
  updateUIFromData();
  showQuickMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${categoryName}"`, 'success');
}

function deleteCategory(index) {
  const categoryName = categories[index];
  
  if (!confirm(`Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ "${categoryName}";\nÎ˜Î± Î´Î¹Î±Î³ÏÎ±Ï†Î¿ÏÎ½ ÎºÎ±Î¹ ÏŒÎ»Î± Ï„Î± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î­Î¾Î¿Î´Î±!\nÎ£Î¯Î³Î¿Ï…ÏÎ±;`)) {
    return;
  }
  
  categories.splice(index, 1);
  expenses = expenses.filter(e => e.category !== categoryName);
  
  if (recurringAmounts[categoryName]) {
    delete recurringAmounts[categoryName];
  }
  
  saveAllData();
  updateCategoriesList();
  updateRecurringInputs();
  updateUIFromData();
  showQuickMessage(`ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ Î· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "${categoryName}"`, 'success');
}

function updateRecurringInputs() {
  const recurringInputsDiv = document.getElementById('recurringInputs');
  
  if (categories.length === 0) {
    recurringInputsDiv.innerHTML = '<p style="color:#777;">Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚</p>';
    return;
  }
  
  let html = '<div style="display: grid; gap: 10px;">';
  
  categories.forEach((category, index) => {
    const amount = recurringAmounts[category] || 0;
    const uniqueId = `recurring_${index}_${category.replace(/\s+/g, '_')}`;
    
    html += `
      <div style="display: flex; align-items: center; gap: 10px; background: white; padding: 10px; border-radius: 8px;">
        <div style="flex: 1; font-weight: 500;">${category}</div>
        <input type="number" 
               id="${uniqueId}" 
               value="${amount > 0 ? amount : ''}" 
               step="0.01" 
               placeholder="0.00"
               style="width: 100px; padding: 8px; text-align: right;"
               onchange="updateSingleRecurringAmount('${category}', this.value)">
        <span style="color: #666;">â‚¬</span>
      </div>
    `;
  });
  
  html += '</div>';
  recurringInputsDiv.innerHTML = html;
}

function updateSingleRecurringAmount(category, value) {
  const numValue = parseFloat(value) || 0;
  recurringAmounts[category] = numValue;
  saveAllData();
}

function saveRecurringAmounts() {
  if (categories.length === 0) {
    showQuickMessage('âš ï¸ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚', 'error');
    return;
  }
  
  categories.forEach(category => {
    const inputs = document.querySelectorAll(`input[id^="recurring_"]`);
    
    inputs.forEach(input => {
      if (input.id.includes(category.replace(/\s+/g, '_')) || 
          input.previousElementSibling?.textContent?.includes(category)) {
        const value = parseFloat(input.value) || 0;
        recurringAmounts[category] = value;
      }
    });
  });
  
  saveAllData();
  showQuickMessage('ğŸ’¾ ÎŸÎ¹ Î¼Î·Î½Î¹Î±Î¯Î¿Î¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!', 'success');
}

function addExpense() {
  if (categories.length === 0) {
    showQuickMessage('âš ï¸ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÏÏÏ„Î± ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚', 'error');
    return;
  }
  
  const amount = parseFloat(document.getElementById('amount').value);
  const category = document.getElementById('category').value;
  const date = document.getElementById('date').value;
  const note = document.getElementById('note').value.trim();
  
  if (!amount || amount <= 0) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î½Î± Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÏŒ', 'error');
    document.getElementById('amount').focus();
    return;
  }
  
  if (!date) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±', 'error');
    document.getElementById('date').focus();
    return;
  }
  
  if (!category) {
    showQuickMessage('âš ï¸ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±', 'error');
    document.getElementById('category').focus();
    return;
  }
  
  const newExpense = {
    id: Date.now() + Math.random(),
    amount: amount,
    category: category,
    date: date,
    note: note || '-',
    isRecurring: false
  };
  
  expenses.push(newExpense);
  
  // ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼ÏŒÎ½Î¿ Ï„Î¿Ï… Ï€Î¿ÏƒÎ¿Ï ÎºÎ±Î¹ Ï„Î·Ï‚ ÏƒÎ·Î¼ÎµÎ¯Ï‰ÏƒÎ·Ï‚
  document.getElementById('amount').value = '';
  document.getElementById('note').value = '';
  
  saveAllData();
  
  // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚ ÏƒÏ„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯
  const addButton = document.getElementById('addExpenseButton');
  const originalHTML = addButton.innerHTML;
  const originalBackground = addButton.style.background;
  
  addButton.innerHTML = '<span>âœ…</span> Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!';
  addButton.style.background = '#4caf50';
  
  setTimeout(() => {
    addButton.innerHTML = originalHTML;
    addButton.style.background = originalBackground;
  }, 1500);
  
  showQuickMessage(`âœ… Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î­Î¾Î¿Î´Î¿ ${category} - ${amount.toFixed(2)}â‚¬`, 'success');
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„Î·Ï‚ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚
  updateRecentExpenses();
  updateBudgetOverview();
  
  // Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±
  document.getElementById('amount').focus();
}

// ==================== INITIALIZATION ====================
window.onload = function() {
  // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±ÏƒÏ„ÎµÏÎ¹ÏÎ½
  const starsContainer = document.getElementById('stars');
  const starColors = ['#fff', '#ffd1e8', '#ffb6c1', '#ffc0cb'];
  
  for (let i = 0; i < 40; i++) {
    const star = document.createElement('div');
    star.classList.add('star');
    star.textContent = 'â˜…';
    star.style.left = Math.random() * 100 + '%';
    star.style.top = Math.random() * 100 + 'px';
    star.style.animationDelay = (Math.random() * 5) + 's';
    star.style.color = starColors[Math.floor(Math.random() * starColors.length)];
    starsContainer.appendChild(star);
  }
  
  // ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¹ÏÎ½
  const today = new Date().toISOString().slice(0,10);
  document.getElementById('date').value = today;
  
  // Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
  cleanupData();
  updateUIFromData();
  updateCategoriesList();
  updateRecurringInputs();
  loadBankValues();
  
  // ÎˆÎ½Î±ÏÎ¾Î· ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï
  initSync();
  
  // Setup Î³Î¹Î± Enter key - Î•Î¥ÎšÎŸÎ›Î— Î§Î¡Î—Î£Î— Î£Î• ÎšÎ™ÎÎ—Î¤ÎŸ
  document.getElementById('amount').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      addExpense();
    }
  });
  
  document.getElementById('note').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      addExpense();
    }
  });
  
  document.getElementById('category').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      document.getElementById('note').focus();
    }
  });
  
  document.getElementById('date').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      document.getElementById('note').focus();
    }
  });
  
  // Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÎ¬Î¸Îµ 30 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±
  setInterval(() => {
    if (currentBudget) {
      syncToFirebase();
    }
  }, 30000);
  
  // Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎµÏƒÏ„Î¯Î±ÏƒÎ· ÏƒÏ„Î¿ Ï€ÎµÎ´Î¯Î¿ Ï€Î¿ÏƒÎ¿Ï ÏŒÏ„Î±Î½ Î±Î½Î¿Î¯Î³ÎµÎ¹ Ï„Î¿ tab 1
  document.getElementById('amount').focus();
};
</script>
</body>
</html>
